(function(Ie,j){typeof exports=="object"&&typeof module!="undefined"?module.exports=j():typeof define=="function"&&define.amd?define(j):(Ie=typeof globalThis!="undefined"?globalThis:Ie||self,Ie.OpenSeadragon=Ie.OpenSeadragon||{},Ie.OpenSeadragon.Annotorious=j())})(this,function(){"use strict";var Gx=Object.defineProperty;var qx=(Ie,j,Pt)=>j in Ie?Gx(Ie,j,{enumerable:!0,configurable:!0,writable:!0,value:Pt}):Ie[j]=Pt;var x=(Ie,j,Pt)=>(qx(Ie,typeof j!="symbol"?j+"":j,Pt),Pt);var Ie,j,Pt,Bt,zs,Vs,xr,Us,Kt={},Ws=[],qd=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,oi=Array.isArray;function vt(i,t){for(var e in t)i[e]=t[e];return i}function js(i){var t=i.parentNode;t&&t.removeChild(i)}function Pe(i,t,e){var n,r,o,l={};for(o in t)o=="key"?n=t[o]:o=="ref"?r=t[o]:l[o]=t[o];if(arguments.length>2&&(l.children=arguments.length>3?Ie.call(arguments,2):e),typeof i=="function"&&i.defaultProps!=null)for(o in i.defaultProps)l[o]===void 0&&(l[o]=i.defaultProps[o]);return Pn(i,l,n,r,null)}function Pn(i,t,e,n,r){var o={type:i,props:t,key:e,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r==null?++Pt:r};return r==null&&j.vnode!=null&&j.vnode(o),o}function Tr(){return{current:null}}function nt(i){return i.children}function Te(i,t){this.props=i,this.context=t}function An(i,t){if(t==null)return i.__?An(i.__,i.__.__k.indexOf(i)+1):null;for(var e;t<i.__k.length;t++)if((e=i.__k[t])!=null&&e.__e!=null)return e.__e;return typeof i.type=="function"?An(i):null}function Gs(i){var t,e;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,t=0;t<i.__k.length;t++)if((e=i.__k[t])!=null&&e.__e!=null){i.__e=i.__c.base=e.__e;break}return Gs(i)}}function Cr(i){(!i.__d&&(i.__d=!0)&&Bt.push(i)&&!si.__r++||zs!==j.debounceRendering)&&((zs=j.debounceRendering)||Vs)(si)}function si(){var i,t,e,n,r,o,l,s,a;for(Bt.sort(xr);i=Bt.shift();)i.__d&&(t=Bt.length,n=void 0,r=void 0,o=void 0,s=(l=(e=i).__v).__e,(a=e.__P)&&(n=[],r=[],(o=vt({},l)).__v=l.__v+1,Pr(a,l,o,e.__n,a.ownerSVGElement!==void 0,l.__h!=null?[s]:null,n,s==null?An(l):s,l.__h,r),Qs(n,l,r),l.__e!=s&&Gs(l)),Bt.length>t&&Bt.sort(xr));si.__r=0}function qs(i,t,e,n,r,o,l,s,a,u,c){var h,d,p,m,w,y,E,T,C,B=0,M=n&&n.__k||Ws,N=M.length,I=N,G=t.length;for(e.__k=[],h=0;h<G;h++)(m=e.__k[h]=(m=t[h])==null||typeof m=="boolean"||typeof m=="function"?null:typeof m=="string"||typeof m=="number"||typeof m=="bigint"?Pn(null,m,null,null,m):oi(m)?Pn(nt,{children:m},null,null,null):m.__b>0?Pn(m.type,m.props,m.key,m.ref?m.ref:null,m.__v):m)!=null?(m.__=e,m.__b=e.__b+1,(T=Xd(m,M,E=h+B,I))===-1?p=Kt:(p=M[T]||Kt,M[T]=void 0,I--),Pr(i,m,p,r,o,l,s,a,u,c),w=m.__e,(d=m.ref)&&p.ref!=d&&(p.ref&&Ar(p.ref,null,m),c.push(d,m.__c||w,m)),w!=null&&(y==null&&(y=w),(C=p===Kt||p.__v===null)?T==-1&&B--:T!==E&&(T===E+1?B++:T>E?I>G-E?B+=T-E:B--:B=T<E&&T==E-1?T-E:0),E=h+B,typeof m.type!="function"||T===E&&p.__k!==m.__k?typeof m.type=="function"||T===E&&!C?m.__d!==void 0?(a=m.__d,m.__d=void 0):a=w.nextSibling:a=Zs(i,w,a):a=Xs(m,a,i),typeof e.type=="function"&&(e.__d=a))):(p=M[h])&&p.key==null&&p.__e&&(p.__e==a&&(a=An(p)),Or(p,p,!1));for(e.__e=y,h=N;h--;)M[h]!=null&&(typeof e.type=="function"&&M[h].__e!=null&&M[h].__e==e.__d&&(e.__d=M[h].__e.nextSibling),Or(M[h],M[h]))}function Xs(i,t,e){for(var n,r=i.__k,o=0;r&&o<r.length;o++)(n=r[o])&&(n.__=i,t=typeof n.type=="function"?Xs(n,t,e):Zs(e,n.__e,t));return t}function yt(i,t){return t=t||[],i==null||typeof i=="boolean"||(oi(i)?i.some(function(e){yt(e,t)}):t.push(i)),t}function Zs(i,t,e){return e==null||e.parentNode!==i?i.insertBefore(t,null):t==e&&t.parentNode!=null||i.insertBefore(t,e),t.nextSibling}function Xd(i,t,e,n){var r=i.key,o=i.type,l=e-1,s=e+1,a=t[e];if(a===null||a&&r==a.key&&o===a.type)return e;if(n>(a!=null?1:0))for(;l>=0||s<t.length;){if(l>=0){if((a=t[l])&&r==a.key&&o===a.type)return l;l--}if(s<t.length){if((a=t[s])&&r==a.key&&o===a.type)return s;s++}}return-1}function Zd(i,t,e,n,r){var o;for(o in e)o==="children"||o==="key"||o in t||ai(i,o,null,e[o],n);for(o in t)r&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||e[o]===t[o]||ai(i,o,t[o],e[o],n)}function Ys(i,t,e){t[0]==="-"?i.setProperty(t,e==null?"":e):i[t]=e==null?"":typeof e!="number"||qd.test(t)?e:e+"px"}function ai(i,t,e,n,r){var o;e:if(t==="style")if(typeof e=="string")i.style.cssText=e;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(t in n)e&&t in e||Ys(i.style,t,"");if(e)for(t in e)n&&e[t]===n[t]||Ys(i.style,t,e[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in i?t.toLowerCase().slice(2):t.slice(2),i.l||(i.l={}),i.l[t+o]=e,e?n||i.addEventListener(t,o?Js:Ks,o):i.removeEventListener(t,o?Js:Ks,o);else if(t!=="dangerouslySetInnerHTML"){if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t in i)try{i[t]=e==null?"":e;break e}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!=="-"?i.removeAttribute(t):i.setAttribute(t,e))}}function Ks(i){return this.l[i.type+!1](j.event?j.event(i):i)}function Js(i){return this.l[i.type+!0](j.event?j.event(i):i)}function Pr(i,t,e,n,r,o,l,s,a,u){var c,h,d,p,m,w,y,E,T,C,B,M,N,I,G,W=t.type;if(t.constructor!==void 0)return null;e.__h!=null&&(a=e.__h,s=t.__e=e.__e,t.__h=null,o=[s]),(c=j.__b)&&c(t);e:if(typeof W=="function")try{if(E=t.props,T=(c=W.contextType)&&n[c.__c],C=c?T?T.props.value:c.__:n,e.__c?y=(h=t.__c=e.__c).__=h.__E:("prototype"in W&&W.prototype.render?t.__c=h=new W(E,C):(t.__c=h=new Te(E,C),h.constructor=W,h.render=Kd),T&&T.sub(h),h.props=E,h.state||(h.state={}),h.context=C,h.__n=n,d=h.__d=!0,h.__h=[],h._sb=[]),h.__s==null&&(h.__s=h.state),W.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=vt({},h.__s)),vt(h.__s,W.getDerivedStateFromProps(E,h.__s))),p=h.props,m=h.state,h.__v=t,d)W.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(W.getDerivedStateFromProps==null&&E!==p&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(E,C),!h.__e&&(h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(E,h.__s,C)===!1||t.__v===e.__v)){for(t.__v!==e.__v&&(h.props=E,h.state=h.__s,h.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.forEach(function(ne){ne&&(ne.__=t)}),B=0;B<h._sb.length;B++)h.__h.push(h._sb[B]);h._sb=[],h.__h.length&&l.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(E,h.__s,C),h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(p,m,w)})}if(h.context=C,h.props=E,h.__P=i,h.__e=!1,M=j.__r,N=0,"prototype"in W&&W.prototype.render){for(h.state=h.__s,h.__d=!1,M&&M(t),c=h.render(h.props,h.state,h.context),I=0;I<h._sb.length;I++)h.__h.push(h._sb[I]);h._sb=[]}else do h.__d=!1,M&&M(t),c=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++N<25);h.state=h.__s,h.getChildContext!=null&&(n=vt(vt({},n),h.getChildContext())),d||h.getSnapshotBeforeUpdate==null||(w=h.getSnapshotBeforeUpdate(p,m)),qs(i,oi(G=c!=null&&c.type===nt&&c.key==null?c.props.children:c)?G:[G],t,e,n,r,o,l,s,a,u),h.base=t.__e,t.__h=null,h.__h.length&&l.push(h),y&&(h.__E=h.__=null)}catch(ne){t.__v=null,(a||o!=null)&&(t.__e=s,t.__h=!!a,o[o.indexOf(s)]=null),j.__e(ne,t,e)}else o==null&&t.__v===e.__v?(t.__k=e.__k,t.__e=e.__e):t.__e=Yd(e.__e,t,e,n,r,o,l,a,u);(c=j.diffed)&&c(t)}function Qs(i,t,e){for(var n=0;n<e.length;n++)Ar(e[n],e[++n],e[++n]);j.__c&&j.__c(t,i),i.some(function(r){try{i=r.__h,r.__h=[],i.some(function(o){o.call(r)})}catch(o){j.__e(o,r.__v)}})}function Yd(i,t,e,n,r,o,l,s,a){var u,c,h,d=e.props,p=t.props,m=t.type,w=0;if(m==="svg"&&(r=!0),o!=null){for(;w<o.length;w++)if((u=o[w])&&"setAttribute"in u==!!m&&(m?u.localName===m:u.nodeType===3)){i=u,o[w]=null;break}}if(i==null){if(m===null)return document.createTextNode(p);i=r?document.createElementNS("http://www.w3.org/2000/svg",m):document.createElement(m,p.is&&p),o=null,s=!1}if(m===null)d===p||s&&i.data===p||(i.data=p);else{if(o=o&&Ie.call(i.childNodes),c=(d=e.props||Kt).dangerouslySetInnerHTML,h=p.dangerouslySetInnerHTML,!s){if(o!=null)for(d={},w=0;w<i.attributes.length;w++)d[i.attributes[w].name]=i.attributes[w].value;(h||c)&&(h&&(c&&h.__html==c.__html||h.__html===i.innerHTML)||(i.innerHTML=h&&h.__html||""))}if(Zd(i,p,d,r,s),h)t.__k=[];else if(qs(i,oi(w=t.props.children)?w:[w],t,e,n,r&&m!=="foreignObject",o,l,o?o[0]:e.__k&&An(e,0),s,a),o!=null)for(w=o.length;w--;)o[w]!=null&&js(o[w]);s||("value"in p&&(w=p.value)!==void 0&&(w!==i.value||m==="progress"&&!w||m==="option"&&w!==d.value)&&ai(i,"value",w,d.value,!1),"checked"in p&&(w=p.checked)!==void 0&&w!==i.checked&&ai(i,"checked",w,d.checked,!1))}return i}function Ar(i,t,e){try{typeof i=="function"?i(t):i.current=t}catch(n){j.__e(n,e)}}function Or(i,t,e){var n,r;if(j.unmount&&j.unmount(i),(n=i.ref)&&(n.current&&n.current!==i.__e||Ar(n,null,t)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){j.__e(o,t)}n.base=n.__P=null,i.__c=void 0}if(n=i.__k)for(r=0;r<n.length;r++)n[r]&&Or(n[r],t,e||typeof i.type!="function");e||i.__e==null||js(i.__e),i.__=i.__e=i.__d=void 0}function Kd(i,t,e){return this.constructor(i,e)}function On(i,t,e){var n,r,o,l;j.__&&j.__(i,t),r=(n=typeof e=="function")?null:e&&e.__k||t.__k,o=[],l=[],Pr(t,i=(!n&&e||t).__k=Pe(nt,null,[i]),r||Kt,Kt,t.ownerSVGElement!==void 0,!n&&e?[e]:r?null:t.firstChild?Ie.call(t.childNodes):null,o,!n&&e?e:r?r.__e:t.firstChild,n,l),Qs(o,i,l)}function $s(i,t){On(i,t,$s)}function Jd(i,t,e){var n,r,o,l,s=vt({},i.props);for(o in i.type&&i.type.defaultProps&&(l=i.type.defaultProps),t)o=="key"?n=t[o]:o=="ref"?r=t[o]:s[o]=t[o]===void 0&&l!==void 0?l[o]:t[o];return arguments.length>2&&(s.children=arguments.length>3?Ie.call(arguments,2):e),Pn(i.type,s,n||i.key,r||i.ref,null)}function Rn(i,t){var e={__c:t="__cC"+Us++,__:i,Consumer:function(n,r){return n.children(r)},Provider:function(n){var r,o;return this.getChildContext||(r=[],(o={})[t]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&r.some(function(s){s.__e=!0,Cr(s)})},this.sub=function(l){r.push(l);var s=l.componentWillUnmount;l.componentWillUnmount=function(){r.splice(r.indexOf(l),1),s&&s.call(l)}}),n.children}};return e.Provider.__=e.Consumer.contextType=e}Ie=Ws.slice,j={__e:function(i,t,e,n){for(var r,o,l;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(i)),l=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(i,n||{}),l=r.__d),l)return r.__E=r}catch(s){i=s}throw i}},Pt=0,Te.prototype.setState=function(i,t){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=vt({},this.state),typeof i=="function"&&(i=i(vt({},e),this.props)),i&&vt(e,i),i!=null&&this.__v&&(t&&this._sb.push(t),Cr(this))},Te.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Cr(this))},Te.prototype.render=nt,Bt=[],Vs=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xr=function(i,t){return i.__v.__b-t.__v.__b},si.__r=0,Us=0;var wt,ge,Rr,ea,Jt=0,ta=[],li=[],na=j.__b,ia=j.__r,ra=j.diffed,oa=j.__c,sa=j.unmount;function Nt(i,t){j.__h&&j.__h(ge,i,Jt||t),Jt=0;var e=ge.__H||(ge.__H={__:[],__h:[]});return i>=e.__.length&&e.__.push({__V:li}),e.__[i]}function rt(i){return Jt=1,Dr(ha,i)}function Dr(i,t,e){var n=Nt(wt++,2);if(n.t=i,!n.__c&&(n.__=[e?e(t):ha(void 0,t),function(s){var a=n.__N?n.__N[0]:n.__[0],u=n.t(a,s);a!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=ge,!ge.u)){var r=function(s,a,u){if(!n.__c.__H)return!0;var c=n.__c.__H.__.filter(function(d){return d.__c});if(c.every(function(d){return!d.__N}))return!o||o.call(this,s,a,u);var h=!1;return c.forEach(function(d){if(d.__N){var p=d.__[0];d.__=d.__N,d.__N=void 0,p!==d.__[0]&&(h=!0)}}),!(!h&&n.__c.props===s)&&(!o||o.call(this,s,a,u))};ge.u=!0;var o=ge.shouldComponentUpdate,l=ge.componentWillUpdate;ge.componentWillUpdate=function(s,a,u){if(this.__e){var c=o;o=void 0,r(s,a,u),o=c}l&&l.call(this,s,a,u)},ge.shouldComponentUpdate=r}return n.__N||n.__}function At(i,t){var e=Nt(wt++,3);!j.__s&&Ir(e.__H,t)&&(e.__=i,e.i=t,ge.__H.__h.push(e))}function Dn(i,t){var e=Nt(wt++,4);!j.__s&&Ir(e.__H,t)&&(e.__=i,e.i=t,ge.__h.push(e))}function ut(i){return Jt=5,bt(function(){return{current:i}},[])}function aa(i,t,e){Jt=6,Dn(function(){return typeof i=="function"?(i(t()),function(){return i(null)}):i?(i.current=t(),function(){return i.current=null}):void 0},e==null?e:e.concat(i))}function bt(i,t){var e=Nt(wt++,7);return Ir(e.__H,t)?(e.__V=i(),e.i=t,e.__h=i,e.__V):e.__}function ct(i,t){return Jt=8,bt(function(){return i},t)}function Mn(i){var t=ge.context[i.__c],e=Nt(wt++,9);return e.c=i,t?(e.__==null&&(e.__=!0,t.sub(ge)),t.props.value):i.__}function la(i,t){j.useDebugValue&&j.useDebugValue(t?t(i):i)}function Qd(i){var t=Nt(wt++,10),e=rt();return t.__=i,ge.componentDidCatch||(ge.componentDidCatch=function(n,r){t.__&&t.__(n,r),e[1](n)}),[e[0],function(){e[1](void 0)}]}function ua(){var i=Nt(wt++,11);if(!i.__){for(var t=ge.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var e=t.__m||(t.__m=[0,0]);i.__="P"+e[0]+"-"+e[1]++}return i.__}function $d(){for(var i;i=ta.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(ui),i.__H.__h.forEach(Mr),i.__H.__h=[]}catch(t){i.__H.__h=[],j.__e(t,i.__v)}}j.__b=function(i){ge=null,na&&na(i)},j.__r=function(i){ia&&ia(i),wt=0;var t=(ge=i.__c).__H;t&&(Rr===ge?(t.__h=[],ge.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=li,e.__N=e.i=void 0})):(t.__h.forEach(ui),t.__h.forEach(Mr),t.__h=[],wt=0)),Rr=ge},j.diffed=function(i){ra&&ra(i);var t=i.__c;t&&t.__H&&(t.__H.__h.length&&(ta.push(t)!==1&&ea===j.requestAnimationFrame||((ea=j.requestAnimationFrame)||ef)($d)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==li&&(e.__=e.__V),e.i=void 0,e.__V=li})),Rr=ge=null},j.__c=function(i,t){t.some(function(e){try{e.__h.forEach(ui),e.__h=e.__h.filter(function(n){return!n.__||Mr(n)})}catch(n){t.some(function(r){r.__h&&(r.__h=[])}),t=[],j.__e(n,e.__v)}}),oa&&oa(i,t)},j.unmount=function(i){sa&&sa(i);var t,e=i.__c;e&&e.__H&&(e.__H.__.forEach(function(n){try{ui(n)}catch(r){t=r}}),e.__H=void 0,t&&j.__e(t,e.__v))};var ca=typeof requestAnimationFrame=="function";function ef(i){var t,e=function(){clearTimeout(n),ca&&cancelAnimationFrame(t),setTimeout(i)},n=setTimeout(e,100);ca&&(t=requestAnimationFrame(e))}function ui(i){var t=ge,e=i.__c;typeof e=="function"&&(i.__c=void 0,e()),ge=t}function Mr(i){var t=ge;i.__c=i.__(),ge=t}function Ir(i,t){return!i||i.length!==t.length||t.some(function(e,n){return e!==i[n]})}function ha(i,t){return typeof t=="function"?t(i):t}function da(i,t){for(var e in t)i[e]=t[e];return i}function Fr(i,t){for(var e in i)if(e!=="__source"&&!(e in t))return!0;for(var n in t)if(n!=="__source"&&i[n]!==t[n])return!0;return!1}function kr(i,t){return i===t&&(i!==0||1/i==1/t)||i!=i&&t!=t}function In(i){this.props=i}function fa(i,t){function e(r){var o=this.props.ref,l=o==r.ref;return!l&&o&&(o.call?o(null):o.current=null),t?!t(this.props,r)||!l:Fr(this.props,r)}function n(r){return this.shouldComponentUpdate=e,Pe(i,r)}return n.displayName="Memo("+(i.displayName||i.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(In.prototype=new Te).isPureReactComponent=!0,In.prototype.shouldComponentUpdate=function(i,t){return Fr(this.props,i)||Fr(this.state,t)};var pa=j.__b;j.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),pa&&pa(i)};var tf=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Lr(i){function t(e){var n=da({},e);return delete n.ref,i(n,e.ref||null)}return t.$$typeof=tf,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(i.displayName||i.name)+")",t}var ga=function(i,t){return i==null?null:yt(yt(i).map(t))},ma={map:ga,forEach:ga,count:function(i){return i?yt(i).length:0},only:function(i){var t=yt(i);if(t.length!==1)throw"Children.only";return t[0]},toArray:yt},nf=j.__e;j.__e=function(i,t,e,n){if(i.then){for(var r,o=t;o=o.__;)if((r=o.__c)&&r.__c)return t.__e==null&&(t.__e=e.__e,t.__k=e.__k),r.__c(i,t)}nf(i,t,e,n)};var va=j.unmount;function ya(i,t,e){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),i.__c.__H=null),(i=da({},i)).__c!=null&&(i.__c.__P===e&&(i.__c.__P=t),i.__c=null),i.__k=i.__k&&i.__k.map(function(n){return ya(n,t,e)})),i}function wa(i,t,e){return i&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(n){return wa(n,t,e)}),i.__c&&i.__c.__P===t&&(i.__e&&e.insertBefore(i.__e,i.__d),i.__c.__e=!0,i.__c.__P=e)),i}function Fn(){this.__u=0,this.t=null,this.__b=null}function ba(i){var t=i.__.__c;return t&&t.__a&&t.__a(i)}function Sa(i){var t,e,n;function r(o){if(t||(t=i()).then(function(l){e=l.default||l},function(l){n=l}),n)throw n;if(!e)throw t;return Pe(e,o)}return r.displayName="Lazy",r.__f=!0,r}function Qt(){this.u=null,this.o=null}j.unmount=function(i){var t=i.__c;t&&t.__R&&t.__R(),t&&i.__h===!0&&(i.type=null),va&&va(i)},(Fn.prototype=new Te).__c=function(i,t){var e=t.__c,n=this;n.t==null&&(n.t=[]),n.t.push(e);var r=ba(n.__v),o=!1,l=function(){o||(o=!0,e.__R=null,r?r(s):s())};e.__R=l;var s=function(){if(!--n.__u){if(n.state.__a){var u=n.state.__a;n.__v.__k[0]=wa(u,u.__c.__P,u.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.t.pop();)c.forceUpdate()}},a=t.__h===!0;n.__u++||a||n.setState({__a:n.__b=n.__v.__k[0]}),i.then(l,l)},Fn.prototype.componentWillUnmount=function(){this.t=[]},Fn.prototype.render=function(i,t){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=ya(this.__b,e,n.__O=n.__P)}this.__b=null}var r=t.__a&&Pe(nt,null,i.fallback);return r&&(r.__h=null),[Pe(nt,null,t.__a?null:i.children),r]};var Ea=function(i,t,e){if(++e[1]===e[0]&&i.o.delete(t),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.o.size))for(e=i.u;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;i.u=e=e[2]}};function rf(i){return this.getChildContext=function(){return i.context},i.children}function of(i){var t=this,e=i.i;t.componentWillUnmount=function(){On(null,t.l),t.l=null,t.i=null},t.i&&t.i!==e&&t.componentWillUnmount(),t.l||(t.i=e,t.l={nodeType:1,parentNode:e,childNodes:[],appendChild:function(n){this.childNodes.push(n),t.i.appendChild(n)},insertBefore:function(n,r){this.childNodes.push(n),t.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),t.i.removeChild(n)}}),On(Pe(rf,{context:t.context},i.__v),t.l)}function Br(i,t){var e=Pe(of,{__v:i,i:t});return e.containerInfo=t,e}(Qt.prototype=new Te).__a=function(i){var t=this,e=ba(t.__v),n=t.o.get(i);return n[0]++,function(r){var o=function(){t.props.revealOrder?(n.push(r),Ea(t,i,n)):r()};e?e(o):o()}},Qt.prototype.render=function(i){this.u=null,this.o=new Map;var t=yt(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.o.set(t[e],this.u=[1,0,this.u]);return i.children},Qt.prototype.componentDidUpdate=Qt.prototype.componentDidMount=function(){var i=this;this.o.forEach(function(t,e){Ea(i,e,t)})};var _a=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,sf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,af=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,lf=/[A-Z0-9]/g,uf=typeof document!="undefined",cf=function(i){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)};function xa(i,t,e){return t.__k==null&&(t.textContent=""),On(i,t),typeof e=="function"&&e(),i?i.__c:null}function Ta(i,t,e){return $s(i,t),typeof e=="function"&&e(),i?i.__c:null}Te.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(Te.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(t){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:t})}})});var Ca=j.event;function hf(){}function df(){return this.cancelBubble}function ff(){return this.defaultPrevented}j.event=function(i){return Ca&&(i=Ca(i)),i.persist=hf,i.isPropagationStopped=df,i.isDefaultPrevented=ff,i.nativeEvent=i};var Nr,pf={enumerable:!1,configurable:!0,get:function(){return this.class}},Pa=j.vnode;j.vnode=function(i){typeof i.type=="string"&&function(t){var e=t.props,n=t.type,r={};for(var o in e){var l=e[o];if(!(o==="value"&&"defaultValue"in e&&l==null||uf&&o==="children"&&n==="noscript"||o==="class"||o==="className")){var s=o.toLowerCase();o==="defaultValue"&&"value"in e&&e.value==null?o="value":o==="download"&&l===!0?l="":s==="ondoubleclick"?o="ondblclick":s!=="onchange"||n!=="input"&&n!=="textarea"||cf(e.type)?s==="onfocus"?o="onfocusin":s==="onblur"?o="onfocusout":af.test(o)?o=s:n.indexOf("-")===-1&&sf.test(o)?o=o.replace(lf,"-$&").toLowerCase():l===null&&(l=void 0):s=o="oninput",s==="oninput"&&r[o=s]&&(o="oninputCapture"),r[o]=l}}n=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=yt(e.children).forEach(function(a){a.props.selected=r.value.indexOf(a.props.value)!=-1})),n=="select"&&r.defaultValue!=null&&(r.value=yt(e.children).forEach(function(a){a.props.selected=r.multiple?r.defaultValue.indexOf(a.props.value)!=-1:r.defaultValue==a.props.value})),e.class&&!e.className?(r.class=e.class,Object.defineProperty(r,"className",pf)):(e.className&&!e.class||e.class&&e.className)&&(r.class=r.className=e.className),t.props=r}(i),i.$$typeof=_a,Pa&&Pa(i)};var Aa=j.__r;j.__r=function(i){Aa&&Aa(i),Nr=i.__c};var Oa=j.diffed;j.diffed=function(i){Oa&&Oa(i);var t=i.props,e=i.__e;e!=null&&i.type==="textarea"&&"value"in t&&t.value!==e.value&&(e.value=t.value==null?"":t.value),Nr=null};var Ra={ReactCurrentDispatcher:{current:{readContext:function(i){return Nr.__n[i.__c].props.value}}}},gf="17.0.2";function Da(i){return Pe.bind(null,i)}function kn(i){return!!i&&i.$$typeof===_a}function Ma(i){return kn(i)&&i.type===nt}function Ia(i){return kn(i)?Jd.apply(null,arguments):i}function Fa(i){return!!i.__k&&(On(null,i),!0)}function ka(i){return i&&(i.base||i.nodeType===1&&i)||null}var La=function(i,t){return i(t)},Ba=function(i,t){return i(t)},Na=nt;function Hr(i){i()}function Ha(i){return i}function za(){return[!1,Hr]}var Va=Dn,Ua=kn;function Wa(i,t){var e=t(),n=rt({h:{__:e,v:t}}),r=n[0].h,o=n[1];return Dn(function(){r.__=e,r.v=t,kr(r.__,t())||o({h:r})},[i,e,t]),At(function(){return kr(r.__,r.v())||o({h:r}),i(function(){kr(r.__,r.v())||o({h:r})})},[i]),e}var A={useState:rt,useId:ua,useReducer:Dr,useEffect:At,useLayoutEffect:Dn,useInsertionEffect:Va,useTransition:za,useDeferredValue:Ha,useSyncExternalStore:Wa,startTransition:Hr,useRef:ut,useImperativeHandle:aa,useMemo:bt,useCallback:ct,useContext:Mn,useDebugValue:la,version:"17.0.2",Children:ma,render:xa,hydrate:Ta,unmountComponentAtNode:Fa,createPortal:Br,createElement:Pe,createContext:Rn,createFactory:Da,cloneElement:Ia,createRef:Tr,Fragment:nt,isValidElement:kn,isElement:Ua,isFragment:Ma,findDOMNode:ka,Component:Te,PureComponent:In,memo:fa,forwardRef:Lr,flushSync:Ba,unstable_batchedUpdates:La,StrictMode:Na,Suspense:Fn,SuspenseList:Qt,lazy:Sa,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Ra},zr=Object.freeze(Object.defineProperty({__proto__:null,Children:ma,PureComponent:In,StrictMode:Na,Suspense:Fn,SuspenseList:Qt,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Ra,cloneElement:Ia,createFactory:Da,createPortal:Br,default:A,findDOMNode:ka,flushSync:Ba,forwardRef:Lr,hydrate:Ta,isElement:Ua,isFragment:Ma,isValidElement:kn,lazy:Sa,memo:fa,render:xa,startTransition:Hr,unmountComponentAtNode:Fa,unstable_batchedUpdates:La,useDeferredValue:Ha,useInsertionEffect:Va,useSyncExternalStore:Wa,useTransition:za,version:gf,Component:Te,Fragment:nt,createContext:Rn,createElement:Pe,createRef:Tr,useCallback:ct,useContext:Mn,useDebugValue:la,useEffect:At,useErrorBoundary:Qd,useId:ua,useImperativeHandle:aa,useLayoutEffect:Dn,useMemo:bt,useReducer:Dr,useRef:ut,useState:rt},Symbol.toStringTag,{value:"Module"})),Ot=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function mf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Vr(i){if(i.__esModule)return i;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(i).forEach(function(e){var n=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,n.get?n:{enumerable:!0,get:function(){return i[e]}})}),t}var Ur={exports:{}};function Wr(){}Wr.prototype={on:function(i,t,e){var n=this.e||(this.e={});return(n[i]||(n[i]=[])).push({fn:t,ctx:e}),this},once:function(i,t,e){var n=this;function r(){n.off(i,r),t.apply(e,arguments)}return r._=t,this.on(i,r,e)},emit:function(i){var t=[].slice.call(arguments,1),e=((this.e||(this.e={}))[i]||[]).slice(),n=0,r=e.length;for(n;n<r;n++)e[n].fn.apply(e[n].ctx,t);return this},off:function(i,t){var e=this.e||(this.e={}),n=e[i],r=[];if(n&&t)for(var o=0,l=n.length;o<l;o++)n[o].fn!==t&&n[o].fn._!==t&&r.push(n[o]);return r.length?e[i]=r:delete e[i],this}},Ur.exports=Wr,Ur.exports.TinyEmitter=Wr;var ci=Ur.exports,hi={exports:{}},ja={},$t=Vr(zr),Ln={exports:{}},vf="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",yf=vf,wf=yf;function Ga(){}function qa(){}qa.resetWarningCache=Ga;var bf=function(){function i(n,r,o,l,s,a){if(a!==wf){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}i.isRequired=i;function t(){return i}var e={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:t,element:i,elementType:i,instanceOf:t,node:i,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:qa,resetWarningCache:Ga};return e.PropTypes=e,e};Ln.exports=bf();function Xa(i){var t,e,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i))for(t=0;t<i.length;t++)i[t]&&(e=Xa(i[t]))&&(n&&(n+=" "),n+=e);else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function Za(){for(var i,t,e=0,n="";e<arguments.length;)(i=arguments[e++])&&(t=Xa(i))&&(n&&(n+=" "),n+=t);return n}var Sf=Object.freeze(Object.defineProperty({__proto__:null,clsx:Za,default:Za},Symbol.toStringTag,{value:"Module"})),Ef=Vr(Sf),be={},ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.dontSetMe=Pf,ht.findInArray=_f,ht.int=Cf,ht.isFunction=xf,ht.isNum=Tf;function _f(i,t){for(var e=0,n=i.length;e<n;e++)if(t.apply(t,[i[e],e,i]))return i[e]}function xf(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Function]"}function Tf(i){return typeof i=="number"&&!isNaN(i)}function Cf(i){return parseInt(i,10)}function Pf(i,t,e){if(i[t])return new Error("Invalid prop ".concat(t," passed to ").concat(e," - do not set this, set it on the child."))}var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.browserPrefixToKey=Ka,Ht.browserPrefixToStyle=Af,Ht.default=void 0,Ht.getPrefix=Ya;var jr=["Moz","Webkit","O","ms"];function Ya(){var i,t,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";var n=(i=window.document)===null||i===void 0||(t=i.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(var r=0;r<jr.length;r++)if(Ka(e,jr[r])in n)return jr[r];return""}function Ka(i,t){return t?"".concat(t).concat(Of(i)):i}function Af(i,t){return t?"-".concat(t.toLowerCase(),"-").concat(i):i}function Of(i){for(var t="",e=!0,n=0;n<i.length;n++)e?(t+=i[n].toUpperCase(),e=!1):i[n]==="-"?e=!0:t+=i[n];return t}var Rf=Ya();Ht.default=Rf;function Gr(i){return Gr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(i)}Object.defineProperty(be,"__esModule",{value:!0}),be.addClassName=il,be.addEvent=If,be.addUserSelectStyles=jf,be.createCSSTransform=zf,be.createSVGTransform=Vf,be.getTouch=Uf,be.getTouchIdentifier=Wf,be.getTranslation=qr,be.innerHeight=Bf,be.innerWidth=Nf,be.matchesSelector=nl,be.matchesSelectorAndParentsTo=Mf,be.offsetXYFromParent=Hf,be.outerHeight=kf,be.outerWidth=Lf,be.removeClassName=rl,be.removeEvent=Ff,be.removeUserSelectStyles=Gf;var Xe=ht,Ja=Df(Ht);function Qa(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,e=new WeakMap;return(Qa=function(r){return r?e:t})(i)}function Df(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||Gr(i)!=="object"&&typeof i!="function")return{default:i};var e=Qa(t);if(e&&e.has(i))return e.get(i);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in i)if(o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)){var l=r?Object.getOwnPropertyDescriptor(i,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=i[o]}return n.default=i,e&&e.set(i,n),n}function $a(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,n)}return e}function el(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?$a(Object(e),!0).forEach(function(n){tl(i,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):$a(Object(e)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(e,n))})}return i}function tl(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var di="";function nl(i,t){return di||(di=(0,Xe.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(e){return(0,Xe.isFunction)(i[e])})),(0,Xe.isFunction)(i[di])?i[di](t):!1}function Mf(i,t,e){var n=i;do{if(nl(n,t))return!0;if(n===e)return!1;n=n.parentNode}while(n);return!1}function If(i,t,e,n){if(!!i){var r=el({capture:!0},n);i.addEventListener?i.addEventListener(t,e,r):i.attachEvent?i.attachEvent("on"+t,e):i["on"+t]=e}}function Ff(i,t,e,n){if(!!i){var r=el({capture:!0},n);i.removeEventListener?i.removeEventListener(t,e,r):i.detachEvent?i.detachEvent("on"+t,e):i["on"+t]=null}}function kf(i){var t=i.clientHeight,e=i.ownerDocument.defaultView.getComputedStyle(i);return t+=(0,Xe.int)(e.borderTopWidth),t+=(0,Xe.int)(e.borderBottomWidth),t}function Lf(i){var t=i.clientWidth,e=i.ownerDocument.defaultView.getComputedStyle(i);return t+=(0,Xe.int)(e.borderLeftWidth),t+=(0,Xe.int)(e.borderRightWidth),t}function Bf(i){var t=i.clientHeight,e=i.ownerDocument.defaultView.getComputedStyle(i);return t-=(0,Xe.int)(e.paddingTop),t-=(0,Xe.int)(e.paddingBottom),t}function Nf(i){var t=i.clientWidth,e=i.ownerDocument.defaultView.getComputedStyle(i);return t-=(0,Xe.int)(e.paddingLeft),t-=(0,Xe.int)(e.paddingRight),t}function Hf(i,t,e){var n=t===t.ownerDocument.body,r=n?{left:0,top:0}:t.getBoundingClientRect(),o=(i.clientX+t.scrollLeft-r.left)/e,l=(i.clientY+t.scrollTop-r.top)/e;return{x:o,y:l}}function zf(i,t){var e=qr(i,t,"px");return tl({},(0,Ja.browserPrefixToKey)("transform",Ja.default),e)}function Vf(i,t){var e=qr(i,t,"");return e}function qr(i,t,e){var n=i.x,r=i.y,o="translate(".concat(n).concat(e,",").concat(r).concat(e,")");if(t){var l="".concat(typeof t.x=="string"?t.x:t.x+e),s="".concat(typeof t.y=="string"?t.y:t.y+e);o="translate(".concat(l,", ").concat(s,")")+o}return o}function Uf(i,t){return i.targetTouches&&(0,Xe.findInArray)(i.targetTouches,function(e){return t===e.identifier})||i.changedTouches&&(0,Xe.findInArray)(i.changedTouches,function(e){return t===e.identifier})}function Wf(i){if(i.targetTouches&&i.targetTouches[0])return i.targetTouches[0].identifier;if(i.changedTouches&&i.changedTouches[0])return i.changedTouches[0].identifier}function jf(i){if(!!i){var t=i.getElementById("react-draggable-style-el");t||(t=i.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,i.getElementsByTagName("head")[0].appendChild(t)),i.body&&il(i.body,"react-draggable-transparent-selection")}}function Gf(i){if(!!i)try{if(i.body&&rl(i.body,"react-draggable-transparent-selection"),i.selection)i.selection.empty();else{var t=(i.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch{}}function il(i,t){i.classList?i.classList.add(t):i.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(i.className+=" ".concat(t))}function rl(i,t){i.classList?i.classList.remove(t):i.className=i.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}var dt={};Object.defineProperty(dt,"__esModule",{value:!0}),dt.canDragX=Zf,dt.canDragY=Yf,dt.createCoreData=Jf,dt.createDraggableData=Qf,dt.getBoundPosition=qf,dt.getControlPosition=Kf,dt.snapToGrid=Xf;var Ze=ht,en=be;function qf(i,t,e){if(!i.props.bounds)return[t,e];var n=i.props.bounds;n=typeof n=="string"?n:$f(n);var r=Xr(i);if(typeof n=="string"){var o=r.ownerDocument,l=o.defaultView,s;if(n==="parent"?s=r.parentNode:s=o.querySelector(n),!(s instanceof l.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');var a=s,u=l.getComputedStyle(r),c=l.getComputedStyle(a);n={left:-r.offsetLeft+(0,Ze.int)(c.paddingLeft)+(0,Ze.int)(u.marginLeft),top:-r.offsetTop+(0,Ze.int)(c.paddingTop)+(0,Ze.int)(u.marginTop),right:(0,en.innerWidth)(a)-(0,en.outerWidth)(r)-r.offsetLeft+(0,Ze.int)(c.paddingRight)-(0,Ze.int)(u.marginRight),bottom:(0,en.innerHeight)(a)-(0,en.outerHeight)(r)-r.offsetTop+(0,Ze.int)(c.paddingBottom)-(0,Ze.int)(u.marginBottom)}}return(0,Ze.isNum)(n.right)&&(t=Math.min(t,n.right)),(0,Ze.isNum)(n.bottom)&&(e=Math.min(e,n.bottom)),(0,Ze.isNum)(n.left)&&(t=Math.max(t,n.left)),(0,Ze.isNum)(n.top)&&(e=Math.max(e,n.top)),[t,e]}function Xf(i,t,e){var n=Math.round(t/i[0])*i[0],r=Math.round(e/i[1])*i[1];return[n,r]}function Zf(i){return i.props.axis==="both"||i.props.axis==="x"}function Yf(i){return i.props.axis==="both"||i.props.axis==="y"}function Kf(i,t,e){var n=typeof t=="number"?(0,en.getTouch)(i,t):null;if(typeof t=="number"&&!n)return null;var r=Xr(e),o=e.props.offsetParent||r.offsetParent||r.ownerDocument.body;return(0,en.offsetXYFromParent)(n||i,o,e.props.scale)}function Jf(i,t,e){var n=i.state,r=!(0,Ze.isNum)(n.lastX),o=Xr(i);return r?{node:o,deltaX:0,deltaY:0,lastX:t,lastY:e,x:t,y:e}:{node:o,deltaX:t-n.lastX,deltaY:e-n.lastY,lastX:n.lastX,lastY:n.lastY,x:t,y:e}}function Qf(i,t){var e=i.props.scale;return{node:t.node,x:i.state.x+t.deltaX/e,y:i.state.y+t.deltaY/e,deltaX:t.deltaX/e,deltaY:t.deltaY/e,lastX:i.state.x,lastY:i.state.y}}function $f(i){return{left:i.left,top:i.top,right:i.right,bottom:i.bottom}}function Xr(i){var t=i.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}var fi={},pi={};Object.defineProperty(pi,"__esModule",{value:!0}),pi.default=ep;function ep(){}function gi(i){return gi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gi(i)}Object.defineProperty(fi,"__esModule",{value:!0}),fi.default=void 0;var Zr=np($t),Ye=Kr(Ln.exports),tp=Kr($t),Ne=be,Rt=dt,Yr=ht,Bn=Kr(pi);function Kr(i){return i&&i.__esModule?i:{default:i}}function ol(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,e=new WeakMap;return(ol=function(r){return r?e:t})(i)}function np(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||gi(i)!=="object"&&typeof i!="function")return{default:i};var e=ol(t);if(e&&e.has(i))return e.get(i);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in i)if(o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)){var l=r?Object.getOwnPropertyDescriptor(i,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=i[o]}return n.default=i,e&&e.set(i,n),n}function sl(i,t){return sp(i)||op(i,t)||rp(i,t)||ip()}function ip(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rp(i,t){if(!!i){if(typeof i=="string")return al(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return al(i,t)}}function al(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=i[e];return n}function op(i,t){var e=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(e!=null){var n=[],r=!0,o=!1,l,s;try{for(e=e.call(i);!(r=(l=e.next()).done)&&(n.push(l.value),!(t&&n.length===t));r=!0);}catch(a){o=!0,s=a}finally{try{!r&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function sp(i){if(Array.isArray(i))return i}function ap(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function ll(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function lp(i,t,e){return t&&ll(i.prototype,t),e&&ll(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function up(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),t&&Jr(i,t)}function Jr(i,t){return Jr=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Jr(i,t)}function cp(i){var t=dp();return function(){var n=mi(i),r;if(t){var o=mi(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return hp(this,r)}}function hp(i,t){if(t&&(gi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return He(i)}function He(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function dp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mi(i){return mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mi(i)}function it(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var ot={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},Dt=ot.mouse,vi=function(i){up(e,i);var t=cp(e);function e(){var n;ap(this,e);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=t.call.apply(t,[this].concat(o)),it(He(n),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),it(He(n),"mounted",!1),it(He(n),"handleDragStart",function(s){if(n.props.onMouseDown(s),!n.props.allowAnyClick&&typeof s.button=="number"&&s.button!==0)return!1;var a=n.findDOMNode();if(!a||!a.ownerDocument||!a.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var u=a.ownerDocument;if(!(n.props.disabled||!(s.target instanceof u.defaultView.Node)||n.props.handle&&!(0,Ne.matchesSelectorAndParentsTo)(s.target,n.props.handle,a)||n.props.cancel&&(0,Ne.matchesSelectorAndParentsTo)(s.target,n.props.cancel,a))){s.type==="touchstart"&&s.preventDefault();var c=(0,Ne.getTouchIdentifier)(s);n.setState({touchIdentifier:c});var h=(0,Rt.getControlPosition)(s,c,He(n));if(h!=null){var d=h.x,p=h.y,m=(0,Rt.createCoreData)(He(n),d,p);(0,Bn.default)("DraggableCore: handleDragStart: %j",m),(0,Bn.default)("calling",n.props.onStart);var w=n.props.onStart(s,m);w===!1||n.mounted===!1||(n.props.enableUserSelectHack&&(0,Ne.addUserSelectStyles)(u),n.setState({dragging:!0,lastX:d,lastY:p}),(0,Ne.addEvent)(u,Dt.move,n.handleDrag),(0,Ne.addEvent)(u,Dt.stop,n.handleDragStop))}}}),it(He(n),"handleDrag",function(s){var a=(0,Rt.getControlPosition)(s,n.state.touchIdentifier,He(n));if(a!=null){var u=a.x,c=a.y;if(Array.isArray(n.props.grid)){var h=u-n.state.lastX,d=c-n.state.lastY,p=(0,Rt.snapToGrid)(n.props.grid,h,d),m=sl(p,2);if(h=m[0],d=m[1],!h&&!d)return;u=n.state.lastX+h,c=n.state.lastY+d}var w=(0,Rt.createCoreData)(He(n),u,c);(0,Bn.default)("DraggableCore: handleDrag: %j",w);var y=n.props.onDrag(s,w);if(y===!1||n.mounted===!1){try{n.handleDragStop(new MouseEvent("mouseup"))}catch{var E=document.createEvent("MouseEvents");E.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.handleDragStop(E)}return}n.setState({lastX:u,lastY:c})}}),it(He(n),"handleDragStop",function(s){if(!!n.state.dragging){var a=(0,Rt.getControlPosition)(s,n.state.touchIdentifier,He(n));if(a!=null){var u=a.x,c=a.y;if(Array.isArray(n.props.grid)){var h=u-n.state.lastX||0,d=c-n.state.lastY||0,p=(0,Rt.snapToGrid)(n.props.grid,h,d),m=sl(p,2);h=m[0],d=m[1],u=n.state.lastX+h,c=n.state.lastY+d}var w=(0,Rt.createCoreData)(He(n),u,c),y=n.props.onStop(s,w);if(y===!1||n.mounted===!1)return!1;var E=n.findDOMNode();E&&n.props.enableUserSelectHack&&(0,Ne.removeUserSelectStyles)(E.ownerDocument),(0,Bn.default)("DraggableCore: handleDragStop: %j",w),n.setState({dragging:!1,lastX:NaN,lastY:NaN}),E&&((0,Bn.default)("DraggableCore: Removing handlers"),(0,Ne.removeEvent)(E.ownerDocument,Dt.move,n.handleDrag),(0,Ne.removeEvent)(E.ownerDocument,Dt.stop,n.handleDragStop))}}}),it(He(n),"onMouseDown",function(s){return Dt=ot.mouse,n.handleDragStart(s)}),it(He(n),"onMouseUp",function(s){return Dt=ot.mouse,n.handleDragStop(s)}),it(He(n),"onTouchStart",function(s){return Dt=ot.touch,n.handleDragStart(s)}),it(He(n),"onTouchEnd",function(s){return Dt=ot.touch,n.handleDragStop(s)}),n}return lp(e,[{key:"componentDidMount",value:function(){this.mounted=!0;var r=this.findDOMNode();r&&(0,Ne.addEvent)(r,ot.touch.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.findDOMNode();if(r){var o=r.ownerDocument;(0,Ne.removeEvent)(o,ot.mouse.move,this.handleDrag),(0,Ne.removeEvent)(o,ot.touch.move,this.handleDrag),(0,Ne.removeEvent)(o,ot.mouse.stop,this.handleDragStop),(0,Ne.removeEvent)(o,ot.touch.stop,this.handleDragStop),(0,Ne.removeEvent)(r,ot.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Ne.removeUserSelectStyles)(o)}}},{key:"findDOMNode",value:function(){var r,o,l;return(r=this.props)!==null&&r!==void 0&&r.nodeRef?(o=this.props)===null||o===void 0||(l=o.nodeRef)===null||l===void 0?void 0:l.current:tp.default.findDOMNode(this)}},{key:"render",value:function(){return Zr.cloneElement(Zr.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}]),e}(Zr.Component);fi.default=vi,it(vi,"displayName","DraggableCore"),it(vi,"propTypes",{allowAnyClick:Ye.default.bool,disabled:Ye.default.bool,enableUserSelectHack:Ye.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Ye.default.arrayOf(Ye.default.number),handle:Ye.default.string,cancel:Ye.default.string,nodeRef:Ye.default.object,onStart:Ye.default.func,onDrag:Ye.default.func,onStop:Ye.default.func,onMouseDown:Ye.default.func,scale:Ye.default.number,className:Yr.dontSetMe,style:Yr.dontSetMe,transform:Yr.dontSetMe}),it(vi,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),function(i){function t(D){return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},t(D)}Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),i.default=void 0;var e=m($t),n=d(Ln.exports),r=d($t),o=d(Ef),l=be,s=dt,a=ht,u=d(fi),c=d(pi),h=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function d(D){return D&&D.__esModule?D:{default:D}}function p(D){if(typeof WeakMap!="function")return null;var O=new WeakMap,H=new WeakMap;return(p=function(V){return V?H:O})(D)}function m(D,O){if(!O&&D&&D.__esModule)return D;if(D===null||t(D)!=="object"&&typeof D!="function")return{default:D};var H=p(O);if(H&&H.has(D))return H.get(D);var z={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in D)if(q!=="default"&&Object.prototype.hasOwnProperty.call(D,q)){var te=V?Object.getOwnPropertyDescriptor(D,q):null;te&&(te.get||te.set)?Object.defineProperty(z,q,te):z[q]=D[q]}return z.default=D,H&&H.set(D,z),z}function w(){return w=Object.assign||function(D){for(var O=1;O<arguments.length;O++){var H=arguments[O];for(var z in H)Object.prototype.hasOwnProperty.call(H,z)&&(D[z]=H[z])}return D},w.apply(this,arguments)}function y(D,O){if(D==null)return{};var H=E(D,O),z,V;if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(D);for(V=0;V<q.length;V++)z=q[V],!(O.indexOf(z)>=0)&&(!Object.prototype.propertyIsEnumerable.call(D,z)||(H[z]=D[z]))}return H}function E(D,O){if(D==null)return{};var H={},z=Object.keys(D),V,q;for(q=0;q<z.length;q++)V=z[q],!(O.indexOf(V)>=0)&&(H[V]=D[V]);return H}function T(D,O){var H=Object.keys(D);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(D);O&&(z=z.filter(function(V){return Object.getOwnPropertyDescriptor(D,V).enumerable})),H.push.apply(H,z)}return H}function C(D){for(var O=1;O<arguments.length;O++){var H=arguments[O]!=null?arguments[O]:{};O%2?T(Object(H),!0).forEach(function(z){Ee(D,z,H[z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(H)):T(Object(H)).forEach(function(z){Object.defineProperty(D,z,Object.getOwnPropertyDescriptor(H,z))})}return D}function B(D,O){return W(D)||G(D,O)||N(D,O)||M()}function M(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N(D,O){if(!!D){if(typeof D=="string")return I(D,O);var H=Object.prototype.toString.call(D).slice(8,-1);if(H==="Object"&&D.constructor&&(H=D.constructor.name),H==="Map"||H==="Set")return Array.from(D);if(H==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H))return I(D,O)}}function I(D,O){(O==null||O>D.length)&&(O=D.length);for(var H=0,z=new Array(O);H<O;H++)z[H]=D[H];return z}function G(D,O){var H=D==null?null:typeof Symbol!="undefined"&&D[Symbol.iterator]||D["@@iterator"];if(H!=null){var z=[],V=!0,q=!1,te,ce;try{for(H=H.call(D);!(V=(te=H.next()).done)&&(z.push(te.value),!(O&&z.length===O));V=!0);}catch(ae){q=!0,ce=ae}finally{try{!V&&H.return!=null&&H.return()}finally{if(q)throw ce}}return z}}function W(D){if(Array.isArray(D))return D}function ne(D,O){if(!(D instanceof O))throw new TypeError("Cannot call a class as a function")}function Q(D,O){for(var H=0;H<O.length;H++){var z=O[H];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(D,z.key,z)}}function $(D,O,H){return O&&Q(D.prototype,O),H&&Q(D,H),Object.defineProperty(D,"prototype",{writable:!1}),D}function oe(D,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(O&&O.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),Object.defineProperty(D,"prototype",{writable:!1}),O&&ve(D,O)}function ve(D,O){return ve=Object.setPrototypeOf||function(z,V){return z.__proto__=V,z},ve(D,O)}function Ue(D){var O=Ge();return function(){var z=De(D),V;if(O){var q=De(this).constructor;V=Reflect.construct(z,arguments,q)}else V=z.apply(this,arguments);return ye(this,V)}}function ye(D,O){if(O&&(t(O)==="object"||typeof O=="function"))return O;if(O!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pe(D)}function pe(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function Ge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function De(D){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(H){return H.__proto__||Object.getPrototypeOf(H)},De(D)}function Ee(D,O,H){return O in D?Object.defineProperty(D,O,{value:H,enumerable:!0,configurable:!0,writable:!0}):D[O]=H,D}var st=function(D){oe(H,D);var O=Ue(H);function H(z){var V;return ne(this,H),V=O.call(this,z),Ee(pe(V),"onDragStart",function(q,te){(0,c.default)("Draggable: onDragStart: %j",te);var ce=V.props.onStart(q,(0,s.createDraggableData)(pe(V),te));if(ce===!1)return!1;V.setState({dragging:!0,dragged:!0})}),Ee(pe(V),"onDrag",function(q,te){if(!V.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",te);var ce=(0,s.createDraggableData)(pe(V),te),ae={x:ce.x,y:ce.y};if(V.props.bounds){var Qe=ae.x,$e=ae.y;ae.x+=V.state.slackX,ae.y+=V.state.slackY;var et=(0,s.getBoundPosition)(pe(V),ae.x,ae.y),qe=B(et,2),at=qe[0],lt=qe[1];ae.x=at,ae.y=lt,ae.slackX=V.state.slackX+(Qe-ae.x),ae.slackY=V.state.slackY+($e-ae.y),ce.x=ae.x,ce.y=ae.y,ce.deltaX=ae.x-V.state.x,ce.deltaY=ae.y-V.state.y}var f=V.props.onDrag(q,ce);if(f===!1)return!1;V.setState(ae)}),Ee(pe(V),"onDragStop",function(q,te){if(!V.state.dragging)return!1;var ce=V.props.onStop(q,(0,s.createDraggableData)(pe(V),te));if(ce===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",te);var ae={dragging:!1,slackX:0,slackY:0},Qe=Boolean(V.props.position);if(Qe){var $e=V.props.position,et=$e.x,qe=$e.y;ae.x=et,ae.y=qe}V.setState(ae)}),V.state={dragging:!1,dragged:!1,x:z.position?z.position.x:z.defaultPosition.x,y:z.position?z.position.y:z.defaultPosition.y,prevPropsPosition:C({},z.position),slackX:0,slackY:0,isElementSVG:!1},z.position&&!(z.onDrag||z.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),V}return $(H,[{key:"componentDidMount",value:function(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var V,q,te;return(V=(q=this.props)===null||q===void 0||(te=q.nodeRef)===null||te===void 0?void 0:te.current)!==null&&V!==void 0?V:r.default.findDOMNode(this)}},{key:"render",value:function(){var V,q=this.props;q.axis,q.bounds;var te=q.children,ce=q.defaultPosition,ae=q.defaultClassName,Qe=q.defaultClassNameDragging,$e=q.defaultClassNameDragged,et=q.position,qe=q.positionOffset;q.scale;var at=y(q,h),lt={},f=null,S=Boolean(et),P=!S||this.state.dragging,k=et||ce,F={x:(0,s.canDragX)(this)&&P?this.state.x:k.x,y:(0,s.canDragY)(this)&&P?this.state.y:k.y};this.state.isElementSVG?f=(0,l.createSVGTransform)(F,qe):lt=(0,l.createCSSTransform)(F,qe);var X=(0,o.default)(te.props.className||"",ae,(V={},Ee(V,Qe,this.state.dragging),Ee(V,$e,this.state.dragged),V));return e.createElement(u.default,w({},at,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(te),{className:X,style:C(C({},te.props.style),lt),transform:f}))}}],[{key:"getDerivedStateFromProps",value:function(V,q){var te=V.position,ce=q.prevPropsPosition;return te&&(!ce||te.x!==ce.x||te.y!==ce.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:te,prevPropsPosition:ce}),{x:te.x,y:te.y,prevPropsPosition:C({},te)}):null}}]),H}(e.Component);i.default=st,Ee(st,"displayName","Draggable"),Ee(st,"propTypes",C(C({},u.default.propTypes),{},{axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe})),Ee(st,"defaultProps",C(C({},u.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))}(ja);var ul=ja,cl=ul.default,fp=ul.DraggableCore;hi.exports=cl,hi.exports.default=cl,hi.exports.DraggableCore=fp;var pp=hi.exports,gp=["second","minute","hour","day","week","month","year"];function mp(i,t){if(t===0)return["just now","right now"];var e=gp[Math.floor(t/2)];return i>1&&(e+="s"),[i+" "+e+" ago","in "+i+" "+e]}var vp=["\u79D2","\u5206\u949F","\u5C0F\u65F6","\u5929","\u5468","\u4E2A\u6708","\u5E74"];function yp(i,t){if(t===0)return["\u521A\u521A","\u7247\u523B\u540E"];var e=vp[~~(t/2)];return[i+" "+e+"\u524D",i+" "+e+"\u540E"]}var Qr={},Se=function(i,t){Qr[i]=t},hl=function(i){return Qr[i]||Qr.en_US},zt=[60,60,24,7,365/7/12,12];function dl(i){return i instanceof Date?i:!isNaN(i)||/^\d+$/.test(i)?new Date(parseInt(i)):(i=(i||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(i))}function fl(i,t){var e=i<0?1:0;i=Math.abs(i);for(var n=i,r=0;i>=zt[r]&&r<zt.length;r++)i/=zt[r];return i=Math.floor(i),r*=2,i>(r===0?9:1)&&(r+=1),t(i,r,n)[e].replace("%s",i.toString())}function pl(i,t){var e=t?dl(t):new Date;return(+e-+dl(i))/1e3}function wp(i){for(var t=1,e=0,n=Math.abs(i);i>=zt[e]&&e<zt.length;e++)i/=zt[e],t*=zt[e];return n=n%t,n=n?t-n:t,Math.ceil(n)}var bp=function(i,t,e){var n=pl(i,e&&e.relativeDate);return fl(n,hl(t))},gl="timeago-id";function Sp(i){return i.getAttribute("datetime")}function Ep(i,t){i.setAttribute(gl,t)}function ml(i){return parseInt(i.getAttribute(gl))}var $r={},eo=function(i){clearTimeout(i),delete $r[i]};function vl(i,t,e,n){eo(ml(i));var r=n.relativeDate,o=n.minInterval,l=pl(t,r);i.innerText=fl(l,e);var s=setTimeout(function(){vl(i,t,e,n)},Math.min(Math.max(wp(l),o||1)*1e3,2147483647));$r[s]=0,Ep(i,s)}function yl(i){i?eo(ml(i)):Object.keys($r).forEach(eo)}function _p(i,t,e){var n=i.length?i:[i];return n.forEach(function(r){vl(r,Sp(r),hl(t),e||{})}),n}Se("en_US",mp),Se("zh_CN",yp);var xp=globalThis&&globalThis.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},i(t,e)};return function(t,e){i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),to=globalThis&&globalThis.__assign||function(){return to=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},to.apply(this,arguments)},Tp=globalThis&&globalThis.__rest||function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(e[n[r]]=i[n[r]]);return e},Cp=function(i){return""+(i instanceof Date?i.getTime():i)},Pp=function(i){xp(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.dom=null,e}return t.prototype.componentDidMount=function(){this.renderTimeAgo()},t.prototype.componentDidUpdate=function(){this.renderTimeAgo()},t.prototype.renderTimeAgo=function(){var e=this.props,n=e.live,r=e.datetime,o=e.locale,l=e.opts;yl(this.dom),n!==!1&&(this.dom.setAttribute("datetime",Cp(r)),_p(this.dom,o,l))},t.prototype.componentWillUnmount=function(){yl(this.dom)},t.prototype.render=function(){var e=this,n=this.props,r=n.datetime;n.live;var o=n.locale,l=n.opts,s=Tp(n,["datetime","live","locale","opts"]);return Pe("time",to({ref:function(a){e.dom=a}},s),bp(r,o,l))},t.defaultProps={live:!0,className:""},t}(In);function Ap(i,t){const e=n=>{i.current&&!i.current.contains(event.target)&&t()};At(()=>(document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)))}var wl=Object.prototype.toString,bl=function(t){var e=wl.call(t),n=e==="[object Arguments]";return n||(n=e!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&wl.call(t.callee)==="[object Function]"),n},Sl;if(!Object.keys){var yi=Object.prototype.hasOwnProperty,El=Object.prototype.toString,Op=bl,_l=Object.prototype.propertyIsEnumerable,Rp=!_l.call({toString:null},"toString"),Dp=_l.call(function(){},"prototype"),wi=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],no=function(i){var t=i.constructor;return t&&t.prototype===i},Mp={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Ip=function(){if(typeof window=="undefined")return!1;for(var i in window)try{if(!Mp["$"+i]&&yi.call(window,i)&&window[i]!==null&&typeof window[i]=="object")try{no(window[i])}catch{return!0}}catch{return!0}return!1}(),Fp=function(i){if(typeof window=="undefined"||!Ip)return no(i);try{return no(i)}catch{return!1}};Sl=function(t){var e=t!==null&&typeof t=="object",n=El.call(t)==="[object Function]",r=Op(t),o=e&&El.call(t)==="[object String]",l=[];if(!e&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var s=Dp&&n;if(o&&t.length>0&&!yi.call(t,0))for(var a=0;a<t.length;++a)l.push(String(a));if(r&&t.length>0)for(var u=0;u<t.length;++u)l.push(String(u));else for(var c in t)!(s&&c==="prototype")&&yi.call(t,c)&&l.push(String(c));if(Rp)for(var h=Fp(t),d=0;d<wi.length;++d)!(h&&wi[d]==="constructor")&&yi.call(t,wi[d])&&l.push(wi[d]);return l}}var kp=Sl,Lp=Array.prototype.slice,Bp=bl,xl=Object.keys,bi=xl?function(t){return xl(t)}:kp,Tl=Object.keys;bi.shim=function(){if(Object.keys){var t=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);t||(Object.keys=function(n){return Bp(n)?Tl(Lp.call(n)):Tl(n)})}else Object.keys=bi;return Object.keys||bi};var Np=bi,Cl=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var r=42;t[e]=r;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,e);if(l.value!==r||l.enumerable!==!0)return!1}return!0},Pl=typeof Symbol!="undefined"&&Symbol,Hp=Cl,Al=function(){return typeof Pl!="function"||typeof Symbol!="function"||typeof Pl("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Hp()},Ol={foo:{}},zp=Object,Vp=function(){return{__proto__:Ol}.foo===Ol.foo&&!({__proto__:null}instanceof zp)},Up="Function.prototype.bind called on incompatible ",io=Array.prototype.slice,Wp=Object.prototype.toString,jp="[object Function]",Gp=function(t){var e=this;if(typeof e!="function"||Wp.call(e)!==jp)throw new TypeError(Up+e);for(var n=io.call(arguments,1),r,o=function(){if(this instanceof r){var c=e.apply(this,n.concat(io.call(arguments)));return Object(c)===c?c:this}else return e.apply(t,n.concat(io.call(arguments)))},l=Math.max(0,e.length-n.length),s=[],a=0;a<l;a++)s.push("$"+a);if(r=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var u=function(){};u.prototype=e.prototype,r.prototype=new u,u.prototype=null}return r},qp=Gp,ro=Function.prototype.bind||qp,Xp=ro,Rl=Xp.call(Function.call,Object.prototype.hasOwnProperty),ie,tn=SyntaxError,Dl=Function,nn=TypeError,oo=function(i){try{return Dl('"use strict"; return ('+i+").constructor;")()}catch{}},Vt=Object.getOwnPropertyDescriptor;if(Vt)try{Vt({},"")}catch{Vt=null}var so=function(){throw new nn},Zp=Vt?function(){try{return arguments.callee,so}catch{try{return Vt(arguments,"callee").get}catch{return so}}}():so,rn=Al(),Yp=Vp(),Ae=Object.getPrototypeOf||(Yp?function(i){return i.__proto__}:null),on={},Kp=typeof Uint8Array=="undefined"||!Ae?ie:Ae(Uint8Array),Ut={"%AggregateError%":typeof AggregateError=="undefined"?ie:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?ie:ArrayBuffer,"%ArrayIteratorPrototype%":rn&&Ae?Ae([][Symbol.iterator]()):ie,"%AsyncFromSyncIteratorPrototype%":ie,"%AsyncFunction%":on,"%AsyncGenerator%":on,"%AsyncGeneratorFunction%":on,"%AsyncIteratorPrototype%":on,"%Atomics%":typeof Atomics=="undefined"?ie:Atomics,"%BigInt%":typeof BigInt=="undefined"?ie:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?ie:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?ie:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?ie:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?ie:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?ie:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?ie:FinalizationRegistry,"%Function%":Dl,"%GeneratorFunction%":on,"%Int8Array%":typeof Int8Array=="undefined"?ie:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?ie:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?ie:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":rn&&Ae?Ae(Ae([][Symbol.iterator]())):ie,"%JSON%":typeof JSON=="object"?JSON:ie,"%Map%":typeof Map=="undefined"?ie:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!rn||!Ae?ie:Ae(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?ie:Promise,"%Proxy%":typeof Proxy=="undefined"?ie:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?ie:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?ie:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!rn||!Ae?ie:Ae(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?ie:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":rn&&Ae?Ae(""[Symbol.iterator]()):ie,"%Symbol%":rn?Symbol:ie,"%SyntaxError%":tn,"%ThrowTypeError%":Zp,"%TypedArray%":Kp,"%TypeError%":nn,"%Uint8Array%":typeof Uint8Array=="undefined"?ie:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?ie:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?ie:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?ie:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?ie:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?ie:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?ie:WeakSet};if(Ae)try{null.error}catch(i){var Jp=Ae(Ae(i));Ut["%Error.prototype%"]=Jp}var Qp=function i(t){var e;if(t==="%AsyncFunction%")e=oo("async function () {}");else if(t==="%GeneratorFunction%")e=oo("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=oo("async function* () {}");else if(t==="%AsyncGenerator%"){var n=i("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var r=i("%AsyncGenerator%");r&&Ae&&(e=Ae(r.prototype))}return Ut[t]=e,e},Ml={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Nn=ro,Si=Rl,$p=Nn.call(Function.call,Array.prototype.concat),eg=Nn.call(Function.apply,Array.prototype.splice),Il=Nn.call(Function.call,String.prototype.replace),Ei=Nn.call(Function.call,String.prototype.slice),tg=Nn.call(Function.call,RegExp.prototype.exec),ng=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ig=/\\(\\)?/g,rg=function(t){var e=Ei(t,0,1),n=Ei(t,-1);if(e==="%"&&n!=="%")throw new tn("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&e!=="%")throw new tn("invalid intrinsic syntax, expected opening `%`");var r=[];return Il(t,ng,function(o,l,s,a){r[r.length]=s?Il(a,ig,"$1"):l||o}),r},og=function(t,e){var n=t,r;if(Si(Ml,n)&&(r=Ml[n],n="%"+r[0]+"%"),Si(Ut,n)){var o=Ut[n];if(o===on&&(o=Qp(n)),typeof o=="undefined"&&!e)throw new nn("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new tn("intrinsic "+t+" does not exist!")},Fe=function(t,e){if(typeof t!="string"||t.length===0)throw new nn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new nn('"allowMissing" argument must be a boolean');if(tg(/^%?[^%]*%?$/,t)===null)throw new tn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=rg(t),r=n.length>0?n[0]:"",o=og("%"+r+"%",e),l=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],eg(n,$p([0,1],u)));for(var c=1,h=!0;c<n.length;c+=1){var d=n[c],p=Ei(d,0,1),m=Ei(d,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new tn("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(a=!0),r+="."+d,l="%"+r+"%",Si(Ut,l))s=Ut[l];else if(s!=null){if(!(d in s)){if(!e)throw new nn("base intrinsic for "+t+" exists, but the property is not available.");return}if(Vt&&c+1>=n.length){var w=Vt(s,d);h=!!w,h&&"get"in w&&!("originalValue"in w.get)?s=w.get:s=s[d]}else h=Si(s,d),s=s[d];h&&!a&&(Ut[l]=s)}}return s},sg=Fe,ao=sg("%Object.defineProperty%",!0),lo=function(){if(ao)try{return ao({},"a",{value:1}),!0}catch{return!1}return!1};lo.hasArrayLengthDefineBug=function(){if(!lo())return null;try{return ao([],"length",{value:1}).length!==1}catch{return!0}};var ag=lo,lg=Np,ug=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",cg=Object.prototype.toString,hg=Array.prototype.concat,Fl=Object.defineProperty,dg=function(i){return typeof i=="function"&&cg.call(i)==="[object Function]"},fg=ag(),kl=Fl&&fg,pg=function(i,t,e,n){if(t in i){if(n===!0){if(i[t]===e)return}else if(!dg(n)||!n())return}kl?Fl(i,t,{configurable:!0,enumerable:!1,value:e,writable:!0}):i[t]=e},Ll=function(i,t){var e=arguments.length>2?arguments[2]:{},n=lg(t);ug&&(n=hg.call(n,Object.getOwnPropertySymbols(t)));for(var r=0;r<n.length;r+=1)pg(i,n[r],t[n[r]],e[n[r]])};Ll.supportsDescriptors=!!kl;var sn=Ll,_i={exports:{}};(function(i){var t=ro,e=Fe,n=e("%Function.prototype.apply%"),r=e("%Function.prototype.call%"),o=e("%Reflect.apply%",!0)||t.call(r,n),l=e("%Object.getOwnPropertyDescriptor%",!0),s=e("%Object.defineProperty%",!0),a=e("%Math.max%");if(s)try{s({},"a",{value:1})}catch{s=null}i.exports=function(h){var d=o(t,r,arguments);if(l&&s){var p=l(d,"length");p.configurable&&s(d,"length",{value:1+a(0,h.length-(arguments.length-1))})}return d};var u=function(){return o(t,n,arguments)};s?s(i.exports,"apply",{value:u}):i.exports.apply=u})(_i);var Bl={exports:{}},gg="Function.prototype.bind called on incompatible ",uo=Array.prototype.slice,mg=Object.prototype.toString,vg="[object Function]",yg=function(t){var e=this;if(typeof e!="function"||mg.call(e)!==vg)throw new TypeError(gg+e);for(var n=uo.call(arguments,1),r,o=function(){if(this instanceof r){var c=e.apply(this,n.concat(uo.call(arguments)));return Object(c)===c?c:this}else return e.apply(t,n.concat(uo.call(arguments)))},l=Math.max(0,e.length-n.length),s=[],a=0;a<l;a++)s.push("$"+a);if(r=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var u=function(){};u.prototype=e.prototype,r.prototype=new u,u.prototype=null}return r},wg=yg,co=Function.prototype.bind||wg,bg=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var r=42;t[e]=r;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,e);if(l.value!==r||l.enumerable!==!0)return!1}return!0},Nl=typeof Symbol!="undefined"&&Symbol,Sg=bg,Eg=function(){return typeof Nl!="function"||typeof Symbol!="function"||typeof Nl("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Sg()},Hl={foo:{}},_g=Object,xg=function(){return{__proto__:Hl}.foo===Hl.foo&&!({__proto__:null}instanceof _g)},Tg=co,Cg=Tg.call(Function.call,Object.prototype.hasOwnProperty),re,an=SyntaxError,zl=Function,ln=TypeError,ho=function(i){try{return zl('"use strict"; return ('+i+").constructor;")()}catch{}},Wt=Object.getOwnPropertyDescriptor;if(Wt)try{Wt({},"")}catch{Wt=null}var fo=function(){throw new ln},Pg=Wt?function(){try{return arguments.callee,fo}catch{try{return Wt(arguments,"callee").get}catch{return fo}}}():fo,un=Eg(),Ag=xg(),Oe=Object.getPrototypeOf||(Ag?function(i){return i.__proto__}:null),cn={},Og=typeof Uint8Array=="undefined"||!Oe?re:Oe(Uint8Array),jt={"%AggregateError%":typeof AggregateError=="undefined"?re:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?re:ArrayBuffer,"%ArrayIteratorPrototype%":un&&Oe?Oe([][Symbol.iterator]()):re,"%AsyncFromSyncIteratorPrototype%":re,"%AsyncFunction%":cn,"%AsyncGenerator%":cn,"%AsyncGeneratorFunction%":cn,"%AsyncIteratorPrototype%":cn,"%Atomics%":typeof Atomics=="undefined"?re:Atomics,"%BigInt%":typeof BigInt=="undefined"?re:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?re:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?re:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?re:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?re:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?re:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?re:FinalizationRegistry,"%Function%":zl,"%GeneratorFunction%":cn,"%Int8Array%":typeof Int8Array=="undefined"?re:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?re:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?re:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":un&&Oe?Oe(Oe([][Symbol.iterator]())):re,"%JSON%":typeof JSON=="object"?JSON:re,"%Map%":typeof Map=="undefined"?re:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!un||!Oe?re:Oe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?re:Promise,"%Proxy%":typeof Proxy=="undefined"?re:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?re:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?re:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!un||!Oe?re:Oe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?re:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":un&&Oe?Oe(""[Symbol.iterator]()):re,"%Symbol%":un?Symbol:re,"%SyntaxError%":an,"%ThrowTypeError%":Pg,"%TypedArray%":Og,"%TypeError%":ln,"%Uint8Array%":typeof Uint8Array=="undefined"?re:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?re:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?re:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?re:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?re:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?re:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?re:WeakSet};if(Oe)try{null.error}catch(i){var Rg=Oe(Oe(i));jt["%Error.prototype%"]=Rg}var Dg=function i(t){var e;if(t==="%AsyncFunction%")e=ho("async function () {}");else if(t==="%GeneratorFunction%")e=ho("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=ho("async function* () {}");else if(t==="%AsyncGenerator%"){var n=i("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var r=i("%AsyncGenerator%");r&&Oe&&(e=Oe(r.prototype))}return jt[t]=e,e},Vl={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Hn=co,xi=Cg,Mg=Hn.call(Function.call,Array.prototype.concat),Ig=Hn.call(Function.apply,Array.prototype.splice),Ul=Hn.call(Function.call,String.prototype.replace),Ti=Hn.call(Function.call,String.prototype.slice),Fg=Hn.call(Function.call,RegExp.prototype.exec),kg=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Lg=/\\(\\)?/g,Bg=function(t){var e=Ti(t,0,1),n=Ti(t,-1);if(e==="%"&&n!=="%")throw new an("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&e!=="%")throw new an("invalid intrinsic syntax, expected opening `%`");var r=[];return Ul(t,kg,function(o,l,s,a){r[r.length]=s?Ul(a,Lg,"$1"):l||o}),r},Ng=function(t,e){var n=t,r;if(xi(Vl,n)&&(r=Vl[n],n="%"+r[0]+"%"),xi(jt,n)){var o=jt[n];if(o===cn&&(o=Dg(n)),typeof o=="undefined"&&!e)throw new ln("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new an("intrinsic "+t+" does not exist!")},Hg=function(t,e){if(typeof t!="string"||t.length===0)throw new ln("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new ln('"allowMissing" argument must be a boolean');if(Fg(/^%?[^%]*%?$/,t)===null)throw new an("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Bg(t),r=n.length>0?n[0]:"",o=Ng("%"+r+"%",e),l=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],Ig(n,Mg([0,1],u)));for(var c=1,h=!0;c<n.length;c+=1){var d=n[c],p=Ti(d,0,1),m=Ti(d,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new an("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(a=!0),r+="."+d,l="%"+r+"%",xi(jt,l))s=jt[l];else if(s!=null){if(!(d in s)){if(!e)throw new ln("base intrinsic for "+t+" exists, but the property is not available.");return}if(Wt&&c+1>=n.length){var w=Wt(s,d);h=!!w,h&&"get"in w&&!("originalValue"in w.get)?s=w.get:s=s[d]}else h=xi(s,d),s=s[d];h&&!a&&(jt[l]=s)}}return s};(function(i){var t=co,e=Hg,n=e("%Function.prototype.apply%"),r=e("%Function.prototype.call%"),o=e("%Reflect.apply%",!0)||t.call(r,n),l=e("%Object.getOwnPropertyDescriptor%",!0),s=e("%Object.defineProperty%",!0),a=e("%Math.max%");if(s)try{s({},"a",{value:1})}catch{s=null}i.exports=function(h){var d=o(t,r,arguments);if(l&&s){var p=l(d,"length");p.configurable&&s(d,"length",{value:1+a(0,h.length-(arguments.length-1))})}return d};var u=function(){return o(t,n,arguments)};s?s(i.exports,"apply",{value:u}):i.exports.apply=u})(Bl);var Wl=Fe,jl=Bl.exports,zg=jl(Wl("String.prototype.indexOf")),St=function(t,e){var n=Wl(t,!!e);return typeof n=="function"&&zg(t,".prototype.")>-1?jl(n):n},Vg=Fe,Ug=Vg("%TypeError%"),Wg=function(t,e){if(t==null)throw new Ug(e||"Cannot call method on "+t);return t},zn=Wg,jg=Fe,Gl=jg("%Array%"),Gg=!Gl.isArray&&St("Object.prototype.toString"),qg=Gl.isArray||function(t){return Gg(t)==="[object Array]"},Xg=qg,ql=Fe,Zg=St,Yg=ql("%TypeError%"),Kg=Xg,Jg=ql("%Reflect.apply%",!0)||Zg("Function.prototype.apply"),Qg=function(t,e){var n=arguments.length>2?arguments[2]:[];if(!Kg(n))throw new Yg("Assertion failed: optional `argumentsList`, if provided, must be a List");return Jg(t,e,n)},$g={},em=Object.freeze(Object.defineProperty({__proto__:null,default:$g},Symbol.toStringTag,{value:"Module"})),tm=Vr(em),po=typeof Map=="function"&&Map.prototype,go=Object.getOwnPropertyDescriptor&&po?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ci=po&&go&&typeof go.get=="function"?go.get:null,Xl=po&&Map.prototype.forEach,mo=typeof Set=="function"&&Set.prototype,vo=Object.getOwnPropertyDescriptor&&mo?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Pi=mo&&vo&&typeof vo.get=="function"?vo.get:null,Zl=mo&&Set.prototype.forEach,nm=typeof WeakMap=="function"&&WeakMap.prototype,Vn=nm?WeakMap.prototype.has:null,im=typeof WeakSet=="function"&&WeakSet.prototype,Un=im?WeakSet.prototype.has:null,rm=typeof WeakRef=="function"&&WeakRef.prototype,Yl=rm?WeakRef.prototype.deref:null,om=Boolean.prototype.valueOf,sm=Object.prototype.toString,am=Function.prototype.toString,lm=String.prototype.match,yo=String.prototype.slice,Mt=String.prototype.replace,um=String.prototype.toUpperCase,Kl=String.prototype.toLowerCase,Jl=RegExp.prototype.test,Ql=Array.prototype.concat,ft=Array.prototype.join,cm=Array.prototype.slice,$l=Math.floor,wo=typeof BigInt=="function"?BigInt.prototype.valueOf:null,bo=Object.getOwnPropertySymbols,So=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,hn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ze=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===hn?"object":"symbol")?Symbol.toStringTag:null,eu=Object.prototype.propertyIsEnumerable,tu=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(i){return i.__proto__}:null);function nu(i,t){if(i===1/0||i===-1/0||i!==i||i&&i>-1e3&&i<1e3||Jl.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof i=="number"){var n=i<0?-$l(-i):$l(i);if(n!==i){var r=String(n),o=yo.call(t,r.length+1);return Mt.call(r,e,"$&_")+"."+Mt.call(Mt.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Mt.call(t,e,"$&_")}var Eo=tm,iu=Eo.custom,ru=au(iu)?iu:null,hm=function i(t,e,n,r){var o=e||{};if(It(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(It(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=It(o,"customInspect")?o.customInspect:!0;if(typeof l!="boolean"&&l!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(It(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(It(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var s=o.numericSeparator;if(typeof t=="undefined")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return uu(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var a=String(t);return s?nu(t,a):a}if(typeof t=="bigint"){var u=String(t)+"n";return s?nu(t,u):u}var c=typeof o.depth=="undefined"?5:o.depth;if(typeof n=="undefined"&&(n=0),n>=c&&c>0&&typeof t=="object")return _o(t)?"[Array]":"[Object]";var h=Om(o,n);if(typeof r=="undefined")r=[];else if(lu(r,t)>=0)return"[Circular]";function d(oe,ve,Ue){if(ve&&(r=cm.call(r),r.push(ve)),Ue){var ye={depth:o.depth};return It(o,"quoteStyle")&&(ye.quoteStyle=o.quoteStyle),i(oe,ye,n+1,r)}return i(oe,o,n+1,r)}if(typeof t=="function"&&!su(t)){var p=bm(t),m=Ai(t,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+ft.call(m,", ")+" }":"")}if(au(t)){var w=hn?Mt.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):So.call(t);return typeof t=="object"&&!hn?Wn(w):w}if(Cm(t)){for(var y="<"+Kl.call(String(t.nodeName)),E=t.attributes||[],T=0;T<E.length;T++)y+=" "+E[T].name+"="+ou(dm(E[T].value),"double",o);return y+=">",t.childNodes&&t.childNodes.length&&(y+="..."),y+="</"+Kl.call(String(t.nodeName))+">",y}if(_o(t)){if(t.length===0)return"[]";var C=Ai(t,d);return h&&!Am(C)?"["+To(C,h)+"]":"[ "+ft.call(C,", ")+" ]"}if(pm(t)){var B=Ai(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!eu.call(t,"cause")?"{ ["+String(t)+"] "+ft.call(Ql.call("[cause]: "+d(t.cause),B),", ")+" }":B.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+ft.call(B,", ")+" }"}if(typeof t=="object"&&l){if(ru&&typeof t[ru]=="function"&&Eo)return Eo(t,{depth:c-n});if(l!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(Sm(t)){var M=[];return Xl&&Xl.call(t,function(oe,ve){M.push(d(ve,t,!0)+" => "+d(oe,t))}),cu("Map",Ci.call(t),M,h)}if(xm(t)){var N=[];return Zl&&Zl.call(t,function(oe){N.push(d(oe,t))}),cu("Set",Pi.call(t),N,h)}if(Em(t))return xo("WeakMap");if(Tm(t))return xo("WeakSet");if(_m(t))return xo("WeakRef");if(mm(t))return Wn(d(Number(t)));if(ym(t))return Wn(d(wo.call(t)));if(vm(t))return Wn(om.call(t));if(gm(t))return Wn(d(String(t)));if(!fm(t)&&!su(t)){var I=Ai(t,d),G=tu?tu(t)===Object.prototype:t instanceof Object||t.constructor===Object,W=t instanceof Object?"":"null prototype",ne=!G&&ze&&Object(t)===t&&ze in t?yo.call(Ft(t),8,-1):W?"Object":"",Q=G||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",$=Q+(ne||W?"["+ft.call(Ql.call([],ne||[],W||[]),": ")+"] ":"");return I.length===0?$+"{}":h?$+"{"+To(I,h)+"}":$+"{ "+ft.call(I,", ")+" }"}return String(t)};function ou(i,t,e){var n=(e.quoteStyle||t)==="double"?'"':"'";return n+i+n}function dm(i){return Mt.call(String(i),/"/g,"&quot;")}function _o(i){return Ft(i)==="[object Array]"&&(!ze||!(typeof i=="object"&&ze in i))}function fm(i){return Ft(i)==="[object Date]"&&(!ze||!(typeof i=="object"&&ze in i))}function su(i){return Ft(i)==="[object RegExp]"&&(!ze||!(typeof i=="object"&&ze in i))}function pm(i){return Ft(i)==="[object Error]"&&(!ze||!(typeof i=="object"&&ze in i))}function gm(i){return Ft(i)==="[object String]"&&(!ze||!(typeof i=="object"&&ze in i))}function mm(i){return Ft(i)==="[object Number]"&&(!ze||!(typeof i=="object"&&ze in i))}function vm(i){return Ft(i)==="[object Boolean]"&&(!ze||!(typeof i=="object"&&ze in i))}function au(i){if(hn)return i&&typeof i=="object"&&i instanceof Symbol;if(typeof i=="symbol")return!0;if(!i||typeof i!="object"||!So)return!1;try{return So.call(i),!0}catch{}return!1}function ym(i){if(!i||typeof i!="object"||!wo)return!1;try{return wo.call(i),!0}catch{}return!1}var wm=Object.prototype.hasOwnProperty||function(i){return i in this};function It(i,t){return wm.call(i,t)}function Ft(i){return sm.call(i)}function bm(i){if(i.name)return i.name;var t=lm.call(am.call(i),/^function\s*([\w$]+)/);return t?t[1]:null}function lu(i,t){if(i.indexOf)return i.indexOf(t);for(var e=0,n=i.length;e<n;e++)if(i[e]===t)return e;return-1}function Sm(i){if(!Ci||!i||typeof i!="object")return!1;try{Ci.call(i);try{Pi.call(i)}catch{return!0}return i instanceof Map}catch{}return!1}function Em(i){if(!Vn||!i||typeof i!="object")return!1;try{Vn.call(i,Vn);try{Un.call(i,Un)}catch{return!0}return i instanceof WeakMap}catch{}return!1}function _m(i){if(!Yl||!i||typeof i!="object")return!1;try{return Yl.call(i),!0}catch{}return!1}function xm(i){if(!Pi||!i||typeof i!="object")return!1;try{Pi.call(i);try{Ci.call(i)}catch{return!0}return i instanceof Set}catch{}return!1}function Tm(i){if(!Un||!i||typeof i!="object")return!1;try{Un.call(i,Un);try{Vn.call(i,Vn)}catch{return!0}return i instanceof WeakSet}catch{}return!1}function Cm(i){return!i||typeof i!="object"?!1:typeof HTMLElement!="undefined"&&i instanceof HTMLElement?!0:typeof i.nodeName=="string"&&typeof i.getAttribute=="function"}function uu(i,t){if(i.length>t.maxStringLength){var e=i.length-t.maxStringLength,n="... "+e+" more character"+(e>1?"s":"");return uu(yo.call(i,0,t.maxStringLength),t)+n}var r=Mt.call(Mt.call(i,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Pm);return ou(r,"single",t)}function Pm(i){var t=i.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+um.call(t.toString(16))}function Wn(i){return"Object("+i+")"}function xo(i){return i+" { ? }"}function cu(i,t,e,n){var r=n?To(e,n):ft.call(e,", ");return i+" ("+t+") {"+r+"}"}function Am(i){for(var t=0;t<i.length;t++)if(lu(i[t],`
`)>=0)return!1;return!0}function Om(i,t){var e;if(i.indent==="	")e="	";else if(typeof i.indent=="number"&&i.indent>0)e=ft.call(Array(i.indent+1)," ");else return null;return{base:e,prev:ft.call(Array(t+1),e)}}function To(i,t){if(i.length===0)return"";var e=`
`+t.prev+t.base;return e+ft.call(i,","+e)+`
`+t.prev}function Ai(i,t){var e=_o(i),n=[];if(e){n.length=i.length;for(var r=0;r<i.length;r++)n[r]=It(i,r)?t(i[r],i):""}var o=typeof bo=="function"?bo(i):[],l;if(hn){l={};for(var s=0;s<o.length;s++)l["$"+o[s]]=o[s]}for(var a in i)!It(i,a)||e&&String(Number(a))===a&&a<i.length||hn&&l["$"+a]instanceof Symbol||(Jl.call(/[^\w$]/,a)?n.push(t(a,i)+": "+t(i[a],i)):n.push(a+": "+t(i[a],i)));if(typeof bo=="function")for(var u=0;u<o.length;u++)eu.call(i,o[u])&&n.push("["+t(o[u])+"]: "+t(i[o[u]],i));return n}var hu=function(t){return typeof t=="string"||typeof t=="symbol"},Rm=function(t){if(t===null)return"Null";if(typeof t=="undefined")return"Undefined";if(typeof t=="function"||typeof t=="object")return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"},Dm=Rm,jn=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":Dm(t)},Mm=Fe,du=Mm("%TypeError%"),Im=hm,Fm=hu,km=jn,fu=function(t,e){if(km(t)!=="Object")throw new du("Assertion failed: Type(O) is not Object");if(!Fm(e))throw new du("Assertion failed: IsPropertyKey(P) is not true, got "+Im(e));return t[e]},Lm=Fe,pu=Lm("%TypeError%"),Bm=hu,Nm=jn,Hm=function(t,e){if(Nm(t)!=="Object")throw new pu("Assertion failed: `O` must be an Object");if(!Bm(e))throw new pu("Assertion failed: `P` must be a Property Key");return e in t},gu=Function.prototype.toString,dn=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Co,Oi;if(typeof dn=="function"&&typeof Object.defineProperty=="function")try{Co=Object.defineProperty({},"length",{get:function(){throw Oi}}),Oi={},dn(function(){throw 42},null,Co)}catch(i){i!==Oi&&(dn=null)}else dn=null;var zm=/^\s*class\b/,Po=function(t){try{var e=gu.call(t);return zm.test(e)}catch{return!1}},Ao=function(t){try{return Po(t)?!1:(gu.call(t),!0)}catch{return!1}},Ri=Object.prototype.toString,Vm="[object Object]",Um="[object Function]",Wm="[object GeneratorFunction]",jm="[object HTMLAllCollection]",Gm="[object HTML document.all class]",qm="[object HTMLCollection]",Xm=typeof Symbol=="function"&&!!Symbol.toStringTag,Zm=!(0 in[,]),Oo=function(){return!1};if(typeof document=="object"){var Ym=document.all;Ri.call(Ym)===Ri.call(document.all)&&(Oo=function(t){if((Zm||!t)&&(typeof t=="undefined"||typeof t=="object"))try{var e=Ri.call(t);return(e===jm||e===Gm||e===qm||e===Vm)&&t("")==null}catch{}return!1})}var mu=dn?function(t){if(Oo(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{dn(t,null,Co)}catch(e){if(e!==Oi)return!1}return!Po(t)&&Ao(t)}:function(t){if(Oo(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Xm)return Ao(t);if(Po(t))return!1;var e=Ri.call(t);return e!==Um&&e!==Wm&&!/^\[object HTML/.test(e)?!1:Ao(t)},Km=mu,vu=Fe,Jm=vu("%Math%"),Qm=vu("%Number%"),$m=Qm.MAX_SAFE_INTEGER||Jm.pow(2,53)-1,ev=Fe,tv=ev("%Math.abs%"),nv=function(t){return tv(t)},iv=jn,rv=Math.floor,ov=function(t){return iv(t)==="BigInt"?t:rv(t)},sv=function(t){return t===null||typeof t!="function"&&typeof t!="object"},av=function(t){return t===null||typeof t!="function"&&typeof t!="object"},lv=Cl,Ro=function(){return lv()&&!!Symbol.toStringTag},uv=Date.prototype.getDay,cv=function(t){try{return uv.call(t),!0}catch{return!1}},hv=Object.prototype.toString,dv="[object Date]",fv=Ro(),pv=function(t){return typeof t!="object"||t===null?!1:fv?cv(t):hv.call(t)===dv},Do={exports:{}},gv=Object.prototype.toString,mv=Al();if(mv){var vv=Symbol.prototype.toString,yv=/^Symbol\(.*\)$/,wv=function(t){return typeof t.valueOf()!="symbol"?!1:yv.test(vv.call(t))};Do.exports=function(t){if(typeof t=="symbol")return!0;if(gv.call(t)!=="[object Symbol]")return!1;try{return wv(t)}catch{return!1}}}else Do.exports=function(t){return!1};var bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",Mo=av,yu=mu,Sv=pv,wu=Do.exports,Ev=function(t,e){if(typeof t=="undefined"||t===null)throw new TypeError("Cannot call method on "+t);if(typeof e!="string"||e!=="number"&&e!=="string")throw new TypeError('hint must be "string" or "number"');var n=e==="string"?["toString","valueOf"]:["valueOf","toString"],r,o,l;for(l=0;l<n.length;++l)if(r=t[n[l]],yu(r)&&(o=r.call(t),Mo(o)))return o;throw new TypeError("No default value")},_v=function(t,e){var n=t[e];if(n!==null&&typeof n!="undefined"){if(!yu(n))throw new TypeError(n+" returned for property "+e+" of object "+t+" is not a function");return n}},xv=function(t){if(Mo(t))return t;var e="default";arguments.length>1&&(arguments[1]===String?e="string":arguments[1]===Number&&(e="number"));var n;if(bv&&(Symbol.toPrimitive?n=_v(t,Symbol.toPrimitive):wu(t)&&(n=Symbol.prototype.valueOf)),typeof n!="undefined"){var r=n.call(t,e);if(Mo(r))return r;throw new TypeError("unable to convert exotic object to primitive")}return e==="default"&&(Sv(t)||wu(t))&&(e="string"),Ev(t,e==="default"?"number":e)},bu=xv,Tv=function(t){return arguments.length>1?bu(t,arguments[1]):bu(t)},Io=St,Su=Ro(),Eu,_u,Fo,ko;if(Su){Eu=Io("Object.prototype.hasOwnProperty"),_u=Io("RegExp.prototype.exec"),Fo={};var Lo=function(){throw Fo};ko={toString:Lo,valueOf:Lo},typeof Symbol.toPrimitive=="symbol"&&(ko[Symbol.toPrimitive]=Lo)}var Cv=Io("Object.prototype.toString"),Pv=Object.getOwnPropertyDescriptor,Av="[object RegExp]",Ov=Su?function(t){if(!t||typeof t!="object")return!1;var e=Pv(t,"lastIndex"),n=e&&Eu(e,"value");if(!n)return!1;try{_u(t,ko)}catch(r){return r===Fo}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:Cv(t)===Av},Rv=St,Dv=Fe,Mv=Ov,Iv=Rv("RegExp.prototype.exec"),Fv=Dv("%TypeError%"),kv=function(t){if(!Mv(t))throw new Fv("`regex` must be a RegExp");return function(n){return Iv(t,n)!==null}},xu=Fe,Lv=xu("%String%"),Bv=xu("%TypeError%"),Tu=function(t){if(typeof t=="symbol")throw new Bv("Cannot convert a Symbol value to a string");return Lv(t)},Nv=zn,Hv=Tu,zv=St,Cu=zv("String.prototype.replace"),Pu=/^\s$/.test("\u180E"),Vv=Pu?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,Uv=Pu?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,Au=function(){var t=Hv(Nv(this));return Cu(Cu(t,Vv,""),Uv,"")},Wv=Au,Ou="\u200B",fn="\u180E",Ru=function(){return String.prototype.trim&&Ou.trim()===Ou&&fn.trim()===fn&&("_"+fn).trim()==="_"+fn&&(fn+"_").trim()===fn+"_"?String.prototype.trim:Wv},jv=sn,Gv=Ru,qv=function(){var t=Gv();return jv(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t},Xv=_i.exports,Zv=sn,Yv=zn,Kv=Au,Du=Ru,Jv=qv,Qv=Xv(Du()),Mu=function(t){return Yv(t),Qv(t)};Zv(Mu,{getPolyfill:Du,implementation:Kv,shim:Jv});var Iu=Mu,Di=Fe,Bo=Di("%Number%"),$v=Di("%RegExp%"),ey=Di("%TypeError%"),Fu=Di("%parseInt%"),ty=St,Mi=kv,ku=ty("String.prototype.slice"),ny=Mi(/^0b[01]+$/i),iy=Mi(/^0o[0-7]+$/i),ry=Mi(/^[-+]0x[0-9a-f]+$/i),oy=["\x85","\u200B","\uFFFE"].join(""),sy=new $v("["+oy+"]","g"),ay=Mi(sy),ly=Iu,uy=jn,cy=function i(t){if(uy(t)!=="String")throw new ey("Assertion failed: `argument` is not a String");if(ny(t))return Bo(Fu(ku(t,2),2));if(iy(t))return Bo(Fu(ku(t,2),8));if(ay(t)||ry(t))return NaN;var e=ly(t);return e!==t?i(e):Bo(t)},Lu=Fe,Bu=Lu("%TypeError%"),Nu=Lu("%Number%"),hy=sv,dy=Tv,fy=cy,py=function(t){var e=hy(t)?t:dy(t,Nu);if(typeof e=="symbol")throw new Bu("Cannot convert a Symbol value to a number");if(typeof e=="bigint")throw new Bu("Conversion from 'BigInt' to 'number' is not allowed.");return typeof e=="string"?fy(e):Nu(e)},Hu=Number.isNaN||function(t){return t!==t},gy=Hu,my=function(i){return(typeof i=="number"||typeof i=="bigint")&&!gy(i)&&i!==1/0&&i!==-1/0},vy=function(t){return t>=0?1:-1},yy=nv,wy=ov,by=py,Sy=Hu,Ey=my,_y=vy,xy=function(t){var e=by(t);if(Sy(e)||e===0)return 0;if(!Ey(e))return e;var n=wy(yy(e));return n===0?0:_y(e)*n},zu=$m,Ty=xy,Cy=function(t){var e=Ty(t);return e<=0?0:e>zu?zu:e},Py=Fe,Ay=Py("%TypeError%"),Oy=fu,Ry=Cy,Dy=jn,My=function(t){if(Dy(t)!=="Object")throw new Ay("Assertion failed: `obj` must be an Object");return Ry(Oy(t,"length"))},Iy=Fe,Fy=Iy("%Object%"),ky=zn,Ly=function(t){return ky(t),Fy(t)},By=String.prototype.valueOf,Ny=function(t){try{return By.call(t),!0}catch{return!1}},Hy=Object.prototype.toString,zy="[object String]",Vy=Ro(),Uy=function(t){return typeof t=="string"?!0:typeof t!="object"?!1:Vy?Ny(t):Hy.call(t)===zy},Wy=Fe,jy=St,Gy=Wy("%TypeError%"),qy=Qg,Xy=fu,Zy=Hm,Yy=Km,Ky=My,Jy=Ly,Qy=Tu,$y=Uy,e0=jy("String.prototype.split"),Vu=Object("a"),t0=Vu[0]!=="a"||!(0 in Vu),Uu=function(t){var e=Jy(this),n=t0&&$y(this)?e0(this,""):e,r=Ky(n);if(!Yy(t))throw new Gy("Array.prototype.forEach callback must be a function");var o;arguments.length>1&&(o=arguments[1]);for(var l=0;l<r;){var s=Qy(l),a=Zy(n,s);if(a){var u=Xy(n,s);qy(t,o,[u,l,n])}l+=1}},n0=function(t){var e=!0,n=!0,r=!1;if(typeof t=="function"){try{t.call("f",function(o,l,s){typeof s!="object"&&(e=!1)}),t.call([null],function(){"use strict";n=typeof this=="string"},"x")}catch{r=!0}return!r&&e&&n}return!1},i0=n0,r0=Uu,Wu=function(){var t=Array.prototype.forEach;return i0(t)?t:r0},o0=sn,s0=Wu,a0=function(){var t=s0();return o0(Array.prototype,{forEach:t},{forEach:function(){return Array.prototype.forEach!==t}}),t},l0=sn,u0=_i.exports,c0=St,h0=zn,d0=Uu,ju=Wu,f0=ju(),p0=a0,g0=c0("Array.prototype.slice"),m0=u0.apply(f0),Gu=function(t,e){return h0(t),m0(t,g0(arguments,1))};l0(Gu,{getPolyfill:ju,implementation:d0,shim:p0});var v0=Gu,y0=zn,qu=St,w0=qu("Object.prototype.propertyIsEnumerable"),b0=qu("Array.prototype.push"),Xu=function(t){var e=y0(t),n=[];for(var r in e)w0(e,r)&&b0(n,[r,e[r]]);return n},S0=Xu,Zu=function(){return typeof Object.entries=="function"?Object.entries:S0},E0=Zu,_0=sn,x0=function(){var t=E0();return _0(Object,{entries:t},{entries:function(){return Object.entries!==t}}),t},T0=sn,C0=_i.exports,P0=Xu,Yu=Zu,A0=x0,Ku=C0(Yu(),Object);T0(Ku,{getPolyfill:Yu,implementation:P0,shim:A0});var O0=Ku,Ii=v0,No=O0,Ju=Rl,R0=Iu,D0=function(t){},Qu=String.prototype.replace,$u=String.prototype.split,Fi="||||",Ho=function(i){var t=i%100,e=t%10;return t!==11&&e===1?0:2<=e&&e<=4&&!(t>=12&&t<=14)?1:2},ec={pluralTypes:{arabic:function(i){if(i<3)return i;var t=i%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:Ho,chinese:function(){return 0},croatian:Ho,french:function(i){return i>=2?1:0},german:function(i){return i!==1?1:0},russian:Ho,lithuanian:function(i){return i%10===1&&i%100!==11?0:i%10>=2&&i%10<=9&&(i%100<11||i%100>19)?1:2},czech:function(i){return i===1?0:i>=2&&i<=4?1:2},polish:function(i){if(i===1)return 0;var t=i%10;return 2<=t&&t<=4&&(i%100<10||i%100>=20)?1:2},icelandic:function(i){return i%10!==1||i%100===11?1:0},slovenian:function(i){var t=i%100;return t===1?0:t===2?1:t===3||t===4?2:3},romanian:function(i){if(i===1)return 0;var t=i%100;return i===0||t>=2&&t<=19?1:2}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is","mk"],slovenian:["sl-SL"],romanian:["ro"]}};function M0(i){var t={};return Ii(No(i),function(e){var n=e[0],r=e[1];Ii(r,function(o){t[o]=n})}),t}function I0(i,t){var e=M0(i.pluralTypeToLanguages);return e[t]||e[$u.call(t,/-/,1)[0]]||e.en}function F0(i,t,e){return i.pluralTypes[t](e)}function k0(){var i={};return function(t,e){var n=i[e];return n&&!t.pluralTypes[n]&&(n=null,i[e]=n),n||(n=I0(t,e),n&&(i[e]=n)),n}}function tc(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function L0(i){var t=i&&i.prefix||"%{",e=i&&i.suffix||"}";if(t===Fi||e===Fi)throw new RangeError('"'+Fi+'" token is reserved for pluralization');return new RegExp(tc(t)+"(.*?)"+tc(e),"g")}var B0=k0(),N0=/%\{(.*?)\}/g;function zo(i,t,e,n,r,o){if(typeof i!="string")throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(t==null)return i;var l=i,s=n||N0,a=o||Qu,u=typeof t=="number"?{smart_count:t}:t;if(u.smart_count!=null&&i){var c=r||ec,h=$u.call(i,Fi),d=e||"en",p=B0(c,d),m=F0(c,p,u.smart_count);l=R0(h[m]||h[0])}return l=a.call(l,s,function(w,y){return!Ju(u,y)||u[y]==null?w:u[y]}),l}function Et(i){var t=i||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var e=t.allowMissing?zo:null;this.onMissingKey=typeof t.onMissingKey=="function"?t.onMissingKey:e,this.warn=t.warn||D0,this.replaceImplementation=t.replace||Qu,this.tokenRegex=L0(t.interpolation),this.pluralRules=t.pluralRules||ec}Et.prototype.locale=function(i){return i&&(this.currentLocale=i),this.currentLocale},Et.prototype.extend=function(i,t){Ii(No(i||{}),function(e){var n=e[0],r=e[1],o=t?t+"."+n:n;typeof r=="object"?this.extend(r,o):this.phrases[o]=r},this)},Et.prototype.unset=function(i,t){typeof i=="string"?delete this.phrases[i]:Ii(No(i||{}),function(e){var n=e[0],r=e[1],o=t?t+"."+n:n;typeof r=="object"?this.unset(r,o):delete this.phrases[o]},this)},Et.prototype.clear=function(){this.phrases={}},Et.prototype.replace=function(i){this.clear(),this.extend(i)},Et.prototype.t=function(i,t){var e,n,r=t==null?{}:t;if(typeof this.phrases[i]=="string")e=this.phrases[i];else if(typeof r._=="string")e=r._;else if(this.onMissingKey){var o=this.onMissingKey;n=o(i,r,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)}else this.warn('Missing translation for key: "'+i+'"'),n=i;return typeof e=="string"&&(n=zo(e,r,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)),n},Et.prototype.has=function(i){return Ju(this.phrases,i)},Et.transformPhrase=function(t,e,n){return zo(t,e,n)};var H0=Et,z0={"Add a comment...":"\u0625\u0636\u0627\u0641\u0629 \u062A\u0639\u0644\u064A\u0642","Add a reply...":"\u0625\u0636\u0627\u0641\u0629 \u0631\u062F","Add tag...":"\u0625\u0636\u0627\u0641\u0629 \u0639\u0644\u0627\u0645\u0629",Cancel:"\u0625\u0644\u063A\u0627\u0621",Close:"\u0625\u063A\u0644\u0627\u0642",Edit:"Edit",Delete:"Delete",Ok:"\u062A\u0645"},V0={"Add a comment...":"Napsat koment\xE1\u0159...","Add a reply...":"Odpov\u011Bd\u011Bt...","Add tag...":"P\u0159idat \u0161t\xEDtek...",Cancel:"Zru\u0161it",Close:"Zav\u0159\xEDt",Edit:"Upravit",Delete:"Smazat",Ok:"Ok"},U0={"Add a comment...":"Kommentar schreiben...","Add a reply...":"Antwort schreiben...","Add tag...":"Tag...",Cancel:"Abbrechen",Close:"Schliessen",Edit:"Bearbeiten",Delete:"L\xF6schen",Ok:"Ok"},W0={"Add a comment...":"\u03A3\u03C7\u03BF\u03BB\u03AF\u03B1\u03C3\u03B5...","Add a reply...":"\u0391\u03C0\u03AC\u03BD\u03C4\u03B7\u03C3\u03B5...","Add tag...":"\u03A0\u03C1\u03CC\u03C3\u03B8\u03B5\u03C3\u03B5 tag...",Cancel:"\u0386\u03BA\u03C5\u03C1\u03BF",Close:"\u039A\u03BB\u03B5\u03AF\u03C3\u03B9\u03BC\u03BF",Edit:"\u0395\u03C0\u03B5\u03BE\u03B5\u03C1\u03B3\u03B1\u03C3\u03AF\u03B1",Delete:"\u0394\u03B9\u03B1\u03B3\u03C1\u03B1\u03C6\u03AE",Ok:"Ok"},j0={"Add a comment...":"Agregar un comentario...","Add a reply...":"Agregar una respuesta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Cerrar",Edit:"Editar",Delete:"Eliminar",Ok:"Ok"},G0={"Add a comment...":"Lis\xE4\xE4 kommentti","Add a reply...":"Lis\xE4\xE4 vastaus","Add tag...":"Lis\xE4\xE4 tunniste",Cancel:"Peruuta",Close:"Sulje",Edit:"Muokkaa",Delete:"Poista",Ok:"Ok"},q0={"Add a comment...":"Ajouter un commentaire...","Add a reply...":"Ajouter une r\xE9ponse...","Add tag...":"Ajouter une \xE9tiquette...",Cancel:"Annuler",Close:"Fermer",Edit:"\xC9diter",Delete:"Supprimer",Ok:"Ok"},X0={"Add a comment...":"Engadir un comentario...","Add a reply...":"Engadir unha resposta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Pechar",Edit:"Edit",Delete:"Delete",Ok:"Ok"},Z0={"Add a comment...":"\u091F\u093F\u092A\u094D\u092A\u0923\u0940 \u091C\u094B\u0921\u093C\u0947\u0902","Add a reply...":"\u091C\u0935\u093E\u092C \u0926\u0947\u0902","Add tag...":"\u091F\u0948\u0917 \u0932\u0917\u093E\u090F\u0901",Cancel:"\u0930\u0926\u094D\u0926 \u0915\u0930\u0947\u0902",Close:"\u092C\u0902\u0926 \u0915\u0930\u0947\u0902",Edit:"\u0938\u0902\u092A\u093E\u0926\u093F\u0924 \u0915\u0930\u0947\u0902",Delete:"\u0939\u091F\u093E\u090F\u0901",Ok:"\u0920\u0940\u0915 \u0939\u0948"},Y0={"Add a comment...":"Commenta...","Add a reply...":"Rispondi...","Add tag...":"Aggiungi tag...",Cancel:"Annulla",Close:"Chiudi",Edit:"Edit",Delete:"Delete",Ok:"Ok"},K0={"Add a comment...":"\u30B3\u30E1\u30F3\u30C8\u3092\u8FFD\u52A0\u3059\u308B...","Add a reply...":"\u8FD4\u4FE1\u3059\u308B...","Add tag...":"\u30BF\u30B0\u3092\u8FFD\u52A0\u3059\u308B...",Cancel:"\u30AD\u30E3\u30F3\u30BB\u30EB",Close:"\u9589\u3058\u308B",Edit:"\u7DE8\u96C6",Delete:"\u524A\u9664",Ok:"Ok"},J0={"Add a comment...":"\uB313\uAE00 \uCD94\uAC00","Add a reply...":"\uB2F5\uAE00 \uCD94\uAC00","Add tag...":"\uD0DC\uADF8 \uCD94\uAC00",Cancel:"\uCDE8\uC18C",Close:"\uB2EB\uAE30",Edit:"\uC218\uC815",Delete:"\uC0AD\uC81C",Ok:"\uD655\uC778"},Q0={"Add a comment...":"Commentaar toevoegen...","Add a reply...":"Antwoord toevoegen...","Add tag...":"Tag toevoegen...",Cancel:"Afbreken",Close:"Sluiten",Edit:"Bewerken",Delete:"Verwijderen",Ok:"Ok"},$0={"Add a comment...":"Adicionar um coment\xE1rio...","Add a reply...":"Adicionar uma resposta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Fechar",Edit:"Editar",Delete:"Apagar",Ok:"Ok"},ew={"Add a comment...":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439...","Add a reply...":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0442\u0432\u0435\u0442...","Add tag...":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0442\u044D\u0433...",Cancel:"\u041E\u0442\u043C\u0435\u043D\u0430",Close:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",Edit:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",Delete:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",Ok:"\u041E\u043A"},tw={"Add a comment...":"Skriv en kommentar...","Add a reply...":"Skriv ett svar...","Add tag...":"Tagg...",Cancel:"Cancel",Close:"St\xE4ng",Edit:"Edit",Delete:"Delete",Ok:"Ok"},nw={"Add a comment...":"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E04\u0E2D\u0E21\u0E40\u0E21\u0E19\u0E15\u0E4C...","Add a reply...":"\u0E15\u0E2D\u0E1A\u0E01\u0E25\u0E31\u0E1A...","Add tag...":"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E41\u0E17\u0E47\u0E01...",Cancel:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",Close:"\u0E1B\u0E34\u0E14",Edit:"\u0E41\u0E01\u0E49\u0E44\u0E02",Delete:"\u0E25\u0E1A",Ok:"\u0E15\u0E01\u0E25\u0E07"},iw={"Add a comment...":"Yorum ekle...","Add a reply...":"Cevap ekle...","Add tag...":"Tag Ekle...",Cancel:"\u0130ptal",Close:"Kapat",Edit:"D\xFCzenle",Delete:"Sil",Ok:"Tamam"},rw={"Add a comment...":"\u062A\u0628\u0635\u0631\u06C1 \u06A9\u0631\u06CC\u06BA","Add a reply...":"\u062C\u0648\u0627\u0628 \u062F\u06CC\u06BA","Add tag...":"\u0679\u06CC\u06AF \u0644\u06AF\u0627\u0626\u06CC\u06BA",Cancel:"\u0645\u0646\u0633\u0648\u062E \u06A9\u0631\u06CC\u06BA",Close:"\u0628\u0646\u062F \u06A9\u0631\u06CC\u06BA",Edit:"\u062A\u0631\u0645\u06CC\u0645 \u06A9\u0631\u06CC\u06BA",Delete:"\u06C1\u0679\u0627\u0626\u06CC\u06BA",Ok:"\u0679\u06BE\u06CC\u06A9 \u06C1\u06D2"},ow={"Add a comment...":"\u6DFB\u52A0\u8BC4\u8BBA...","Add a reply...":"\u6DFB\u52A0\u56DE\u590D...","Add tag...":"\u6DFB\u52A0\u6807\u7B7E...",Cancel:"\u53D6\u6D88",Close:"\u5173\u95ED",Edit:"\u7F16\u8F91",Delete:"\u5220\u9664",Ok:"\u786E\u8BA4"},sw={"Add a comment...":"\u6DFB\u52A0\u8A55\u8AD6...","Add a reply...":"\u6DFB\u52A0\u56DE\u8986...","Add tag...":"\u6DFB\u52A0\u6A19\u7C64...",Cancel:"\u53D6\u6D88",Close:"\u95DC\u9589",Edit:"\u7DE8\u8F2F",Delete:"\u522A\u9664",Ok:"\u78BA\u8A8D"},nc={};Object.defineProperty(nc,"__esModule",{value:!0});var Vo=[["\u062B\u0627\u0646\u064A\u0629","\u062B\u0627\u0646\u064A\u062A\u064A\u0646","%s \u062B\u0648\u0627\u0646","%s \u062B\u0627\u0646\u064A\u0629"],["\u062F\u0642\u064A\u0642\u0629","\u062F\u0642\u064A\u0642\u062A\u064A\u0646","%s \u062F\u0642\u0627\u0626\u0642","%s \u062F\u0642\u064A\u0642\u0629"],["\u0633\u0627\u0639\u0629","\u0633\u0627\u0639\u062A\u064A\u0646","%s \u0633\u0627\u0639\u0627\u062A","%s \u0633\u0627\u0639\u0629"],["\u064A\u0648\u0645","\u064A\u0648\u0645\u064A\u0646","%s \u0623\u064A\u0627\u0645","%s \u064A\u0648\u0645\u0627\u064B"],["\u0623\u0633\u0628\u0648\u0639","\u0623\u0633\u0628\u0648\u0639\u064A\u0646","%s \u0623\u0633\u0627\u0628\u064A\u0639","%s \u0623\u0633\u0628\u0648\u0639\u0627\u064B"],["\u0634\u0647\u0631","\u0634\u0647\u0631\u064A\u0646","%s \u0623\u0634\u0647\u0631","%s \u0634\u0647\u0631\u0627\u064B"],["\u0639\u0627\u0645","\u0639\u0627\u0645\u064A\u0646","%s \u0623\u0639\u0648\u0627\u0645","%s \u0639\u0627\u0645\u0627\u064B"]];function aw(i,t){return t<3?Vo[i][t-1]:t>=3&&t<=10?Vo[i][2]:Vo[i][3]}function lw(i,t){if(t===0)return["\u0645\u0646\u0630 \u0644\u062D\u0638\u0627\u062A","\u0628\u0639\u062F \u0644\u062D\u0638\u0627\u062A"];var e=aw(Math.floor(t/2),i);return["\u0645\u0646\u0630 "+e,"\u0628\u0639\u062F "+e]}var uw=nc.default=lw,ic={};Object.defineProperty(ic,"__esModule",{value:!0});function cw(i,t){var e=0,n=t==1||t==3||t==5||t==7||t==9||t==11||t==13;return n&&i>=5&&(e=1),[[["pr\xE1v\u011B te\u010F","pr\xE1v\u011B te\u010F"]],[["p\u0159ed %s vte\u0159inami","za %s vte\u0159iny"],["p\u0159ed %s vte\u0159inami","za %s vte\u0159in"]],[["p\u0159ed minutou","za minutu"]],[["p\u0159ed %s minutami","za %s minuty"],["p\u0159ed %s minutami","za %s minut"]],[["p\u0159ed hodinou","za hodinu"]],[["p\u0159ed %s hodinami","za %s hodiny"],["p\u0159ed %s hodinami","za %s hodin"]],[["v\u010Dera","z\xEDtra"]],[["p\u0159ed %s dny","za %s dny"],["p\u0159ed %s dny","za %s dn\u016F"]],[["minul\xFD t\xFDden","p\u0159\xED\u0161t\xED t\xFDden"]],[["p\u0159ed %s t\xFDdny","za %s t\xFDdny"],["p\u0159ed %s t\xFDdny","za %s t\xFDdn\u016F"]],[["minul\xFD m\u011Bs\xEDc","p\u0159\xEDst\xED m\u011Bs\xEDc"]],[["p\u0159ed %s m\u011Bs\xEDci","za %s m\u011Bs\xEDce"],["p\u0159ed %s m\u011Bs\xEDci","za %s m\u011Bs\xEDc\u016F"]],[["p\u0159ed rokem","p\u0159\xEDst\xED rok"]],[["p\u0159ed %s lety","za %s roky"],["p\u0159ed %s lety","za %s let"]]][t][e]}var hw=ic.default=cw,rc={};Object.defineProperty(rc,"__esModule",{value:!0});function dw(i,t){return[["gerade eben","vor einer Weile"],["vor %s Sekunden","in %s Sekunden"],["vor 1 Minute","in 1 Minute"],["vor %s Minuten","in %s Minuten"],["vor 1 Stunde","in 1 Stunde"],["vor %s Stunden","in %s Stunden"],["vor 1 Tag","in 1 Tag"],["vor %s Tagen","in %s Tagen"],["vor 1 Woche","in 1 Woche"],["vor %s Wochen","in %s Wochen"],["vor 1 Monat","in 1 Monat"],["vor %s Monaten","in %s Monaten"],["vor 1 Jahr","in 1 Jahr"],["vor %s Jahren","in %s Jahren"]][t]}var fw=rc.default=dw,oc={};Object.defineProperty(oc,"__esModule",{value:!0});function pw(i,t){return[["\u03BC\u03CC\u03BB\u03B9\u03C2 \u03C4\u03CE\u03C1\u03B1","\u03C3\u03B5 \u03BB\u03AF\u03B3\u03BF"],["%s \u03B4\u03B5\u03C5\u03C4\u03B5\u03C1\u03CC\u03BB\u03B5\u03C0\u03C4\u03B1 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03B4\u03B5\u03C5\u03C4\u03B5\u03C1\u03CC\u03BB\u03B5\u03C0\u03C4\u03B1"],["1 \u03BB\u03B5\u03C0\u03C4\u03CC \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 1 \u03BB\u03B5\u03C0\u03C4\u03CC"],["%s \u03BB\u03B5\u03C0\u03C4\u03AC \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03BB\u03B5\u03C0\u03C4\u03AC"],["1 \u03CE\u03C1\u03B1 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 1 \u03CE\u03C1\u03B1"],["%s \u03CE\u03C1\u03B5\u03C2 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03CE\u03C1\u03B5\u03C2"],["1 \u03BC\u03AD\u03C1\u03B1 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 1 \u03BC\u03AD\u03C1\u03B1"],["%s \u03BC\u03AD\u03C1\u03B5\u03C2 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03BC\u03AD\u03C1\u03B5\u03C2"],["1 \u03B5\u03B2\u03B4\u03BF\u03BC\u03AC\u03B4\u03B1 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 1 \u03B5\u03B2\u03B4\u03BF\u03BC\u03AC\u03B4\u03B1"],["%s \u03B5\u03B2\u03B4\u03BF\u03BC\u03AC\u03B4\u03B5\u03C2 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03B5\u03B2\u03B4\u03BF\u03BC\u03AC\u03B4\u03B5\u03C2"],["1 \u03BC\u03AE\u03BD\u03B1 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 1 \u03BC\u03AE\u03BD\u03B1"],["%s \u03BC\u03AE\u03BD\u03B5\u03C2 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03BC\u03AE\u03BD\u03B5\u03C2"],["1 \u03C7\u03C1\u03CC\u03BD\u03BF \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 1 \u03C7\u03C1\u03CC\u03BD\u03BF"],["%s \u03C7\u03C1\u03CC\u03BD\u03B9\u03B1 \u03C0\u03C1\u03B9\u03BD","\u03C3\u03B5 %s \u03C7\u03C1\u03CC\u03BD\u03B9\u03B1"]][t]}var gw=oc.default=pw,sc={};Object.defineProperty(sc,"__esModule",{value:!0});function mw(i,t){return[["justo ahora","en un rato"],["hace %s segundos","en %s segundos"],["hace 1 minuto","en 1 minuto"],["hace %s minutos","en %s minutos"],["hace 1 hora","en 1 hora"],["hace %s horas","en %s horas"],["hace 1 d\xEDa","en 1 d\xEDa"],["hace %s d\xEDas","en %s d\xEDas"],["hace 1 semana","en 1 semana"],["hace %s semanas","en %s semanas"],["hace 1 mes","en 1 mes"],["hace %s meses","en %s meses"],["hace 1 a\xF1o","en 1 a\xF1o"],["hace %s a\xF1os","en %s a\xF1os"]][t]}var vw=sc.default=mw,ac={};Object.defineProperty(ac,"__esModule",{value:!0});function yw(i,t){return[["juuri \xE4sken","juuri nyt"],["%s sekuntia sitten","%s sekunnin p\xE4\xE4st\xE4"],["minuutti sitten","minuutin p\xE4\xE4st\xE4"],["%s minuuttia sitten","%s minuutin p\xE4\xE4st\xE4"],["tunti sitten","tunnin p\xE4\xE4st\xE4"],["%s tuntia sitten","%s tunnin p\xE4\xE4st\xE4"],["p\xE4iv\xE4 sitten","p\xE4iv\xE4n p\xE4\xE4st\xE4"],["%s p\xE4iv\xE4\xE4 sitten","%s p\xE4iv\xE4n p\xE4\xE4st\xE4"],["viikko sitten","viikon p\xE4\xE4st\xE4"],["%s viikkoa sitten","%s viikon p\xE4\xE4st\xE4"],["kuukausi sitten","kuukauden p\xE4\xE4st\xE4"],["%s kuukautta sitten","%s kuukauden p\xE4\xE4st\xE4"],["vuosi sitten","vuoden p\xE4\xE4st\xE4"],["%s vuotta sitten","%s vuoden p\xE4\xE4st\xE4"]][t]}var ww=ac.default=yw,lc={};Object.defineProperty(lc,"__esModule",{value:!0});function bw(i,t){return[["\xE0 l'instant","dans un instant"],["il y a %s secondes","dans %s secondes"],["il y a 1 minute","dans 1 minute"],["il y a %s minutes","dans %s minutes"],["il y a 1 heure","dans 1 heure"],["il y a %s heures","dans %s heures"],["il y a 1 jour","dans 1 jour"],["il y a %s jours","dans %s jours"],["il y a 1 semaine","dans 1 semaine"],["il y a %s semaines","dans %s semaines"],["il y a 1 mois","dans 1 mois"],["il y a %s mois","dans %s mois"],["il y a 1 an","dans 1 an"],["il y a %s ans","dans %s ans"]][t]}var Sw=lc.default=bw,uc={};Object.defineProperty(uc,"__esModule",{value:!0});function Ew(i,t){return[["xusto agora","daqu\xED a un pouco"],["hai %s segundos","en %s segundos"],["hai 1 minuto","nun minuto"],["hai %s minutos","en %s minutos"],["hai 1 hora","nunha hora"],["hai %s horas","en %s horas"],["hai 1 d\xEDa","nun d\xEDa"],["hai %s d\xEDas","en %s d\xEDas"],["hai 1 semana","nunha semana"],["hai %s semanas","en %s semanas"],["hai 1 mes","nun mes"],["hai %s meses","en %s meses"],["hai 1 ano","nun ano"],["hai %s anos","en %s anos"]][t]}var _w=uc.default=Ew,cc={};Object.defineProperty(cc,"__esModule",{value:!0});function xw(i,t){return[["\u0905\u092D\u0940","\u0915\u0941\u091B \u0938\u092E\u092F"],["%s \u0938\u0947\u0915\u0902\u0921 \u092A\u0939\u0932\u0947","%s \u0938\u0947\u0915\u0902\u0921 \u092E\u0947\u0902"],["1 \u092E\u093F\u0928\u091F \u092A\u0939\u0932\u0947","1 \u092E\u093F\u0928\u091F \u092E\u0947\u0902"],["%s \u092E\u093F\u0928\u091F \u092A\u0939\u0932\u0947","%s \u092E\u093F\u0928\u091F \u092E\u0947\u0902"],["1 \u0918\u0902\u091F\u0947 \u092A\u0939\u0932\u0947","1 \u0918\u0902\u091F\u0947 \u092E\u0947\u0902"],["%s \u0918\u0902\u091F\u0947 \u092A\u0939\u0932\u0947","%s \u0918\u0902\u091F\u0947 \u092E\u0947\u0902"],["1 \u0926\u093F\u0928 \u092A\u0939\u0932\u0947","1 \u0926\u093F\u0928 \u092E\u0947\u0902"],["%s \u0926\u093F\u0928 \u092A\u0939\u0932\u0947","%s \u0926\u093F\u0928\u094B\u0902 \u092E\u0947\u0902"],["1 \u0938\u092A\u094D\u0924\u093E\u0939 \u092A\u0939\u0932\u0947","1 \u0938\u092A\u094D\u0924\u093E\u0939 \u092E\u0947\u0902"],["%s \u0939\u092B\u094D\u0924\u0947 \u092A\u0939\u0932\u0947","%s \u0939\u092B\u094D\u0924\u094B\u0902 \u092E\u0947\u0902"],["1 \u092E\u0939\u0940\u0928\u0947 \u092A\u0939\u0932\u0947","1 \u092E\u0939\u0940\u0928\u0947 \u092E\u0947\u0902"],["%s \u092E\u0939\u0940\u0928\u0947 \u092A\u0939\u0932\u0947","%s \u092E\u0939\u0940\u0928\u094B\u0902 \u092E\u0947\u0902"],["1 \u0938\u093E\u0932 \u092A\u0939\u0932\u0947","1 \u0938\u093E\u0932 \u092E\u0947\u0902"],["%s \u0938\u093E\u0932 \u092A\u0939\u0932\u0947","%s \u0938\u093E\u0932 \u092E\u0947\u0902"]][t]}var Tw=cc.default=xw,hc={};Object.defineProperty(hc,"__esModule",{value:!0});function Cw(i,t){return[["poco fa","fra poco"],["%s secondi fa","fra %s secondi"],["un minuto fa","fra un minuto"],["%s minuti fa","fra %s minuti"],["un'ora fa","fra un'ora"],["%s ore fa","fra %s ore"],["un giorno fa","fra un giorno"],["%s giorni fa","fra %s giorni"],["una settimana fa","fra una settimana"],["%s settimane fa","fra %s settimane"],["un mese fa","fra un mese"],["%s mesi fa","fra %s mesi"],["un anno fa","fra un anno"],["%s anni fa","fra %s anni"]][t]}var Pw=hc.default=Cw,dc={};Object.defineProperty(dc,"__esModule",{value:!0});function Aw(i,t){return[["\u3059\u3053\u3057\u524D","\u3059\u3050\u306B"],["%s\u79D2\u524D","%s\u79D2\u4EE5\u5185"],["1\u5206\u524D","1\u5206\u4EE5\u5185"],["%s\u5206\u524D","%s\u5206\u4EE5\u5185"],["1\u6642\u9593\u524D","1\u6642\u9593\u4EE5\u5185"],["%s\u6642\u9593\u524D","%s\u6642\u9593\u4EE5\u5185"],["1\u65E5\u524D","1\u65E5\u4EE5\u5185"],["%s\u65E5\u524D","%s\u65E5\u4EE5\u5185"],["1\u9031\u9593\u524D","1\u9031\u9593\u4EE5\u5185"],["%s\u9031\u9593\u524D","%s\u9031\u9593\u4EE5\u5185"],["1\u30F6\u6708\u524D","1\u30F6\u6708\u4EE5\u5185"],["%s\u30F6\u6708\u524D","%s\u30F6\u6708\u4EE5\u5185"],["1\u5E74\u524D","1\u5E74\u4EE5\u5185"],["%s\u5E74\u524D","%s\u5E74\u4EE5\u5185"]][t]}var Ow=dc.default=Aw,fc={};Object.defineProperty(fc,"__esModule",{value:!0});function Rw(i,t){return[["\uBC29\uAE08","\uACE7"],["%s\uCD08 \uC804","%s\uCD08 \uD6C4"],["1\uBD84 \uC804","1\uBD84 \uD6C4"],["%s\uBD84 \uC804","%s\uBD84 \uD6C4"],["1\uC2DC\uAC04 \uC804","1\uC2DC\uAC04 \uD6C4"],["%s\uC2DC\uAC04 \uC804","%s\uC2DC\uAC04 \uD6C4"],["1\uC77C \uC804","1\uC77C \uD6C4"],["%s\uC77C \uC804","%s\uC77C \uD6C4"],["1\uC8FC\uC77C \uC804","1\uC8FC\uC77C \uD6C4"],["%s\uC8FC\uC77C \uC804","%s\uC8FC\uC77C \uD6C4"],["1\uAC1C\uC6D4 \uC804","1\uAC1C\uC6D4 \uD6C4"],["%s\uAC1C\uC6D4 \uC804","%s\uAC1C\uC6D4 \uD6C4"],["1\uB144 \uC804","1\uB144 \uD6C4"],["%s\uB144 \uC804","%s\uB144 \uD6C4"]][t]}var Dw=fc.default=Rw,pc={};Object.defineProperty(pc,"__esModule",{value:!0});function Mw(i,t){return[["recent","binnenkort"],["%s seconden geleden","binnen %s seconden"],["1 minuut geleden","binnen 1 minuut"],["%s minuten geleden","binnen %s minuten"],["1 uur geleden","binnen 1 uur"],["%s uur geleden","binnen %s uur"],["1 dag geleden","binnen 1 dag"],["%s dagen geleden","binnen %s dagen"],["1 week geleden","binnen 1 week"],["%s weken geleden","binnen %s weken"],["1 maand geleden","binnen 1 maand"],["%s maanden geleden","binnen %s maanden"],["1 jaar geleden","binnen 1 jaar"],["%s jaar geleden","binnen %s jaar"]][t]}var Iw=pc.default=Mw,gc={};Object.defineProperty(gc,"__esModule",{value:!0});function Fw(i,t){return[["agora mesmo","agora"],["h\xE1 %s segundos","em %s segundos"],["h\xE1 um minuto","em um minuto"],["h\xE1 %s minutos","em %s minutos"],["h\xE1 uma hora","em uma hora"],["h\xE1 %s horas","em %s horas"],["h\xE1 um dia","em um dia"],["h\xE1 %s dias","em %s dias"],["h\xE1 uma semana","em uma semana"],["h\xE1 %s semanas","em %s semanas"],["h\xE1 um m\xEAs","em um m\xEAs"],["h\xE1 %s meses","em %s meses"],["h\xE1 um ano","em um ano"],["h\xE1 %s anos","em %s anos"]][t]}var kw=gc.default=Fw,mc={};Object.defineProperty(mc,"__esModule",{value:!0});function Gt(i,t,e,n,r){var o=r%10,l=n;return r===1?l=i:o===1&&r>20?l=t:o>1&&o<5&&(r>20||r<10)&&(l=e),l}var vc=Gt.bind(null,"\u0441\u0435\u043A\u0443\u043D\u0434\u0443","%s \u0441\u0435\u043A\u0443\u043D\u0434\u0443","%s \u0441\u0435\u043A\u0443\u043D\u0434\u044B","%s \u0441\u0435\u043A\u0443\u043D\u0434"),yc=Gt.bind(null,"\u043C\u0438\u043D\u0443\u0442\u0443","%s \u043C\u0438\u043D\u0443\u0442\u0443","%s \u043C\u0438\u043D\u0443\u0442\u044B","%s \u043C\u0438\u043D\u0443\u0442"),wc=Gt.bind(null,"\u0447\u0430\u0441","%s \u0447\u0430\u0441","%s \u0447\u0430\u0441\u0430","%s \u0447\u0430\u0441\u043E\u0432"),bc=Gt.bind(null,"\u0434\u0435\u043D\u044C","%s \u0434\u0435\u043D\u044C","%s \u0434\u043D\u044F","%s \u0434\u043D\u0435\u0439"),Sc=Gt.bind(null,"\u043D\u0435\u0434\u0435\u043B\u044E","%s \u043D\u0435\u0434\u0435\u043B\u044E","%s \u043D\u0435\u0434\u0435\u043B\u0438","%s \u043D\u0435\u0434\u0435\u043B\u044C"),Ec=Gt.bind(null,"\u043C\u0435\u0441\u044F\u0446","%s \u043C\u0435\u0441\u044F\u0446","%s \u043C\u0435\u0441\u044F\u0446\u0430","%s \u043C\u0435\u0441\u044F\u0446\u0435\u0432"),_c=Gt.bind(null,"\u0433\u043E\u0434","%s \u0433\u043E\u0434","%s \u0433\u043E\u0434\u0430","%s \u043B\u0435\u0442");function Lw(i,t){switch(t){case 0:return["\u0442\u043E\u043B\u044C\u043A\u043E \u0447\u0442\u043E","\u0447\u0435\u0440\u0435\u0437 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0441\u0435\u043A\u0443\u043D\u0434"];case 1:return[vc(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+vc(i)];case 2:case 3:return[yc(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+yc(i)];case 4:case 5:return[wc(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+wc(i)];case 6:return["\u0432\u0447\u0435\u0440\u0430","\u0437\u0430\u0432\u0442\u0440\u0430"];case 7:return[bc(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+bc(i)];case 8:case 9:return[Sc(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+Sc(i)];case 10:case 11:return[Ec(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+Ec(i)];case 12:case 13:return[_c(i)+" \u043D\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+_c(i)];default:return["",""]}}var Bw=mc.default=Lw,xc={};Object.defineProperty(xc,"__esModule",{value:!0});function Nw(i,t){return[["just nu","om en stund"],["%s sekunder sedan","om %s sekunder"],["1 minut sedan","om 1 minut"],["%s minuter sedan","om %s minuter"],["1 timme sedan","om 1 timme"],["%s timmar sedan","om %s timmar"],["1 dag sedan","om 1 dag"],["%s dagar sedan","om %s dagar"],["1 vecka sedan","om 1 vecka"],["%s veckor sedan","om %s veckor"],["1 m\xE5nad sedan","om 1 m\xE5nad"],["%s m\xE5nader sedan","om %s m\xE5nader"],["1 \xE5r sedan","om 1 \xE5r"],["%s \xE5r sedan","om %s \xE5r"]][t]}var Hw=xc.default=Nw,Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});function zw(i,t){return[["\u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2A\u0E31\u0E01\u0E04\u0E23\u0E39\u0E48\u0E19\u0E35\u0E49","\u0E2D\u0E35\u0E01\u0E2A\u0E31\u0E01\u0E04\u0E23\u0E39\u0E48"],["%s \u0E27\u0E34\u0E19\u0E32\u0E17\u0E35\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E27\u0E34\u0E19\u0E32\u0E17\u0E35"],["1 \u0E19\u0E32\u0E17\u0E35\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 1 \u0E19\u0E32\u0E17\u0E35"],["%s \u0E19\u0E32\u0E17\u0E35\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E19\u0E32\u0E17\u0E35"],["1 \u0E0A\u0E31\u0E48\u0E27\u0E42\u0E21\u0E07\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 1 \u0E0A\u0E31\u0E48\u0E27\u0E42\u0E21\u0E07"],["%s \u0E0A\u0E31\u0E48\u0E27\u0E42\u0E21\u0E07\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E0A\u0E31\u0E48\u0E27\u0E42\u0E21\u0E07"],["1 \u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 1 \u0E27\u0E31\u0E19"],["%s \u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E27\u0E31\u0E19"],["1 \u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 1 \u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C"],["%s \u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C"],["1 \u0E40\u0E14\u0E37\u0E2D\u0E19\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 1 \u0E40\u0E14\u0E37\u0E2D\u0E19"],["%s \u0E40\u0E14\u0E37\u0E2D\u0E19\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E40\u0E14\u0E37\u0E2D\u0E19"],["1 \u0E1B\u0E35\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 1 \u0E1B\u0E35"],["%s \u0E1B\u0E35\u0E17\u0E35\u0E48\u0E41\u0E25\u0E49\u0E27","\u0E43\u0E19 %s \u0E1B\u0E35"]][t]}var Vw=Tc.default=zw,Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});function Uw(i,t){return[["az \xF6nce","\u015Fimdi"],["%s saniye \xF6nce","%s saniye i\xE7inde"],["1 dakika \xF6nce","1 dakika i\xE7inde"],["%s dakika \xF6nce","%s dakika i\xE7inde"],["1 saat \xF6nce","1 saat i\xE7inde"],["%s saat \xF6nce","%s saat i\xE7inde"],["1 g\xFCn \xF6nce","1 g\xFCn i\xE7inde"],["%s g\xFCn \xF6nce","%s g\xFCn i\xE7inde"],["1 hafta \xF6nce","1 hafta i\xE7inde"],["%s hafta \xF6nce","%s hafta i\xE7inde"],["1 ay \xF6nce","1 ay i\xE7inde"],["%s ay \xF6nce","%s ay i\xE7inde"],["1 y\u0131l \xF6nce","1 y\u0131l i\xE7inde"],["%s y\u0131l \xF6nce","%s y\u0131l i\xE7inde"]][t]}var Ww=Cc.default=Uw,Pc={};Object.defineProperty(Pc,"__esModule",{value:!0});var jw=["\u79D2","\u5206\u949F","\u5C0F\u65F6","\u5929","\u5468","\u4E2A\u6708","\u5E74"];function Gw(i,t){if(t===0)return["\u521A\u521A","\u7247\u523B\u540E"];var e=jw[~~(t/2)];return[i+" "+e+"\u524D",i+" "+e+"\u540E"]}var qw=Pc.default=Gw,Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});function Xw(i,t){return[["\u525B\u525B","\u7247\u523B\u5F8C"],["%s \u79D2\u524D","%s \u79D2\u5F8C"],["1 \u5206\u9418\u524D","1 \u5206\u9418\u5F8C"],["%s \u5206\u9418\u524D","%s \u5206\u9418\u5F8C"],["1 \u5C0F\u6642\u524D","1 \u5C0F\u6642\u5F8C"],["%s \u5C0F\u6642\u524D","%s \u5C0F\u6642\u5F8C"],["1 \u5929\u524D","1 \u5929\u5F8C"],["%s \u5929\u524D","%s \u5929\u5F8C"],["1 \u9031\u524D","1 \u9031\u5F8C"],["%s \u9031\u524D","%s \u9031\u5F8C"],["1 \u500B\u6708\u524D","1 \u500B\u6708\u5F8C"],["%s \u500B\u6708\u524D","%s \u500B\u6708\u5F8C"],["1 \u5E74\u524D","1 \u5E74\u5F8C"],["%s \u5E74\u524D","%s \u5E74\u5F8C"]][t]}var Zw=Ac.default=Xw;const pn={ar:z0,cs:V0,de:U0,el:W0,es:j0,fi:G0,fr:q0,gl:X0,hi:Z0,it:Y0,ja:K0,ko:J0,nl:Q0,pt:$0,ru:ew,sv:tw,th:nw,tr:iw,ur:rw,"zh-CN":ow,"zh-TW":sw},Yw=Object.keys(pn),qt=new H0({allowMissing:!0});qt.init=(i,t)=>{qt.clear(),i&&(qt.locale(i),qt.extend(pn[i])),t&&qt.extend(t)},Se("ar",uw),Se("cs",hw),Se("de",fw),Se("el",gw),Se("es",vw),Se("fi",ww),Se("fr",Sw),Se("gl",_w),Se("hi",Tw),Se("it",Pw),Se("ja",Ow),Se("ko",Dw),Se("nl",Iw),Se("pt",kw),Se("ru",Bw),Se("sv",Hw),Se("th",Vw),Se("tr",Ww),Se("zh-CN",qw),Se("zh-TW",Zw),qt.registerMessages=(i,t)=>{pn[i]?pn[i]={...pn[i],...t}:pn[i]=t};var We=qt,Kw=i=>{const t=ut();return Ap(t,()=>i.onClickOutside()),A.createElement("ul",{ref:t,className:"r6o-comment-dropdown-menu"},A.createElement("li",{onClick:i.onEdit},We.t("Edit")),A.createElement("li",{onClick:i.onDelete},We.t("Delete")))},Oc={},Uo={},Wo={exports:{}};/*!
	autosize 4.0.4
	license: MIT
	http://www.jacklmoore.com/autosize
*/(function(i,t){(function(e,n){n(i,t)})(Ot,function(e,n){var r=typeof Map=="function"?new Map:function(){var c=[],h=[];return{has:function(p){return c.indexOf(p)>-1},get:function(p){return h[c.indexOf(p)]},set:function(p,m){c.indexOf(p)===-1&&(c.push(p),h.push(m))},delete:function(p){var m=c.indexOf(p);m>-1&&(c.splice(m,1),h.splice(m,1))}}}(),o=function(h){return new Event(h,{bubbles:!0})};try{new Event("test")}catch{o=function(d){var p=document.createEvent("Event");return p.initEvent(d,!0,!1),p}}function l(c){if(!c||!c.nodeName||c.nodeName!=="TEXTAREA"||r.has(c))return;var h=null,d=null,p=null;function m(){var M=window.getComputedStyle(c,null);M.resize==="vertical"?c.style.resize="none":M.resize==="both"&&(c.style.resize="horizontal"),M.boxSizing==="content-box"?h=-(parseFloat(M.paddingTop)+parseFloat(M.paddingBottom)):h=parseFloat(M.borderTopWidth)+parseFloat(M.borderBottomWidth),isNaN(h)&&(h=0),T()}function w(M){{var N=c.style.width;c.style.width="0px",c.offsetWidth,c.style.width=N}c.style.overflowY=M}function y(M){for(var N=[];M&&M.parentNode&&M.parentNode instanceof Element;)M.parentNode.scrollTop&&N.push({node:M.parentNode,scrollTop:M.parentNode.scrollTop}),M=M.parentNode;return N}function E(){if(c.scrollHeight!==0){var M=y(c),N=document.documentElement&&document.documentElement.scrollTop;c.style.height="",c.style.height=c.scrollHeight+h+"px",d=c.clientWidth,M.forEach(function(I){I.node.scrollTop=I.scrollTop}),N&&(document.documentElement.scrollTop=N)}}function T(){E();var M=Math.round(parseFloat(c.style.height)),N=window.getComputedStyle(c,null),I=N.boxSizing==="content-box"?Math.round(parseFloat(N.height)):c.offsetHeight;if(I<M?N.overflowY==="hidden"&&(w("scroll"),E(),I=N.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(c,null).height)):c.offsetHeight):N.overflowY!=="hidden"&&(w("hidden"),E(),I=N.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(c,null).height)):c.offsetHeight),p!==I){p=I;var G=o("autosize:resized");try{c.dispatchEvent(G)}catch{}}}var C=function(){c.clientWidth!==d&&T()},B=function(M){window.removeEventListener("resize",C,!1),c.removeEventListener("input",T,!1),c.removeEventListener("keyup",T,!1),c.removeEventListener("autosize:destroy",B,!1),c.removeEventListener("autosize:update",T,!1),Object.keys(M).forEach(function(N){c.style[N]=M[N]}),r.delete(c)}.bind(c,{height:c.style.height,resize:c.style.resize,overflowY:c.style.overflowY,overflowX:c.style.overflowX,wordWrap:c.style.wordWrap});c.addEventListener("autosize:destroy",B,!1),"onpropertychange"in c&&"oninput"in c&&c.addEventListener("keyup",T,!1),window.addEventListener("resize",C,!1),c.addEventListener("input",T,!1),c.addEventListener("autosize:update",T,!1),c.style.overflowX="hidden",c.style.wordWrap="break-word",r.set(c,{destroy:B,update:T}),m()}function s(c){var h=r.get(c);h&&h.destroy()}function a(c){var h=r.get(c);h&&h.update()}var u=null;typeof window=="undefined"||typeof window.getComputedStyle!="function"?(u=function(h){return h},u.destroy=function(c){return c},u.update=function(c){return c}):(u=function(h,d){return h&&Array.prototype.forEach.call(h.length?h:[h],function(p){return l(p)}),h},u.destroy=function(c){return c&&Array.prototype.forEach.call(c.length?c:[c],s),c},u.update=function(c){return c&&Array.prototype.forEach.call(c.length?c:[c],a),c}),n.default=u,e.exports=n.default})})(Wo,Wo.exports);var Jw=function(i,t,e){return e=window.getComputedStyle,(e?e(i):i.currentStyle)[t.replace(/-(\w)/gi,function(n,r){return r.toUpperCase()})]},Qw=Jw,jo=Qw;function $w(i){var t=jo(i,"line-height"),e=parseFloat(t,10);if(t===e+""){var n=i.style.lineHeight;i.style.lineHeight=t+"em",t=jo(i,"line-height"),e=parseFloat(t,10),n?i.style.lineHeight=n:delete i.style.lineHeight}if(t.indexOf("pt")!==-1?(e*=4,e/=3):t.indexOf("mm")!==-1?(e*=96,e/=25.4):t.indexOf("cm")!==-1?(e*=96,e/=2.54):t.indexOf("in")!==-1?e*=96:t.indexOf("pc")!==-1&&(e*=16),e=Math.round(e),t==="normal"){var r=i.nodeName,o=document.createElement(r);o.innerHTML="&nbsp;",r.toUpperCase()==="TEXTAREA"&&o.setAttribute("rows","1");var l=jo(i,"font-size");o.style.fontSize=l,o.style.padding="0px",o.style.border="0px";var s=document.body;s.appendChild(o);var a=o.offsetHeight;e=a,s.removeChild(o)}return e}var eb=$w,tb=Ot&&Ot.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Go=Ot&&Ot.__assign||Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},nb=Ot&&Ot.__rest||function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)t.indexOf(n[r])<0&&(e[n[r]]=i[n[r]]);return e};Uo.__esModule=!0;var ki=$t,Gn=Ln.exports,Li=Wo.exports,ib=eb,rb=ib,Rc="autosize:resized",ob=function(i){tb(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.state={lineHeight:null},e.textarea=null,e.onResize=function(n){e.props.onResize&&e.props.onResize(n)},e.updateLineHeight=function(){e.textarea&&e.setState({lineHeight:rb(e.textarea)})},e.onChange=function(n){var r=e.props.onChange;e.currentValue=n.currentTarget.value,r&&r(n)},e}return t.prototype.componentDidMount=function(){var e=this,n=this.props,r=n.maxRows,o=n.async;typeof r=="number"&&this.updateLineHeight(),typeof r=="number"||o?setTimeout(function(){return e.textarea&&Li(e.textarea)}):this.textarea&&Li(this.textarea),this.textarea&&this.textarea.addEventListener(Rc,this.onResize)},t.prototype.componentWillUnmount=function(){this.textarea&&(this.textarea.removeEventListener(Rc,this.onResize),Li.destroy(this.textarea))},t.prototype.render=function(){var e=this,n=this,r=n.props;r.onResize;var o=r.maxRows;r.onChange;var l=r.style;r.innerRef;var s=r.children,a=nb(r,["onResize","maxRows","onChange","style","innerRef","children"]),u=n.state.lineHeight,c=o&&u?u*o:null;return ki.createElement("textarea",Go({},a,{onChange:this.onChange,style:c?Go({},l,{maxHeight:c}):l,ref:function(h){e.textarea=h,typeof e.props.innerRef=="function"?e.props.innerRef(h):e.props.innerRef&&(e.props.innerRef.current=h)}}),s)},t.prototype.componentDidUpdate=function(){this.textarea&&Li.update(this.textarea)},t.defaultProps={rows:1,async:!1},t.propTypes={rows:Gn.number,maxRows:Gn.number,onResize:Gn.func,innerRef:Gn.any,async:Gn.bool},t}(ki.Component);Uo.TextareaAutosize=ki.forwardRef(function(i,t){return ki.createElement(ob,Go({},i,{innerRef:t}))}),function(i){i.__esModule=!0;var t=Uo;i.default=t.TextareaAutosize}(Oc);var sb=mf(Oc);class Dc extends Te{constructor(e){super(e);x(this,"onKeyDown",e=>{e.which===13&&e.ctrlKey&&this.props.onSaveAndClose()});x(this,"onKeyUp",e=>{e.which===46&&e.stopPropagation()});this.element=Tr()}componentDidMount(){this.props.focus&&this.element.current&&this.element.current.focus({preventScroll:!0})}render(){return A.createElement(sb,{ref:this.element,className:"r6o-editable-text",value:this.props.content,placeholder:this.props.placeholder||We.t("Add a comment..."),disabled:!this.props.editable,onChange:this.props.onChange,onKeyUp:this.onKeyUp,onKeyDown:this.onKeyDown})}}function K(){return K=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},K.apply(this,arguments)}function ab(i){if(i.sheet)return i.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===i)return document.styleSheets[t]}function lb(i){var t=document.createElement("style");return t.setAttribute("data-emotion",i.key),i.nonce!==void 0&&t.setAttribute("nonce",i.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var ub=function(){function i(e){var n=this;this._insertTag=function(r){var o;n.tags.length===0?n.insertionPoint?o=n.insertionPoint.nextSibling:n.prepend?o=n.container.firstChild:o=n.before:o=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(r,o),n.tags.push(r)},this.isSpeedy=e.speedy===void 0?!0:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=i.prototype;return t.hydrate=function(n){n.forEach(this._insertTag)},t.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(lb(this));var r=this.tags[this.tags.length-1];if(this.isSpeedy){var o=ab(r);try{o.insertRule(n,o.cssRules.length)}catch{}}else r.appendChild(document.createTextNode(n));this.ctr++},t.flush=function(){this.tags.forEach(function(n){return n.parentNode&&n.parentNode.removeChild(n)}),this.tags=[],this.ctr=0},i}(),Ve="-ms-",Bi="-moz-",le="-webkit-",Mc="comm",qo="rule",Xo="decl",cb="@import",Ic="@keyframes",hb="@layer",db=Math.abs,Ni=String.fromCharCode,fb=Object.assign;function pb(i,t){return ke(i,0)^45?(((t<<2^ke(i,0))<<2^ke(i,1))<<2^ke(i,2))<<2^ke(i,3):0}function Fc(i){return i.trim()}function gb(i,t){return(i=t.exec(i))?i[0]:i}function ue(i,t,e){return i.replace(t,e)}function Zo(i,t){return i.indexOf(t)}function ke(i,t){return i.charCodeAt(t)|0}function qn(i,t,e){return i.slice(t,e)}function pt(i){return i.length}function Yo(i){return i.length}function Hi(i,t){return t.push(i),i}function mb(i,t){return i.map(t).join("")}var zi=1,gn=1,kc=0,je=0,xe=0,mn="";function Vi(i,t,e,n,r,o,l){return{value:i,root:t,parent:e,type:n,props:r,children:o,line:zi,column:gn,length:l,return:""}}function Xn(i,t){return fb(Vi("",null,null,"",null,null,0),i,{length:-i.length},t)}function vb(){return xe}function yb(){return xe=je>0?ke(mn,--je):0,gn--,xe===10&&(gn=1,zi--),xe}function Ke(){return xe=je<kc?ke(mn,je++):0,gn++,xe===10&&(gn=1,zi++),xe}function gt(){return ke(mn,je)}function Ui(){return je}function Zn(i,t){return qn(mn,i,t)}function Yn(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Lc(i){return zi=gn=1,kc=pt(mn=i),je=0,[]}function Bc(i){return mn="",i}function Wi(i){return Fc(Zn(je-1,Ko(i===91?i+2:i===40?i+1:i)))}function wb(i){for(;(xe=gt())&&xe<33;)Ke();return Yn(i)>2||Yn(xe)>3?"":" "}function bb(i,t){for(;--t&&Ke()&&!(xe<48||xe>102||xe>57&&xe<65||xe>70&&xe<97););return Zn(i,Ui()+(t<6&&gt()==32&&Ke()==32))}function Ko(i){for(;Ke();)switch(xe){case i:return je;case 34:case 39:i!==34&&i!==39&&Ko(xe);break;case 40:i===41&&Ko(i);break;case 92:Ke();break}return je}function Sb(i,t){for(;Ke()&&i+xe!==47+10;)if(i+xe===42+42&&gt()===47)break;return"/*"+Zn(t,je-1)+"*"+Ni(i===47?i:Ke())}function Eb(i){for(;!Yn(gt());)Ke();return Zn(i,je)}function _b(i){return Bc(ji("",null,null,null,[""],i=Lc(i),0,[0],i))}function ji(i,t,e,n,r,o,l,s,a){for(var u=0,c=0,h=l,d=0,p=0,m=0,w=1,y=1,E=1,T=0,C="",B=r,M=o,N=n,I=C;y;)switch(m=T,T=Ke()){case 40:if(m!=108&&ke(I,h-1)==58){Zo(I+=ue(Wi(T),"&","&\f"),"&\f")!=-1&&(E=-1);break}case 34:case 39:case 91:I+=Wi(T);break;case 9:case 10:case 13:case 32:I+=wb(m);break;case 92:I+=bb(Ui()-1,7);continue;case 47:switch(gt()){case 42:case 47:Hi(xb(Sb(Ke(),Ui()),t,e),a);break;default:I+="/"}break;case 123*w:s[u++]=pt(I)*E;case 125*w:case 59:case 0:switch(T){case 0:case 125:y=0;case 59+c:E==-1&&(I=ue(I,/\f/g,"")),p>0&&pt(I)-h&&Hi(p>32?Hc(I+";",n,e,h-1):Hc(ue(I," ","")+";",n,e,h-2),a);break;case 59:I+=";";default:if(Hi(N=Nc(I,t,e,u,c,r,s,C,B=[],M=[],h),o),T===123)if(c===0)ji(I,t,N,N,B,o,h,s,M);else switch(d===99&&ke(I,3)===110?100:d){case 100:case 108:case 109:case 115:ji(i,N,N,n&&Hi(Nc(i,N,N,0,0,r,s,C,r,B=[],h),M),r,M,h,s,n?B:M);break;default:ji(I,N,N,N,[""],M,0,s,M)}}u=c=p=0,w=E=1,C=I="",h=l;break;case 58:h=1+pt(I),p=m;default:if(w<1){if(T==123)--w;else if(T==125&&w++==0&&yb()==125)continue}switch(I+=Ni(T),T*w){case 38:E=c>0?1:(I+="\f",-1);break;case 44:s[u++]=(pt(I)-1)*E,E=1;break;case 64:gt()===45&&(I+=Wi(Ke())),d=gt(),c=h=pt(C=I+=Eb(Ui())),T++;break;case 45:m===45&&pt(I)==2&&(w=0)}}return o}function Nc(i,t,e,n,r,o,l,s,a,u,c){for(var h=r-1,d=r===0?o:[""],p=Yo(d),m=0,w=0,y=0;m<n;++m)for(var E=0,T=qn(i,h+1,h=db(w=l[m])),C=i;E<p;++E)(C=Fc(w>0?d[E]+" "+T:ue(T,/&\f/g,d[E])))&&(a[y++]=C);return Vi(i,t,e,r===0?qo:s,a,u,c)}function xb(i,t,e){return Vi(i,t,e,Mc,Ni(vb()),qn(i,2,-2),0)}function Hc(i,t,e,n){return Vi(i,t,e,Xo,qn(i,0,n),qn(i,n+1,-1),n)}function vn(i,t){for(var e="",n=Yo(i),r=0;r<n;r++)e+=t(i[r],r,i,t)||"";return e}function Tb(i,t,e,n){switch(i.type){case hb:if(i.children.length)break;case cb:case Xo:return i.return=i.return||i.value;case Mc:return"";case Ic:return i.return=i.value+"{"+vn(i.children,n)+"}";case qo:i.value=i.props.join(",")}return pt(e=vn(i.children,n))?i.return=i.value+"{"+e+"}":""}function Cb(i){var t=Yo(i);return function(e,n,r,o){for(var l="",s=0;s<t;s++)l+=i[s](e,n,r,o)||"";return l}}function Pb(i){return function(t){t.root||(t=t.return)&&i(t)}}function Ab(i){var t=Object.create(null);return function(e){return t[e]===void 0&&(t[e]=i(e)),t[e]}}var Ob=function(t,e,n){for(var r=0,o=0;r=o,o=gt(),r===38&&o===12&&(e[n]=1),!Yn(o);)Ke();return Zn(t,je)},Rb=function(t,e){var n=-1,r=44;do switch(Yn(r)){case 0:r===38&&gt()===12&&(e[n]=1),t[n]+=Ob(je-1,e,n);break;case 2:t[n]+=Wi(r);break;case 4:if(r===44){t[++n]=gt()===58?"&\f":"",e[n]=t[n].length;break}default:t[n]+=Ni(r)}while(r=Ke());return t},Db=function(t,e){return Bc(Rb(Lc(t),e))},zc=new WeakMap,Mb=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var e=t.value,n=t.parent,r=t.column===n.column&&t.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(t.props.length===1&&e.charCodeAt(0)!==58&&!zc.get(n))&&!r){zc.set(t,!0);for(var o=[],l=Db(e,o),s=n.props,a=0,u=0;a<l.length;a++)for(var c=0;c<s.length;c++,u++)t.props[u]=o[a]?l[a].replace(/&\f/g,s[c]):s[c]+" "+l[a]}}},Ib=function(t){if(t.type==="decl"){var e=t.value;e.charCodeAt(0)===108&&e.charCodeAt(2)===98&&(t.return="",t.value="")}};function Vc(i,t){switch(pb(i,t)){case 5103:return le+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return le+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return le+i+Bi+i+Ve+i+i;case 6828:case 4268:return le+i+Ve+i+i;case 6165:return le+i+Ve+"flex-"+i+i;case 5187:return le+i+ue(i,/(\w+).+(:[^]+)/,le+"box-$1$2"+Ve+"flex-$1$2")+i;case 5443:return le+i+Ve+"flex-item-"+ue(i,/flex-|-self/,"")+i;case 4675:return le+i+Ve+"flex-line-pack"+ue(i,/align-content|flex-|-self/,"")+i;case 5548:return le+i+Ve+ue(i,"shrink","negative")+i;case 5292:return le+i+Ve+ue(i,"basis","preferred-size")+i;case 6060:return le+"box-"+ue(i,"-grow","")+le+i+Ve+ue(i,"grow","positive")+i;case 4554:return le+ue(i,/([^-])(transform)/g,"$1"+le+"$2")+i;case 6187:return ue(ue(ue(i,/(zoom-|grab)/,le+"$1"),/(image-set)/,le+"$1"),i,"")+i;case 5495:case 3959:return ue(i,/(image-set\([^]*)/,le+"$1$`$1");case 4968:return ue(ue(i,/(.+:)(flex-)?(.*)/,le+"box-pack:$3"+Ve+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+le+i+i;case 4095:case 3583:case 4068:case 2532:return ue(i,/(.+)-inline(.+)/,le+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(pt(i)-1-t>6)switch(ke(i,t+1)){case 109:if(ke(i,t+4)!==45)break;case 102:return ue(i,/(.+:)(.+)-([^]+)/,"$1"+le+"$2-$3$1"+Bi+(ke(i,t+3)==108?"$3":"$2-$3"))+i;case 115:return~Zo(i,"stretch")?Vc(ue(i,"stretch","fill-available"),t)+i:i}break;case 4949:if(ke(i,t+1)!==115)break;case 6444:switch(ke(i,pt(i)-3-(~Zo(i,"!important")&&10))){case 107:return ue(i,":",":"+le)+i;case 101:return ue(i,/(.+:)([^;!]+)(;|!.+)?/,"$1"+le+(ke(i,14)===45?"inline-":"")+"box$3$1"+le+"$2$3$1"+Ve+"$2box$3")+i}break;case 5936:switch(ke(i,t+11)){case 114:return le+i+Ve+ue(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return le+i+Ve+ue(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return le+i+Ve+ue(i,/[svh]\w+-[tblr]{2}/,"lr")+i}return le+i+Ve+i+i}return i}var Fb=function(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case Xo:t.return=Vc(t.value,t.length);break;case Ic:return vn([Xn(t,{value:ue(t.value,"@","@"+le)})],r);case qo:if(t.length)return mb(t.props,function(o){switch(gb(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return vn([Xn(t,{props:[ue(o,/:(read-\w+)/,":"+Bi+"$1")]})],r);case"::placeholder":return vn([Xn(t,{props:[ue(o,/:(plac\w+)/,":"+le+"input-$1")]}),Xn(t,{props:[ue(o,/:(plac\w+)/,":"+Bi+"$1")]}),Xn(t,{props:[ue(o,/:(plac\w+)/,Ve+"input-$1")]})],r)}return""})}},kb=[Fb],Lb=function(t){var e=t.key;if(e==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(w){var y=w.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(w),w.setAttribute("data-s",""))})}var r=t.stylisPlugins||kb,o={},l,s=[];l=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),function(w){for(var y=w.getAttribute("data-emotion").split(" "),E=1;E<y.length;E++)o[y[E]]=!0;s.push(w)});var a,u=[Mb,Ib];{var c,h=[Tb,Pb(function(w){c.insert(w)})],d=Cb(u.concat(r,h)),p=function(y){return vn(_b(y),d)};a=function(y,E,T,C){c=T,p(y?y+"{"+E.styles+"}":E.styles),C&&(m.inserted[E.name]=!0)}}var m={key:e,sheet:new ub({key:e,container:l,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:a};return m.sheet.hydrate(s),m},Uc={exports:{}},de={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Re=typeof Symbol=="function"&&Symbol.for,Jo=Re?Symbol.for("react.element"):60103,Qo=Re?Symbol.for("react.portal"):60106,Gi=Re?Symbol.for("react.fragment"):60107,qi=Re?Symbol.for("react.strict_mode"):60108,Xi=Re?Symbol.for("react.profiler"):60114,Zi=Re?Symbol.for("react.provider"):60109,Yi=Re?Symbol.for("react.context"):60110,$o=Re?Symbol.for("react.async_mode"):60111,Ki=Re?Symbol.for("react.concurrent_mode"):60111,Ji=Re?Symbol.for("react.forward_ref"):60112,Qi=Re?Symbol.for("react.suspense"):60113,Bb=Re?Symbol.for("react.suspense_list"):60120,$i=Re?Symbol.for("react.memo"):60115,er=Re?Symbol.for("react.lazy"):60116,Nb=Re?Symbol.for("react.block"):60121,Hb=Re?Symbol.for("react.fundamental"):60117,zb=Re?Symbol.for("react.responder"):60118,Vb=Re?Symbol.for("react.scope"):60119;function Je(i){if(typeof i=="object"&&i!==null){var t=i.$$typeof;switch(t){case Jo:switch(i=i.type,i){case $o:case Ki:case Gi:case Xi:case qi:case Qi:return i;default:switch(i=i&&i.$$typeof,i){case Yi:case Ji:case er:case $i:case Zi:return i;default:return t}}case Qo:return t}}}function Wc(i){return Je(i)===Ki}de.AsyncMode=$o,de.ConcurrentMode=Ki,de.ContextConsumer=Yi,de.ContextProvider=Zi,de.Element=Jo,de.ForwardRef=Ji,de.Fragment=Gi,de.Lazy=er,de.Memo=$i,de.Portal=Qo,de.Profiler=Xi,de.StrictMode=qi,de.Suspense=Qi,de.isAsyncMode=function(i){return Wc(i)||Je(i)===$o},de.isConcurrentMode=Wc,de.isContextConsumer=function(i){return Je(i)===Yi},de.isContextProvider=function(i){return Je(i)===Zi},de.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===Jo},de.isForwardRef=function(i){return Je(i)===Ji},de.isFragment=function(i){return Je(i)===Gi},de.isLazy=function(i){return Je(i)===er},de.isMemo=function(i){return Je(i)===$i},de.isPortal=function(i){return Je(i)===Qo},de.isProfiler=function(i){return Je(i)===Xi},de.isStrictMode=function(i){return Je(i)===qi},de.isSuspense=function(i){return Je(i)===Qi},de.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===Gi||i===Ki||i===Xi||i===qi||i===Qi||i===Bb||typeof i=="object"&&i!==null&&(i.$$typeof===er||i.$$typeof===$i||i.$$typeof===Zi||i.$$typeof===Yi||i.$$typeof===Ji||i.$$typeof===Hb||i.$$typeof===zb||i.$$typeof===Vb||i.$$typeof===Nb)},de.typeOf=Je,Uc.exports=de;var jc=Uc.exports,Ub={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Wb={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Gc={};Gc[jc.ForwardRef]=Ub,Gc[jc.Memo]=Wb;var jb=!0;function qc(i,t,e){var n="";return e.split(" ").forEach(function(r){i[r]!==void 0?t.push(i[r]+";"):n+=r+" "}),n}var es=function(t,e,n){var r=t.key+"-"+e.name;(n===!1||jb===!1)&&t.registered[r]===void 0&&(t.registered[r]=e.styles)},Xc=function(t,e,n){es(t,e,n);var r=t.key+"-"+e.name;if(t.inserted[e.name]===void 0){var o=e;do t.insert(e===o?"."+r:"",o,t.sheet,!0),o=o.next;while(o!==void 0)}};function Gb(i){for(var t=0,e,n=0,r=i.length;r>=4;++n,r-=4)e=i.charCodeAt(n)&255|(i.charCodeAt(++n)&255)<<8|(i.charCodeAt(++n)&255)<<16|(i.charCodeAt(++n)&255)<<24,e=(e&65535)*1540483477+((e>>>16)*59797<<16),e^=e>>>24,t=(e&65535)*1540483477+((e>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(r){case 3:t^=(i.charCodeAt(n+2)&255)<<16;case 2:t^=(i.charCodeAt(n+1)&255)<<8;case 1:t^=i.charCodeAt(n)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var qb={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Xb=/[A-Z]|^ms/g,Zb=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Zc=function(t){return t.charCodeAt(1)===45},Yc=function(t){return t!=null&&typeof t!="boolean"},ts=Ab(function(i){return Zc(i)?i:i.replace(Xb,"-$&").toLowerCase()}),Kc=function(t,e){switch(t){case"animation":case"animationName":if(typeof e=="string")return e.replace(Zb,function(n,r,o){return mt={name:r,styles:o,next:mt},r})}return qb[t]!==1&&!Zc(t)&&typeof e=="number"&&e!==0?e+"px":e},G1="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Kn(i,t,e){if(e==null)return"";if(e.__emotion_styles!==void 0)return e;switch(typeof e){case"boolean":return"";case"object":{if(e.anim===1)return mt={name:e.name,styles:e.styles,next:mt},e.name;if(e.styles!==void 0){var n=e.next;if(n!==void 0)for(;n!==void 0;)mt={name:n.name,styles:n.styles,next:mt},n=n.next;var r=e.styles+";";return r}return Yb(i,t,e)}case"function":{if(i!==void 0){var o=mt,l=e(i);return mt=o,Kn(i,t,l)}break}}if(t==null)return e;var s=t[e];return s!==void 0?s:e}function Yb(i,t,e){var n="";if(Array.isArray(e))for(var r=0;r<e.length;r++)n+=Kn(i,t,e[r])+";";else for(var o in e){var l=e[o];if(typeof l!="object")t!=null&&t[l]!==void 0?n+=o+"{"+t[l]+"}":Yc(l)&&(n+=ts(o)+":"+Kc(o,l)+";");else if(Array.isArray(l)&&typeof l[0]=="string"&&(t==null||t[l[0]]===void 0))for(var s=0;s<l.length;s++)Yc(l[s])&&(n+=ts(o)+":"+Kc(o,l[s])+";");else{var a=Kn(i,t,l);switch(o){case"animation":case"animationName":{n+=ts(o)+":"+a+";";break}default:n+=o+"{"+a+"}"}}}return n}var Jc=/label:\s*([^\s;\n{]+)\s*(;|$)/g,mt,ns=function(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,o="";mt=void 0;var l=t[0];l==null||l.raw===void 0?(r=!1,o+=Kn(n,e,l)):o+=l[0];for(var s=1;s<t.length;s++)o+=Kn(n,e,t[s]),r&&(o+=l[s]);Jc.lastIndex=0;for(var a="",u;(u=Jc.exec(o))!==null;)a+="-"+u[1];var c=Gb(o)+a;return{name:c,styles:o,next:mt}},Kb=function(t){return t()},Jb=zr["useInsertionEffect"]?zr["useInsertionEffect"]:!1,Qc=Jb||Kb,is={}.hasOwnProperty,$c=Rn(typeof HTMLElement!="undefined"?Lb({key:"css"}):null);$c.Provider;var eh=function(t){return Lr(function(e,n){var r=Mn($c);return t(e,r,n)})},th=Rn({}),rs="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Qb=function(t,e){var n={};for(var r in e)is.call(e,r)&&(n[r]=e[r]);return n[rs]=t,n},$b=function(t){var e=t.cache,n=t.serialized,r=t.isStringTag;return es(e,n,r),Qc(function(){return Xc(e,n,r)}),null},eS=eh(function(i,t,e){var n=i.css;typeof n=="string"&&t.registered[n]!==void 0&&(n=t.registered[n]);var r=i[rs],o=[n],l="";typeof i.className=="string"?l=qc(t.registered,o,i.className):i.className!=null&&(l=i.className+" ");var s=ns(o,void 0,Mn(th));l+=t.key+"-"+s.name;var a={};for(var u in i)is.call(i,u)&&u!=="css"&&u!==rs&&(a[u]=i[u]);return a.ref=e,a.className=l,Pe(nt,null,Pe($b,{cache:t,serialized:s,isStringTag:typeof r=="string"}),Pe(r,a))}),tS=eS,J=function(t,e){var n=arguments;if(e==null||!is.call(e,"css"))return Pe.apply(void 0,n);var r=n.length,o=new Array(r);o[0]=tS,o[1]=Qb(t,e);for(var l=2;l<r;l++)o[l]=n[l];return Pe.apply(null,o)};function os(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];return ns(t)}var nS=function(){var t=os.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},iS=function i(t){for(var e=t.length,n=0,r="";n<e;n++){var o=t[n];if(o!=null){var l=void 0;switch(typeof o){case"boolean":break;case"object":{if(Array.isArray(o))l=i(o);else{l="";for(var s in o)o[s]&&s&&(l&&(l+=" "),l+=s)}break}default:l=o}l&&(r&&(r+=" "),r+=l)}}return r};function rS(i,t,e){var n=[],r=qc(i,n,e);return n.length<2?e:r+t(n)}var oS=function(t){var e=t.cache,n=t.serializedArr;return Qc(function(){for(var r=0;r<n.length;r++)Xc(e,n[r],!1)}),null},sS=eh(function(i,t){var e=!1,n=[],r=function(){for(var u=arguments.length,c=new Array(u),h=0;h<u;h++)c[h]=arguments[h];var d=ns(c,t.registered);return n.push(d),es(t,d,!1),t.key+"-"+d.name},o=function(){for(var u=arguments.length,c=new Array(u),h=0;h<u;h++)c[h]=arguments[h];return rS(t.registered,r,iS(c))},l={css:r,cx:o,theme:Mn(th)},s=i.children(l);return e=!0,Pe(nt,null,Pe(oS,{cache:t,serializedArr:n}),s)});function aS(i,t){return t||(t=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(t)}}))}function ss(i,t){if(i==null)return{};var e={},n=Object.keys(i),r,o;for(o=0;o<n.length;o++)r=n[o],!(t.indexOf(r)>=0)&&(e[r]=i[r]);return e}function yn(i,t){if(i==null)return{};var e=ss(i,t),n,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,n)||(e[n]=i[n]))}return e}function wn(i){return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(i)}var nh={};Object.defineProperty(nh,"__esModule",{value:!0});var as=Object.assign||function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},ih=function(){function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),rh=$t,Jn=oh(rh),lS=Ln.exports,Ce=oh(lS);function oh(i){return i&&i.__esModule?i:{default:i}}function uS(i,t){var e={};for(var n in i)t.indexOf(n)>=0||!Object.prototype.hasOwnProperty.call(i,n)||(e[n]=i[n]);return e}function cS(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function hS(i,t){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:i}function dS(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(i,t):i.__proto__=t)}var sh={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},fS=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],pS=function(t){return fS.forEach(function(e){return delete t[e]}),t},ah=function(t,e){e.style.fontSize=t.fontSize,e.style.fontFamily=t.fontFamily,e.style.fontWeight=t.fontWeight,e.style.fontStyle=t.fontStyle,e.style.letterSpacing=t.letterSpacing,e.style.textTransform=t.textTransform},lh=typeof window!="undefined"&&window.navigator?/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent):!1,uh=function(){return lh?"_"+Math.random().toString(36).substr(2,12):void 0},ls=function(i){dS(t,i),ih(t,null,[{key:"getDerivedStateFromProps",value:function(n,r){var o=n.id;return o!==r.prevId?{inputId:o||uh(),prevId:o}:null}}]);function t(e){cS(this,t);var n=hS(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputRef=function(r){n.input=r,typeof n.props.inputRef=="function"&&n.props.inputRef(r)},n.placeHolderSizerRef=function(r){n.placeHolderSizer=r},n.sizerRef=function(r){n.sizer=r},n.state={inputWidth:e.minWidth,inputId:e.id||uh(),prevId:e.id},n}return ih(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}},{key:"componentDidUpdate",value:function(n,r){r.inputWidth!==this.state.inputWidth&&typeof this.props.onAutosize=="function"&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"copyInputStyles",value:function(){if(!(!this.mounted||!window.getComputedStyle)){var n=this.input&&window.getComputedStyle(this.input);!n||(ah(n,this.sizer),this.placeHolderSizer&&ah(n,this.placeHolderSizer))}}},{key:"updateInputWidth",value:function(){if(!(!this.mounted||!this.sizer||typeof this.sizer.scrollWidth=="undefined")){var n=void 0;this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?n=Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:n=this.sizer.scrollWidth+2;var r=this.props.type==="number"&&this.props.extraWidth===void 0?16:parseInt(this.props.extraWidth)||0;n+=r,n<this.props.minWidth&&(n=this.props.minWidth),n!==this.state.inputWidth&&this.setState({inputWidth:n})}}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"select",value:function(){this.input.select()}},{key:"renderStyles",value:function(){var n=this.props.injectStyles;return lh&&n?Jn.default.createElement("style",{dangerouslySetInnerHTML:{__html:"input#"+this.state.inputId+"::-ms-clear {display: none;}"}}):null}},{key:"render",value:function(){var n=[this.props.defaultValue,this.props.value,""].reduce(function(s,a){return s!=null?s:a}),r=as({},this.props.style);r.display||(r.display="inline-block");var o=as({boxSizing:"content-box",width:this.state.inputWidth+"px"},this.props.inputStyle),l=uS(this.props,[]);return pS(l),l.className=this.props.inputClassName,l.id=this.state.inputId,l.style=o,Jn.default.createElement("div",{className:this.props.className,style:r},this.renderStyles(),Jn.default.createElement("input",as({},l,{ref:this.inputRef})),Jn.default.createElement("div",{ref:this.sizerRef,style:sh},n),this.props.placeholder?Jn.default.createElement("div",{ref:this.placeHolderSizerRef,style:sh},this.props.placeholder):null)}}]),t}(rh.Component);ls.propTypes={className:Ce.default.string,defaultValue:Ce.default.any,extraWidth:Ce.default.oneOfType([Ce.default.number,Ce.default.string]),id:Ce.default.string,injectStyles:Ce.default.bool,inputClassName:Ce.default.string,inputRef:Ce.default.func,inputStyle:Ce.default.object,minWidth:Ce.default.oneOfType([Ce.default.number,Ce.default.string]),onAutosize:Ce.default.func,onChange:Ce.default.func,placeholder:Ce.default.string,placeholderIsMinWidth:Ce.default.bool,style:Ce.default.object,value:Ce.default.any},ls.defaultProps={minWidth:1,injectStyles:!0};var gS=nh.default=ls;function tr(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function mS(i,t){if(wn(i)!=="object"||i===null)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var n=e.call(i,t||"default");if(wn(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function ch(i){var t=mS(i,"string");return wn(t)==="symbol"?t:String(t)}function hh(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,ch(n.key),n)}}function nr(i,t,e){return t&&hh(i.prototype,t),e&&hh(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function ir(i,t){return ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ir(i,t)}function rr(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),t&&ir(i,t)}function _t(i,t,e){return t=ch(t),t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function vS(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function dh(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,n)}return e}function Le(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?dh(Object(e),!0).forEach(function(n){vS(i,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):dh(Object(e)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(e,n))})}return i}function or(i){return or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},or(i)}function yS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function wS(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function bS(i,t){return t&&(typeof t=="object"||typeof t=="function")?t:wS(i)}function sr(i){var t=yS();return function(){var n=or(i),r;if(t){var o=or(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return bS(this,r)}}var ar=function(){};function SS(i,t){return t?t[0]==="-"?i+t:i+"__"+t:i}function ES(i,t,e){var n=[e];if(t&&i)for(var r in t)t.hasOwnProperty(r)&&t[r]&&n.push("".concat(SS(i,r)));return n.filter(function(o){return o}).map(function(o){return String(o).trim()}).join(" ")}var fh=function(t){return Array.isArray(t)?t.filter(Boolean):wn(t)==="object"&&t!==null?[t]:[]},ph=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var e=yn(t,["className","clearValue","cx","getStyles","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"]);return Le({},e)};function us(i){return[document.documentElement,document.body,window].indexOf(i)>-1}function gh(i){return us(i)?window.pageYOffset:i.scrollTop}function lr(i,t){if(us(i)){window.scrollTo(0,t);return}i.scrollTop=t}function _S(i){var t=getComputedStyle(i),e=t.position==="absolute",n=/(auto|scroll)/,r=document.documentElement;if(t.position==="fixed")return r;for(var o=i;o=o.parentElement;)if(t=getComputedStyle(o),!(e&&t.position==="static")&&n.test(t.overflow+t.overflowY+t.overflowX))return o;return r}function xS(i,t,e,n){return e*((i=i/n-1)*i*i+1)+t}function ur(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ar,r=gh(i),o=t-r,l=10,s=0;function a(){s+=l;var u=xS(s,r,o,e);lr(i,u),s<e?window.requestAnimationFrame(a):n(i)}a()}function TS(i,t){var e=i.getBoundingClientRect(),n=t.getBoundingClientRect(),r=t.offsetHeight/3;n.bottom+r>e.bottom?lr(i,Math.min(t.offsetTop+t.clientHeight-i.offsetHeight+r,i.scrollHeight)):n.top-r<e.top&&lr(i,Math.max(t.offsetTop-r,0))}function CS(i){var t=i.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function mh(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function PS(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var vh=!1,AS={get passive(){return vh=!0}},cr=typeof window!="undefined"?window:{};cr.addEventListener&&cr.removeEventListener&&(cr.addEventListener("p",ar,AS),cr.removeEventListener("p",ar,!1));var OS=vh;function RS(i){var t=i.maxHeight,e=i.menuEl,n=i.minHeight,r=i.placement,o=i.shouldScroll,l=i.isFixedPosition,s=i.theme,a=s.spacing,u=_S(e),c={placement:"bottom",maxHeight:t};if(!e||!e.offsetParent)return c;var h=u.getBoundingClientRect(),d=h.height,p=e.getBoundingClientRect(),m=p.bottom,w=p.height,y=p.top,E=e.offsetParent.getBoundingClientRect(),T=E.top,C=window.innerHeight,B=gh(u),M=parseInt(getComputedStyle(e).marginBottom,10),N=parseInt(getComputedStyle(e).marginTop,10),I=T-N,G=C-y,W=I+B,ne=d-B-y,Q=m-C+B+M,$=B+y-N,oe=160;switch(r){case"auto":case"bottom":if(G>=w)return{placement:"bottom",maxHeight:t};if(ne>=w&&!l)return o&&ur(u,Q,oe),{placement:"bottom",maxHeight:t};if(!l&&ne>=n||l&&G>=n){o&&ur(u,Q,oe);var ve=l?G-M:ne-M;return{placement:"bottom",maxHeight:ve}}if(r==="auto"||l){var Ue=t,ye=l?I:W;return ye>=n&&(Ue=Math.min(ye-M-a.controlHeight,t)),{placement:"top",maxHeight:Ue}}if(r==="bottom")return o&&lr(u,Q),{placement:"bottom",maxHeight:t};break;case"top":if(I>=w)return{placement:"top",maxHeight:t};if(W>=w&&!l)return o&&ur(u,$,oe),{placement:"top",maxHeight:t};if(!l&&W>=n||l&&I>=n){var pe=t;return(!l&&W>=n||l&&I>=n)&&(pe=l?I-N:W-N),o&&ur(u,$,oe),{placement:"top",maxHeight:pe}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(r,'".'))}return c}function DS(i){var t={bottom:"top",top:"bottom"};return i?t[i]:"bottom"}var cs=function(t){return t==="auto"?"bottom":t},MS=function(t){var e,n=t.placement,r=t.theme,o=r.borderRadius,l=r.spacing,s=r.colors;return e={label:"menu"},_t(e,DS(n),"100%"),_t(e,"backgroundColor",s.neutral0),_t(e,"borderRadius",o),_t(e,"boxShadow","0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)"),_t(e,"marginBottom",l.menuGutter),_t(e,"marginTop",l.menuGutter),_t(e,"position","absolute"),_t(e,"width","100%"),_t(e,"zIndex",1),e},yh=Rn({getPortalPlacement:null}),wh=function(i){rr(e,i);var t=sr(e);function e(){var n;tr(this,e);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=t.call.apply(t,[this].concat(o)),n.state={maxHeight:n.props.maxMenuHeight,placement:null},n.getPlacement=function(s){var a=n.props,u=a.minMenuHeight,c=a.maxMenuHeight,h=a.menuPlacement,d=a.menuPosition,p=a.menuShouldScrollIntoView,m=a.theme;if(!!s){var w=d==="fixed",y=p&&!w,E=RS({maxHeight:c,menuEl:s,minHeight:u,placement:h,shouldScroll:y,isFixedPosition:w,theme:m}),T=n.context.getPortalPlacement;T&&T(E),n.setState(E)}},n.getUpdatedProps=function(){var s=n.props.menuPlacement,a=n.state.placement||cs(s);return Le(Le({},n.props),{},{placement:a,maxHeight:n.state.maxHeight})},n}return nr(e,[{key:"render",value:function(){var r=this.props.children;return r({ref:this.getPlacement,placerProps:this.getUpdatedProps()})}}]),e}(Te);wh.contextType=yh;var IS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerRef,s=t.innerProps;return J("div",K({css:o("menu",t),className:r({menu:!0},n),ref:l},s),e)},FS=function(t){var e=t.maxHeight,n=t.theme.spacing.baseUnit;return{maxHeight:e,overflowY:"auto",paddingBottom:n,paddingTop:n,position:"relative",WebkitOverflowScrolling:"touch"}},kS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps,s=t.innerRef,a=t.isMulti;return J("div",K({css:o("menuList",t),className:r({"menu-list":!0,"menu-list--is-multi":a},n),ref:s},l),e)},bh=function(t){var e=t.theme,n=e.spacing.baseUnit,r=e.colors;return{color:r.neutral40,padding:"".concat(n*2,"px ").concat(n*3,"px"),textAlign:"center"}},LS=bh,BS=bh,Sh=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps;return J("div",K({css:o("noOptionsMessage",t),className:r({"menu-notice":!0,"menu-notice--no-options":!0},n)},l),e)};Sh.defaultProps={children:"No options"};var Eh=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps;return J("div",K({css:o("loadingMessage",t),className:r({"menu-notice":!0,"menu-notice--loading":!0},n)},l),e)};Eh.defaultProps={children:"Loading..."};var NS=function(t){var e=t.rect,n=t.offset,r=t.position;return{left:e.left,position:r,top:n,width:e.width,zIndex:1}},HS=function(i){rr(e,i);var t=sr(e);function e(){var n;tr(this,e);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=t.call.apply(t,[this].concat(o)),n.state={placement:null},n.getPortalPlacement=function(s){var a=s.placement,u=cs(n.props.menuPlacement);a!==u&&n.setState({placement:a})},n}return nr(e,[{key:"render",value:function(){var r=this.props,o=r.appendTo,l=r.children,s=r.className,a=r.controlElement,u=r.cx,c=r.innerProps,h=r.menuPlacement,d=r.menuPosition,p=r.getStyles,m=d==="fixed";if(!o&&!m||!a)return null;var w=this.state.placement||cs(h),y=CS(a),E=m?0:window.pageYOffset,T=y[w]+E,C={offset:T,position:d,rect:y},B=J("div",K({css:p("menuPortal",C),className:u({"menu-portal":!0},s)},c),l);return J(yh.Provider,{value:{getPortalPlacement:this.getPortalPlacement}},o?Br(B,o):B)}}]),e}(Te),zS=function(t){var e=t.isDisabled,n=t.isRtl;return{label:"container",direction:n?"rtl":null,pointerEvents:e?"none":null,position:"relative"}},VS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps,s=t.isDisabled,a=t.isRtl;return J("div",K({css:o("container",t),className:r({"--is-disabled":s,"--is-rtl":a},n)},l),e)},US=function(t){var e=t.theme.spacing;return{alignItems:"center",display:"flex",flex:1,flexWrap:"wrap",padding:"".concat(e.baseUnit/2,"px ").concat(e.baseUnit*2,"px"),WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"}},WS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.innerProps,l=t.isMulti,s=t.getStyles,a=t.hasValue;return J("div",K({css:s("valueContainer",t),className:r({"value-container":!0,"value-container--is-multi":l,"value-container--has-value":a},n)},o),e)},jS=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},GS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.innerProps,l=t.getStyles;return J("div",K({css:l("indicatorsContainer",t),className:r({indicators:!0},n)},o),e)},_h,qS={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},xh=function(t){var e=t.size,n=yn(t,["size"]);return J("svg",K({height:e,width:e,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:qS},n))},hs=function(t){return J(xh,K({size:20},t),J("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Th=function(t){return J(xh,K({size:20},t),J("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Ch=function(t){var e=t.isFocused,n=t.theme,r=n.spacing.baseUnit,o=n.colors;return{label:"indicatorContainer",color:e?o.neutral60:o.neutral20,display:"flex",padding:r*2,transition:"color 150ms",":hover":{color:e?o.neutral80:o.neutral40}}},XS=Ch,ZS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps;return J("div",K({css:o("dropdownIndicator",t),className:r({indicator:!0,"dropdown-indicator":!0},n)},l),e||J(Th,null))},YS=Ch,KS=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps;return J("div",K({css:o("clearIndicator",t),className:r({indicator:!0,"clear-indicator":!0},n)},l),e||J(hs,null))},JS=function(t){var e=t.isDisabled,n=t.theme,r=n.spacing.baseUnit,o=n.colors;return{label:"indicatorSeparator",alignSelf:"stretch",backgroundColor:e?o.neutral10:o.neutral20,marginBottom:r*2,marginTop:r*2,width:1}},QS=function(t){var e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps;return J("span",K({},o,{css:r("indicatorSeparator",t),className:n({"indicator-separator":!0},e)}))},$S=nS(_h||(_h=aS([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),eE=function(t){var e=t.isFocused,n=t.size,r=t.theme,o=r.colors,l=r.spacing.baseUnit;return{label:"loadingIndicator",color:e?o.neutral60:o.neutral20,display:"flex",padding:l*2,transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"}},ds=function(t){var e=t.delay,n=t.offset;return J("span",{css:os({animation:"".concat($S," 1s ease-in-out ").concat(e,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":null,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Ph=function(t){var e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps,l=t.isRtl;return J("div",K({css:r("loadingIndicator",t),className:n({indicator:!0,"loading-indicator":!0},e)},o),J(ds,{delay:0,offset:l}),J(ds,{delay:160,offset:!0}),J(ds,{delay:320,offset:!l}))};Ph.defaultProps={size:4};var tE=function(t){var e=t.isDisabled,n=t.isFocused,r=t.theme,o=r.colors,l=r.borderRadius,s=r.spacing;return{label:"control",alignItems:"center",backgroundColor:e?o.neutral5:o.neutral0,borderColor:e?o.neutral10:n?o.primary:o.neutral20,borderRadius:l,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(o.primary):null,cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:s.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms","&:hover":{borderColor:n?o.primary:o.neutral30}}},nE=function(t){var e=t.children,n=t.cx,r=t.getStyles,o=t.className,l=t.isDisabled,s=t.isFocused,a=t.innerRef,u=t.innerProps,c=t.menuIsOpen;return J("div",K({ref:a,css:r("control",t),className:n({control:!0,"control--is-disabled":l,"control--is-focused":s,"control--menu-is-open":c},o)},u),e)},iE=function(t){var e=t.theme.spacing;return{paddingBottom:e.baseUnit*2,paddingTop:e.baseUnit*2}},rE=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.Heading,s=t.headingProps,a=t.innerProps,u=t.label,c=t.theme,h=t.selectProps;return J("div",K({css:o("group",t),className:r({group:!0},n)},a),J(l,K({},s,{selectProps:h,theme:c,getStyles:o,cx:r}),u),J("div",null,e))},oE=function(t){var e=t.theme.spacing;return{label:"group",color:"#999",cursor:"default",display:"block",fontSize:"75%",fontWeight:"500",marginBottom:"0.25em",paddingLeft:e.baseUnit*3,paddingRight:e.baseUnit*3,textTransform:"uppercase"}},sE=function(t){var e=t.getStyles,n=t.cx,r=t.className,o=ph(t);o.data;var l=yn(o,["data"]);return J("div",K({css:e("groupHeading",t),className:n({"group-heading":!0},r)},l))},aE=function(t){var e=t.isDisabled,n=t.theme,r=n.spacing,o=n.colors;return{margin:r.baseUnit/2,paddingBottom:r.baseUnit/2,paddingTop:r.baseUnit/2,visibility:e?"hidden":"visible",color:o.neutral80}},lE=function(t){return{label:"input",background:0,border:0,fontSize:"inherit",opacity:t?0:1,outline:0,padding:0,color:"inherit"}},uE=function(t){var e=t.className,n=t.cx,r=t.getStyles,o=ph(t),l=o.innerRef,s=o.isDisabled,a=o.isHidden,u=yn(o,["innerRef","isDisabled","isHidden"]);return J("div",{css:r("input",t)},J(gS,K({className:n({input:!0},e),inputRef:l,inputStyle:lE(a),disabled:s},u)))},cE=function(t){var e=t.theme,n=e.spacing,r=e.borderRadius,o=e.colors;return{label:"multiValue",backgroundColor:o.neutral10,borderRadius:r/2,display:"flex",margin:n.baseUnit/2,minWidth:0}},hE=function(t){var e=t.theme,n=e.borderRadius,r=e.colors,o=t.cropWithEllipsis;return{borderRadius:n/2,color:r.neutral80,fontSize:"85%",overflow:"hidden",padding:3,paddingLeft:6,textOverflow:o?"ellipsis":null,whiteSpace:"nowrap"}},dE=function(t){var e=t.theme,n=e.spacing,r=e.borderRadius,o=e.colors,l=t.isFocused;return{alignItems:"center",borderRadius:r/2,backgroundColor:l&&o.dangerLight,display:"flex",paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}}},Ah=function(t){var e=t.children,n=t.innerProps;return J("div",n,e)},fE=Ah,pE=Ah;function gE(i){var t=i.children,e=i.innerProps;return J("div",e,t||J(hs,{size:14}))}var Oh=function(t){var e=t.children,n=t.className,r=t.components,o=t.cx,l=t.data,s=t.getStyles,a=t.innerProps,u=t.isDisabled,c=t.removeProps,h=t.selectProps,d=r.Container,p=r.Label,m=r.Remove;return J(sS,null,function(w){var y=w.css,E=w.cx;return J(d,{data:l,innerProps:Le({className:E(y(s("multiValue",t)),o({"multi-value":!0,"multi-value--is-disabled":u},n))},a),selectProps:h},J(p,{data:l,innerProps:{className:E(y(s("multiValueLabel",t)),o({"multi-value__label":!0},n))},selectProps:h},e),J(m,{data:l,innerProps:Le({className:E(y(s("multiValueRemove",t)),o({"multi-value__remove":!0},n))},c),selectProps:h}))})};Oh.defaultProps={cropWithEllipsis:!0};var mE=function(t){var e=t.isDisabled,n=t.isFocused,r=t.isSelected,o=t.theme,l=o.spacing,s=o.colors;return{label:"option",backgroundColor:r?s.primary:n?s.primary25:"transparent",color:e?s.neutral20:r?s.neutral0:"inherit",cursor:"default",display:"block",fontSize:"inherit",padding:"".concat(l.baseUnit*2,"px ").concat(l.baseUnit*3,"px"),width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",":active":{backgroundColor:!e&&(r?s.primary:s.primary50)}}},vE=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.isDisabled,s=t.isFocused,a=t.isSelected,u=t.innerRef,c=t.innerProps;return J("div",K({css:o("option",t),className:r({option:!0,"option--is-disabled":l,"option--is-focused":s,"option--is-selected":a},n),ref:u},c),e)},yE=function(t){var e=t.theme,n=e.spacing,r=e.colors;return{label:"placeholder",color:r.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2,position:"absolute",top:"50%",transform:"translateY(-50%)"}},wE=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.innerProps;return J("div",K({css:o("placeholder",t),className:r({placeholder:!0},n)},l),e)},bE=function(t){var e=t.isDisabled,n=t.theme,r=n.spacing,o=n.colors;return{label:"singleValue",color:e?o.neutral40:o.neutral80,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2,maxWidth:"calc(100% - ".concat(r.baseUnit*2,"px)"),overflow:"hidden",position:"absolute",textOverflow:"ellipsis",whiteSpace:"nowrap",top:"50%",transform:"translateY(-50%)"}},SE=function(t){var e=t.children,n=t.className,r=t.cx,o=t.getStyles,l=t.isDisabled,s=t.innerProps;return J("div",K({css:o("singleValue",t),className:r({"single-value":!0,"single-value--is-disabled":l},n)},s),e)},EE={ClearIndicator:KS,Control:nE,DropdownIndicator:ZS,DownChevron:Th,CrossIcon:hs,Group:rE,GroupHeading:sE,IndicatorsContainer:GS,IndicatorSeparator:QS,Input:uE,LoadingIndicator:Ph,Menu:IS,MenuList:kS,MenuPortal:HS,LoadingMessage:Eh,NoOptionsMessage:Sh,MultiValue:Oh,MultiValueContainer:fE,MultiValueLabel:pE,MultiValueRemove:gE,Option:vE,Placeholder:wE,SelectContainer:VS,SingleValue:SE,ValueContainer:WS},_E=function(t){return Le(Le({},EE),t.components)};function fs(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=i[e];return n}function xE(i){if(Array.isArray(i))return fs(i)}function TE(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function CE(i,t){if(!!i){if(typeof i=="string")return fs(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return fs(i,t)}}function PE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rh(i){return xE(i)||TE(i)||CE(i)||PE()}var Dh=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function AE(i,t){return!!(i===t||Dh(i)&&Dh(t))}function OE(i,t){if(i.length!==t.length)return!1;for(var e=0;e<i.length;e++)if(!AE(i[e],t[e]))return!1;return!0}function RE(i,t){t===void 0&&(t=OE);var e,n=[],r,o=!1;function l(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return o&&e===this&&t(s,n)||(r=i.apply(this,s),o=!0,e=this,n=s),r}return l}for(var DE={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},ME=function(t){return J("span",K({css:DE},t))},IE={guidance:function(t){var e=t.isSearchable,n=t.isMulti,r=t.isDisabled,o=t.tabSelectsValue,l=t.context;switch(l){case"menu":return"Use Up and Down to choose options".concat(r?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(o?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(t["aria-label"]||"Select"," is focused ").concat(e?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var e=t.action,n=t.label,r=n===void 0?"":n,o=t.isDisabled;switch(e){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(r,", deselected.");case"select-option":return o?"option ".concat(r," is disabled. Select another option."):"option ".concat(r,", selected.");default:return""}},onFocus:function(t){var e=t.context,n=t.focused,r=n===void 0?{}:n,o=t.options,l=t.label,s=l===void 0?"":l,a=t.selectValue,u=t.isDisabled,c=t.isSelected,h=function(w,y){return w&&w.length?"".concat(w.indexOf(y)+1," of ").concat(w.length):""};if(e==="value"&&a)return"value ".concat(s," focused, ").concat(h(a,r),".");if(e==="menu"){var d=u?" disabled":"",p="".concat(c?"selected":"focused").concat(d);return"option ".concat(s," ").concat(p,", ").concat(h(o,r),".")}return""},onFilter:function(t){var e=t.inputValue,n=t.resultsMessage;return"".concat(n).concat(e?" for search term "+e:"",".")}},FE=function(t){var e=t.ariaSelection,n=t.focusedOption,r=t.focusedValue,o=t.focusableOptions,l=t.isFocused,s=t.selectValue,a=t.selectProps,u=a.ariaLiveMessages,c=a.getOptionLabel,h=a.inputValue,d=a.isMulti,p=a.isOptionDisabled,m=a.isSearchable,w=a.menuIsOpen,y=a.options,E=a.screenReaderStatus,T=a.tabSelectsValue,C=a["aria-label"],B=a["aria-live"],M=bt(function(){return Le(Le({},IE),u||{})},[u]),N=bt(function(){var Q="";if(e&&M.onChange){var $=e.option,oe=e.removedValue,ve=e.value,Ue=function(De){return Array.isArray(De)?null:De},ye=oe||$||Ue(ve),pe=Le({isDisabled:ye&&p(ye),label:ye?c(ye):""},e);Q=M.onChange(pe)}return Q},[e,p,c,M]),I=bt(function(){var Q="",$=n||r,oe=!!(n&&s&&s.includes(n));if($&&M.onFocus){var ve={focused:$,label:c($),isDisabled:p($),isSelected:oe,options:y,context:$===n?"menu":"value",selectValue:s};Q=M.onFocus(ve)}return Q},[n,r,c,p,M,y,s]),G=bt(function(){var Q="";if(w&&y.length&&M.onFilter){var $=E({count:o.length});Q=M.onFilter({inputValue:h,resultsMessage:$})}return Q},[o,h,w,M,y,E]),W=bt(function(){var Q="";if(M.guidance){var $=r?"value":w?"menu":"input";Q=M.guidance({"aria-label":C,context:$,isDisabled:n&&p(n),isMulti:d,isSearchable:m,tabSelectsValue:T})}return Q},[C,n,r,d,p,m,w,M,T]),ne="".concat(I," ").concat(G," ").concat(W);return J(ME,{"aria-live":B,"aria-atomic":"false","aria-relevant":"additions text"},l&&J(A.Fragment,null,J("span",{id:"aria-selection"},N),J("span",{id:"aria-context"},ne)))},ps=[{base:"A",letters:"A\u24B6\uFF21\xC0\xC1\xC2\u1EA6\u1EA4\u1EAA\u1EA8\xC3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\xC4\u01DE\u1EA2\xC5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F"},{base:"AA",letters:"\uA732"},{base:"AE",letters:"\xC6\u01FC\u01E2"},{base:"AO",letters:"\uA734"},{base:"AU",letters:"\uA736"},{base:"AV",letters:"\uA738\uA73A"},{base:"AY",letters:"\uA73C"},{base:"B",letters:"B\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181"},{base:"C",letters:"C\u24B8\uFF23\u0106\u0108\u010A\u010C\xC7\u1E08\u0187\u023B\uA73E"},{base:"D",letters:"D\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779"},{base:"DZ",letters:"\u01F1\u01C4"},{base:"Dz",letters:"\u01F2\u01C5"},{base:"E",letters:"E\u24BA\uFF25\xC8\xC9\xCA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\xCB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E"},{base:"F",letters:"F\u24BB\uFF26\u1E1E\u0191\uA77B"},{base:"G",letters:"G\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E"},{base:"H",letters:"H\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D"},{base:"I",letters:"I\u24BE\uFF29\xCC\xCD\xCE\u0128\u012A\u012C\u0130\xCF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197"},{base:"J",letters:"J\u24BF\uFF2A\u0134\u0248"},{base:"K",letters:"K\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2"},{base:"L",letters:"L\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780"},{base:"LJ",letters:"\u01C7"},{base:"Lj",letters:"\u01C8"},{base:"M",letters:"M\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C"},{base:"N",letters:"N\u24C3\uFF2E\u01F8\u0143\xD1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4"},{base:"NJ",letters:"\u01CA"},{base:"Nj",letters:"\u01CB"},{base:"O",letters:"O\u24C4\uFF2F\xD2\xD3\xD4\u1ED2\u1ED0\u1ED6\u1ED4\xD5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\xD6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\xD8\u01FE\u0186\u019F\uA74A\uA74C"},{base:"OI",letters:"\u01A2"},{base:"OO",letters:"\uA74E"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754"},{base:"Q",letters:"Q\u24C6\uFF31\uA756\uA758\u024A"},{base:"R",letters:"R\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782"},{base:"S",letters:"S\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784"},{base:"T",letters:"T\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786"},{base:"TZ",letters:"\uA728"},{base:"U",letters:"U\u24CA\uFF35\xD9\xDA\xDB\u0168\u1E78\u016A\u1E7A\u016C\xDC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244"},{base:"V",letters:"V\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245"},{base:"VY",letters:"\uA760"},{base:"W",letters:"W\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72"},{base:"X",letters:"X\u24CD\uFF38\u1E8A\u1E8C"},{base:"Y",letters:"Y\u24CE\uFF39\u1EF2\xDD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE"},{base:"Z",letters:"Z\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762"},{base:"a",letters:"a\u24D0\uFF41\u1E9A\xE0\xE1\xE2\u1EA7\u1EA5\u1EAB\u1EA9\xE3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\xE4\u01DF\u1EA3\xE5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250"},{base:"aa",letters:"\uA733"},{base:"ae",letters:"\xE6\u01FD\u01E3"},{base:"ao",letters:"\uA735"},{base:"au",letters:"\uA737"},{base:"av",letters:"\uA739\uA73B"},{base:"ay",letters:"\uA73D"},{base:"b",letters:"b\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253"},{base:"c",letters:"c\u24D2\uFF43\u0107\u0109\u010B\u010D\xE7\u1E09\u0188\u023C\uA73F\u2184"},{base:"d",letters:"d\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A"},{base:"dz",letters:"\u01F3\u01C6"},{base:"e",letters:"e\u24D4\uFF45\xE8\xE9\xEA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\xEB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD"},{base:"f",letters:"f\u24D5\uFF46\u1E1F\u0192\uA77C"},{base:"g",letters:"g\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F"},{base:"h",letters:"h\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24D8\uFF49\xEC\xED\xEE\u0129\u012B\u012D\xEF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131"},{base:"j",letters:"j\u24D9\uFF4A\u0135\u01F0\u0249"},{base:"k",letters:"k\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3"},{base:"l",letters:"l\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747"},{base:"lj",letters:"\u01C9"},{base:"m",letters:"m\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F"},{base:"n",letters:"n\u24DD\uFF4E\u01F9\u0144\xF1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5"},{base:"nj",letters:"\u01CC"},{base:"o",letters:"o\u24DE\uFF4F\xF2\xF3\xF4\u1ED3\u1ED1\u1ED7\u1ED5\xF5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\xF6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\xF8\u01FF\u0254\uA74B\uA74D\u0275"},{base:"oi",letters:"\u01A3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\uA74F"},{base:"p",letters:"p\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755"},{base:"q",letters:"q\u24E0\uFF51\u024B\uA757\uA759"},{base:"r",letters:"r\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783"},{base:"s",letters:"s\u24E2\uFF53\xDF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B"},{base:"t",letters:"t\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787"},{base:"tz",letters:"\uA729"},{base:"u",letters:"u\u24E4\uFF55\xF9\xFA\xFB\u0169\u1E79\u016B\u1E7B\u016D\xFC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289"},{base:"v",letters:"v\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C"},{base:"vy",letters:"\uA761"},{base:"w",letters:"w\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73"},{base:"x",letters:"x\u24E7\uFF58\u1E8B\u1E8D"},{base:"y",letters:"y\u24E8\uFF59\u1EF3\xFD\u0177\u1EF9\u0233\u1E8F\xFF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF"},{base:"z",letters:"z\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763"}],kE=new RegExp("["+ps.map(function(i){return i.letters}).join("")+"]","g"),Mh={},gs=0;gs<ps.length;gs++)for(var ms=ps[gs],vs=0;vs<ms.letters.length;vs++)Mh[ms.letters[vs]]=ms.base;var Ih=function(t){return t.replace(kE,function(e){return Mh[e]})},LE=RE(Ih),Fh=function(t){return t.replace(/^\s+|\s+$/g,"")},BE=function(t){return"".concat(t.label," ").concat(t.value)},NE=function(t){return function(e,n){var r=Le({ignoreCase:!0,ignoreAccents:!0,stringify:BE,trim:!0,matchFrom:"any"},t),o=r.ignoreCase,l=r.ignoreAccents,s=r.stringify,a=r.trim,u=r.matchFrom,c=a?Fh(n):n,h=a?Fh(s(e)):s(e);return o&&(c=c.toLowerCase(),h=h.toLowerCase()),l&&(c=LE(c),h=Ih(h)),u==="start"?h.substr(0,c.length)===c:h.indexOf(c)>-1}};function HE(i){i.in,i.out,i.onExited,i.appear,i.enter,i.exit;var t=i.innerRef;i.emotion;var e=yn(i,["in","out","onExited","appear","enter","exit","innerRef","emotion"]);return J("input",K({ref:t},e,{css:os({label:"dummyInput",background:0,border:0,fontSize:"inherit",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(0)"},"","")}))}var zE=function(t){t.preventDefault(),t.stopPropagation()};function VE(i){var t=i.isEnabled,e=i.onBottomArrive,n=i.onBottomLeave,r=i.onTopArrive,o=i.onTopLeave,l=ut(!1),s=ut(!1),a=ut(0),u=ut(null),c=ct(function(y,E){if(u.current!==null){var T=u.current,C=T.scrollTop,B=T.scrollHeight,M=T.clientHeight,N=u.current,I=E>0,G=B-M-C,W=!1;G>E&&l.current&&(n&&n(y),l.current=!1),I&&s.current&&(o&&o(y),s.current=!1),I&&E>G?(e&&!l.current&&e(y),N.scrollTop=B,W=!0,l.current=!0):!I&&-E>C&&(r&&!s.current&&r(y),N.scrollTop=0,W=!0,s.current=!0),W&&zE(y)}},[]),h=ct(function(y){c(y,y.deltaY)},[c]),d=ct(function(y){a.current=y.changedTouches[0].clientY},[]),p=ct(function(y){var E=a.current-y.changedTouches[0].clientY;c(y,E)},[c]),m=ct(function(y){if(!!y){var E=OS?{passive:!1}:!1;typeof y.addEventListener=="function"&&y.addEventListener("wheel",h,E),typeof y.addEventListener=="function"&&y.addEventListener("touchstart",d,E),typeof y.addEventListener=="function"&&y.addEventListener("touchmove",p,E)}},[p,d,h]),w=ct(function(y){!y||(typeof y.removeEventListener=="function"&&y.removeEventListener("wheel",h,!1),typeof y.removeEventListener=="function"&&y.removeEventListener("touchstart",d,!1),typeof y.removeEventListener=="function"&&y.removeEventListener("touchmove",p,!1))},[p,d,h]);return At(function(){if(!!t){var y=u.current;return m(y),function(){w(y)}}},[t,m,w]),function(y){u.current=y}}var kh=["boxSizing","height","overflow","paddingRight","position"],Lh={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Bh(i){i.preventDefault()}function Nh(i){i.stopPropagation()}function Hh(){var i=this.scrollTop,t=this.scrollHeight,e=i+this.offsetHeight;i===0?this.scrollTop=1:e===t&&(this.scrollTop=i-1)}function zh(){return"ontouchstart"in window||navigator.maxTouchPoints}var Vh=!!(typeof window!="undefined"&&window.document&&window.document.createElement),Qn=0,bn={capture:!1,passive:!1};function UE(i){var t=i.isEnabled,e=i.accountForScrollbars,n=e===void 0?!0:e,r=ut({}),o=ut(null),l=ct(function(a){if(!!Vh){var u=document.body,c=u&&u.style;if(n&&kh.forEach(function(m){var w=c&&c[m];r.current[m]=w}),n&&Qn<1){var h=parseInt(r.current.paddingRight,10)||0,d=document.body?document.body.clientWidth:0,p=window.innerWidth-d+h||0;Object.keys(Lh).forEach(function(m){var w=Lh[m];c&&(c[m]=w)}),c&&(c.paddingRight="".concat(p,"px"))}u&&zh()&&(u.addEventListener("touchmove",Bh,bn),a&&(a.addEventListener("touchstart",Hh,bn),a.addEventListener("touchmove",Nh,bn))),Qn+=1}},[]),s=ct(function(a){if(!!Vh){var u=document.body,c=u&&u.style;Qn=Math.max(Qn-1,0),n&&Qn<1&&kh.forEach(function(h){var d=r.current[h];c&&(c[h]=d)}),u&&zh()&&(u.removeEventListener("touchmove",Bh,bn),a&&(a.removeEventListener("touchstart",Hh,bn),a.removeEventListener("touchmove",Nh,bn)))}},[]);return At(function(){if(!!t){var a=o.current;return l(a),function(){s(a)}}},[t,l,s]),function(a){o.current=a}}var WE=function(){return document.activeElement&&document.activeElement.blur()},jE={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function GE(i){var t=i.children,e=i.lockEnabled,n=i.captureEnabled,r=n===void 0?!0:n,o=i.onBottomArrive,l=i.onBottomLeave,s=i.onTopArrive,a=i.onTopLeave,u=VE({isEnabled:r,onBottomArrive:o,onBottomLeave:l,onTopArrive:s,onTopLeave:a}),c=UE({isEnabled:e}),h=function(p){u(p),c(p)};return J(A.Fragment,null,e&&J("div",{onClick:WE,css:jE}),t(h))}var qE=function(t){return t.label},XE=function(t){return t.label},ZE=function(t){return t.value},YE=function(t){return!!t.isDisabled},KE={clearIndicator:YS,container:zS,control:tE,dropdownIndicator:XS,group:iE,groupHeading:oE,indicatorsContainer:jS,indicatorSeparator:JS,input:aE,loadingIndicator:eE,loadingMessage:BS,menu:MS,menuList:FS,menuPortal:NS,multiValue:cE,multiValueLabel:hE,multiValueRemove:dE,noOptionsMessage:LS,option:mE,placeholder:yE,singleValue:bE,valueContainer:US},JE={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},QE=4,Uh=4,$E=38,e_=Uh*2,t_={baseUnit:Uh,controlHeight:$E,menuGutter:e_},ys={borderRadius:QE,colors:JE,spacing:t_},n_={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:mh(),captureMenuScroll:!mh(),closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:NE(),formatGroupLabel:qE,getOptionLabel:XE,getOptionValue:ZE,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:YE,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!PS(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var e=t.count;return"".concat(e," result").concat(e!==1?"s":""," available")},styles:{},tabIndex:"0",tabSelectsValue:!0};function Wh(i,t,e,n){var r=Zh(i,t,e),o=Yh(i,t,e),l=Xh(i,t),s=hr(i,t);return{type:"option",data:t,isDisabled:r,isSelected:o,label:l,value:s,index:n}}function jh(i,t){return i.options.map(function(e,n){if(e.options){var r=e.options.map(function(l,s){return Wh(i,l,t,s)}).filter(function(l){return qh(i,l)});return r.length>0?{type:"group",data:e,options:r,index:n}:void 0}var o=Wh(i,e,t,n);return qh(i,o)?o:void 0}).filter(function(e){return!!e})}function Gh(i){return i.reduce(function(t,e){return e.type==="group"?t.push.apply(t,Rh(e.options.map(function(n){return n.data}))):t.push(e.data),t},[])}function i_(i,t){return Gh(jh(i,t))}function qh(i,t){var e=i.inputValue,n=e===void 0?"":e,r=t.data,o=t.isSelected,l=t.label,s=t.value;return(!Jh(i)||!o)&&Kh(i,{label:l,value:s,data:r},n)}function r_(i,t){var e=i.focusedValue,n=i.selectValue,r=n.indexOf(e);if(r>-1){var o=t.indexOf(e);if(o>-1)return e;if(r<t.length)return t[r]}return null}function o_(i,t){var e=i.focusedOption;return e&&t.indexOf(e)>-1?e:t[0]}var Xh=function(t,e){return t.getOptionLabel(e)},hr=function(t,e){return t.getOptionValue(e)};function Zh(i,t,e){return typeof i.isOptionDisabled=="function"?i.isOptionDisabled(t,e):!1}function Yh(i,t,e){if(e.indexOf(t)>-1)return!0;if(typeof i.isOptionSelected=="function")return i.isOptionSelected(t,e);var n=hr(i,t);return e.some(function(r){return hr(i,r)===n})}function Kh(i,t,e){return i.filterOption?i.filterOption(t,e):!0}var Jh=function(t){var e=t.hideSelectedOptions,n=t.isMulti;return e===void 0?n:e},s_=1,Qh=function(i){rr(e,i);var t=sr(e);function e(n){var r;return tr(this,e),r=t.call(this,n),r.state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},r.blockOptionHover=!1,r.isComposing=!1,r.commonProps=void 0,r.initialTouchX=0,r.initialTouchY=0,r.instancePrefix="",r.openAfterFocus=!1,r.scrollToFocusedOptionOnUpdate=!1,r.userIsDragging=void 0,r.controlRef=null,r.getControlRef=function(o){r.controlRef=o},r.focusedOptionRef=null,r.getFocusedOptionRef=function(o){r.focusedOptionRef=o},r.menuListRef=null,r.getMenuListRef=function(o){r.menuListRef=o},r.inputRef=null,r.getInputRef=function(o){r.inputRef=o},r.focus=r.focusInput,r.blur=r.blurInput,r.onChange=function(o,l){var s=r.props,a=s.onChange,u=s.name;l.name=u,r.ariaOnChange(o,l),a(o,l)},r.setValue=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set-value",s=arguments.length>2?arguments[2]:void 0,a=r.props,u=a.closeMenuOnSelect,c=a.isMulti;r.onInputChange("",{action:"set-value"}),u&&(r.setState({inputIsHiddenAfterUpdate:!c}),r.onMenuClose()),r.setState({clearFocusValueOnUpdate:!0}),r.onChange(o,{action:l,option:s})},r.selectOption=function(o){var l=r.props,s=l.blurInputOnSelect,a=l.isMulti,u=l.name,c=r.state.selectValue,h=a&&r.isOptionSelected(o,c),d=r.isOptionDisabled(o,c);if(h){var p=r.getOptionValue(o);r.setValue(c.filter(function(m){return r.getOptionValue(m)!==p}),"deselect-option",o)}else if(!d)a?r.setValue([].concat(Rh(c),[o]),"select-option",o):r.setValue(o,"select-option");else{r.ariaOnChange(o,{action:"select-option",name:u});return}s&&r.blurInput()},r.removeValue=function(o){var l=r.props.isMulti,s=r.state.selectValue,a=r.getOptionValue(o),u=s.filter(function(h){return r.getOptionValue(h)!==a}),c=l?u:u[0]||null;r.onChange(c,{action:"remove-value",removedValue:o}),r.focusInput()},r.clearValue=function(){var o=r.state.selectValue;r.onChange(r.props.isMulti?[]:null,{action:"clear",removedValues:o})},r.popValue=function(){var o=r.props.isMulti,l=r.state.selectValue,s=l[l.length-1],a=l.slice(0,l.length-1),u=o?a:a[0]||null;r.onChange(u,{action:"pop-value",removedValue:s})},r.getValue=function(){return r.state.selectValue},r.cx=function(){for(var o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return ES.apply(void 0,[r.props.classNamePrefix].concat(l))},r.getOptionLabel=function(o){return Xh(r.props,o)},r.getOptionValue=function(o){return hr(r.props,o)},r.getStyles=function(o,l){var s=KE[o](l);s.boxSizing="border-box";var a=r.props.styles[o];return a?a(s,l):s},r.getElementId=function(o){return"".concat(r.instancePrefix,"-").concat(o)},r.getComponents=function(){return _E(r.props)},r.buildCategorizedOptions=function(){return jh(r.props,r.state.selectValue)},r.getCategorizedOptions=function(){return r.props.menuIsOpen?r.buildCategorizedOptions():[]},r.buildFocusableOptions=function(){return Gh(r.buildCategorizedOptions())},r.getFocusableOptions=function(){return r.props.menuIsOpen?r.buildFocusableOptions():[]},r.ariaOnChange=function(o,l){r.setState({ariaSelection:Le({value:o},l)})},r.onMenuMouseDown=function(o){o.button===0&&(o.stopPropagation(),o.preventDefault(),r.focusInput())},r.onMenuMouseMove=function(o){r.blockOptionHover=!1},r.onControlMouseDown=function(o){var l=r.props.openMenuOnClick;r.state.isFocused?r.props.menuIsOpen?o.target.tagName!=="INPUT"&&o.target.tagName!=="TEXTAREA"&&r.onMenuClose():l&&r.openMenu("first"):(l&&(r.openAfterFocus=!0),r.focusInput()),o.target.tagName!=="INPUT"&&o.target.tagName!=="TEXTAREA"&&o.preventDefault()},r.onDropdownIndicatorMouseDown=function(o){if(!(o&&o.type==="mousedown"&&o.button!==0)&&!r.props.isDisabled){var l=r.props,s=l.isMulti,a=l.menuIsOpen;r.focusInput(),a?(r.setState({inputIsHiddenAfterUpdate:!s}),r.onMenuClose()):r.openMenu("first"),o.preventDefault(),o.stopPropagation()}},r.onClearIndicatorMouseDown=function(o){o&&o.type==="mousedown"&&o.button!==0||(r.clearValue(),o.stopPropagation(),r.openAfterFocus=!1,o.type==="touchend"?r.focusInput():setTimeout(function(){return r.focusInput()}))},r.onScroll=function(o){typeof r.props.closeMenuOnScroll=="boolean"?o.target instanceof HTMLElement&&us(o.target)&&r.props.onMenuClose():typeof r.props.closeMenuOnScroll=="function"&&r.props.closeMenuOnScroll(o)&&r.props.onMenuClose()},r.onCompositionStart=function(){r.isComposing=!0},r.onCompositionEnd=function(){r.isComposing=!1},r.onTouchStart=function(o){var l=o.touches,s=l&&l.item(0);!s||(r.initialTouchX=s.clientX,r.initialTouchY=s.clientY,r.userIsDragging=!1)},r.onTouchMove=function(o){var l=o.touches,s=l&&l.item(0);if(!!s){var a=Math.abs(s.clientX-r.initialTouchX),u=Math.abs(s.clientY-r.initialTouchY),c=5;r.userIsDragging=a>c||u>c}},r.onTouchEnd=function(o){r.userIsDragging||(r.controlRef&&!r.controlRef.contains(o.target)&&r.menuListRef&&!r.menuListRef.contains(o.target)&&r.blurInput(),r.initialTouchX=0,r.initialTouchY=0)},r.onControlTouchEnd=function(o){r.userIsDragging||r.onControlMouseDown(o)},r.onClearIndicatorTouchEnd=function(o){r.userIsDragging||r.onClearIndicatorMouseDown(o)},r.onDropdownIndicatorTouchEnd=function(o){r.userIsDragging||r.onDropdownIndicatorMouseDown(o)},r.handleInputChange=function(o){var l=o.currentTarget.value;r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange(l,{action:"input-change"}),r.props.menuIsOpen||r.onMenuOpen()},r.onInputFocus=function(o){r.props.onFocus&&r.props.onFocus(o),r.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(r.openAfterFocus||r.props.openMenuOnFocus)&&r.openMenu("first"),r.openAfterFocus=!1},r.onInputBlur=function(o){if(r.menuListRef&&r.menuListRef.contains(document.activeElement)){r.inputRef.focus();return}r.props.onBlur&&r.props.onBlur(o),r.onInputChange("",{action:"input-blur"}),r.onMenuClose(),r.setState({focusedValue:null,isFocused:!1})},r.onOptionHover=function(o){r.blockOptionHover||r.state.focusedOption===o||r.setState({focusedOption:o})},r.shouldHideSelectedOptions=function(){return Jh(r.props)},r.onKeyDown=function(o){var l=r.props,s=l.isMulti,a=l.backspaceRemovesValue,u=l.escapeClearsValue,c=l.inputValue,h=l.isClearable,d=l.isDisabled,p=l.menuIsOpen,m=l.onKeyDown,w=l.tabSelectsValue,y=l.openMenuOnFocus,E=r.state,T=E.focusedOption,C=E.focusedValue,B=E.selectValue;if(!d&&!(typeof m=="function"&&(m(o),o.defaultPrevented))){switch(r.blockOptionHover=!0,o.key){case"ArrowLeft":if(!s||c)return;r.focusValue("previous");break;case"ArrowRight":if(!s||c)return;r.focusValue("next");break;case"Delete":case"Backspace":if(c)return;if(C)r.removeValue(C);else{if(!a)return;s?r.popValue():h&&r.clearValue()}break;case"Tab":if(r.isComposing||o.shiftKey||!p||!w||!T||y&&r.isOptionSelected(T,B))return;r.selectOption(T);break;case"Enter":if(o.keyCode===229)break;if(p){if(!T||r.isComposing)return;r.selectOption(T);break}return;case"Escape":p?(r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange("",{action:"menu-close"}),r.onMenuClose()):h&&u&&r.clearValue();break;case" ":if(c)return;if(!p){r.openMenu("first");break}if(!T)return;r.selectOption(T);break;case"ArrowUp":p?r.focusOption("up"):r.openMenu("last");break;case"ArrowDown":p?r.focusOption("down"):r.openMenu("first");break;case"PageUp":if(!p)return;r.focusOption("pageup");break;case"PageDown":if(!p)return;r.focusOption("pagedown");break;case"Home":if(!p)return;r.focusOption("first");break;case"End":if(!p)return;r.focusOption("last");break;default:return}o.preventDefault()}},r.instancePrefix="react-select-"+(r.props.instanceId||++s_),r.state.selectValue=fh(n.value),r}return nr(e,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput()}},{key:"componentDidUpdate",value:function(r){var o=this.props,l=o.isDisabled,s=o.menuIsOpen,a=this.state.isFocused;(a&&!l&&r.isDisabled||a&&s&&!r.menuIsOpen)&&this.focusInput(),a&&l&&!r.isDisabled&&this.setState({isFocused:!1},this.onMenuClose),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(TS(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close"}),this.props.onMenuClose()}},{key:"onInputChange",value:function(r,o){this.props.onInputChange(r,o)}},{key:"focusInput",value:function(){!this.inputRef||this.inputRef.focus()}},{key:"blurInput",value:function(){!this.inputRef||this.inputRef.blur()}},{key:"openMenu",value:function(r){var o=this,l=this.state,s=l.selectValue,a=l.isFocused,u=this.buildFocusableOptions(),c=r==="first"?0:u.length-1;if(!this.props.isMulti){var h=u.indexOf(s[0]);h>-1&&(c=h)}this.scrollToFocusedOptionOnUpdate=!(a&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[c]},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(r){var o=this.state,l=o.selectValue,s=o.focusedValue;if(!!this.props.isMulti){this.setState({focusedOption:null});var a=l.indexOf(s);s||(a=-1);var u=l.length-1,c=-1;if(!!l.length){switch(r){case"previous":a===0?c=0:a===-1?c=u:c=a-1;break;case"next":a>-1&&a<u&&(c=a+1);break}this.setState({inputIsHidden:c!==-1,focusedValue:l[c]})}}}},{key:"focusOption",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,s=this.getFocusableOptions();if(!!s.length){var a=0,u=s.indexOf(l);l||(u=-1),r==="up"?a=u>0?u-1:s.length-1:r==="down"?a=(u+1)%s.length:r==="pageup"?(a=u-o,a<0&&(a=0)):r==="pagedown"?(a=u+o,a>s.length-1&&(a=s.length-1)):r==="last"&&(a=s.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:s[a],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(ys):Le(Le({},ys),this.props.theme):ys}},{key:"getCommonProps",value:function(){var r=this.clearValue,o=this.cx,l=this.getStyles,s=this.getValue,a=this.selectOption,u=this.setValue,c=this.props,h=c.isMulti,d=c.isRtl,p=c.options,m=this.hasValue();return{clearValue:r,cx:o,getStyles:l,getValue:s,hasValue:m,isMulti:h,isRtl:d,options:p,selectOption:a,selectProps:c,setValue:u,theme:this.getTheme()}}},{key:"hasValue",value:function(){var r=this.state.selectValue;return r.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var r=this.props,o=r.isClearable,l=r.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(r,o){return Zh(this.props,r,o)}},{key:"isOptionSelected",value:function(r,o){return Yh(this.props,r,o)}},{key:"filterOption",value:function(r,o){return Kh(this.props,r,o)}},{key:"formatOptionLabel",value:function(r,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,s=this.state.selectValue;return this.props.formatOptionLabel(r,{context:o,inputValue:l,selectValue:s})}else return this.getOptionLabel(r)}},{key:"formatGroupLabel",value:function(r){return this.props.formatGroupLabel(r)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var r=this.props,o=r.isDisabled,l=r.isSearchable,s=r.inputId,a=r.inputValue,u=r.tabIndex,c=r.form,h=this.getComponents(),d=h.Input,p=this.state.inputIsHidden,m=this.commonProps,w=s||this.getElementId("input"),y={"aria-autocomplete":"list","aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"]};return l?A.createElement(d,K({},m,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:w,innerRef:this.getInputRef,isDisabled:o,isHidden:p,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:c,type:"text",value:a},y)):A.createElement(HE,K({id:w,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:ar,onFocus:this.onInputFocus,readOnly:!0,disabled:o,tabIndex:u,form:c,value:""},y))}},{key:"renderPlaceholderOrValue",value:function(){var r=this,o=this.getComponents(),l=o.MultiValue,s=o.MultiValueContainer,a=o.MultiValueLabel,u=o.MultiValueRemove,c=o.SingleValue,h=o.Placeholder,d=this.commonProps,p=this.props,m=p.controlShouldRenderValue,w=p.isDisabled,y=p.isMulti,E=p.inputValue,T=p.placeholder,C=this.state,B=C.selectValue,M=C.focusedValue,N=C.isFocused;if(!this.hasValue()||!m)return E?null:A.createElement(h,K({},d,{key:"placeholder",isDisabled:w,isFocused:N}),T);if(y){var I=B.map(function(W,ne){var Q=W===M;return A.createElement(l,K({},d,{components:{Container:s,Label:a,Remove:u},isFocused:Q,isDisabled:w,key:"".concat(r.getOptionValue(W)).concat(ne),index:ne,removeProps:{onClick:function(){return r.removeValue(W)},onTouchEnd:function(){return r.removeValue(W)},onMouseDown:function(oe){oe.preventDefault(),oe.stopPropagation()}},data:W}),r.formatOptionLabel(W,"value"))});return I}if(E)return null;var G=B[0];return A.createElement(c,K({},d,{data:G,isDisabled:w}),this.formatOptionLabel(G,"value"))}},{key:"renderClearIndicator",value:function(){var r=this.getComponents(),o=r.ClearIndicator,l=this.commonProps,s=this.props,a=s.isDisabled,u=s.isLoading,c=this.state.isFocused;if(!this.isClearable()||!o||a||!this.hasValue()||u)return null;var h={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return A.createElement(o,K({},l,{innerProps:h,isFocused:c}))}},{key:"renderLoadingIndicator",value:function(){var r=this.getComponents(),o=r.LoadingIndicator,l=this.commonProps,s=this.props,a=s.isDisabled,u=s.isLoading,c=this.state.isFocused;if(!o||!u)return null;var h={"aria-hidden":"true"};return A.createElement(o,K({},l,{innerProps:h,isDisabled:a,isFocused:c}))}},{key:"renderIndicatorSeparator",value:function(){var r=this.getComponents(),o=r.DropdownIndicator,l=r.IndicatorSeparator;if(!o||!l)return null;var s=this.commonProps,a=this.props.isDisabled,u=this.state.isFocused;return A.createElement(l,K({},s,{isDisabled:a,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var r=this.getComponents(),o=r.DropdownIndicator;if(!o)return null;var l=this.commonProps,s=this.props.isDisabled,a=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return A.createElement(o,K({},l,{innerProps:u,isDisabled:s,isFocused:a}))}},{key:"renderMenu",value:function(){var r=this,o=this.getComponents(),l=o.Group,s=o.GroupHeading,a=o.Menu,u=o.MenuList,c=o.MenuPortal,h=o.LoadingMessage,d=o.NoOptionsMessage,p=o.Option,m=this.commonProps,w=this.state.focusedOption,y=this.props,E=y.captureMenuScroll,T=y.inputValue,C=y.isLoading,B=y.loadingMessage,M=y.minMenuHeight,N=y.maxMenuHeight,I=y.menuIsOpen,G=y.menuPlacement,W=y.menuPosition,ne=y.menuPortalTarget,Q=y.menuShouldBlockScroll,$=y.menuShouldScrollIntoView,oe=y.noOptionsMessage,ve=y.onMenuScrollToTop,Ue=y.onMenuScrollToBottom;if(!I)return null;var ye=function(O,H){var z=O.type,V=O.data,q=O.isDisabled,te=O.isSelected,ce=O.label,ae=O.value,Qe=w===V,$e=q?void 0:function(){return r.onOptionHover(V)},et=q?void 0:function(){return r.selectOption(V)},qe="".concat(r.getElementId("option"),"-").concat(H),at={id:qe,onClick:et,onMouseMove:$e,onMouseOver:$e,tabIndex:-1};return A.createElement(p,K({},m,{innerProps:at,data:V,isDisabled:q,isSelected:te,key:qe,label:ce,type:z,value:ae,isFocused:Qe,innerRef:Qe?r.getFocusedOptionRef:void 0}),r.formatOptionLabel(O.data,"menu"))},pe;if(this.hasOptions())pe=this.getCategorizedOptions().map(function(D){if(D.type==="group"){var O=D.data,H=D.options,z=D.index,V="".concat(r.getElementId("group"),"-").concat(z),q="".concat(V,"-heading");return A.createElement(l,K({},m,{key:V,data:O,options:H,Heading:s,headingProps:{id:q,data:D.data},label:r.formatGroupLabel(D.data)}),D.options.map(function(te){return ye(te,"".concat(z,"-").concat(te.index))}))}else if(D.type==="option")return ye(D,"".concat(D.index))});else if(C){var Ge=B({inputValue:T});if(Ge===null)return null;pe=A.createElement(h,m,Ge)}else{var De=oe({inputValue:T});if(De===null)return null;pe=A.createElement(d,m,De)}var Ee={minMenuHeight:M,maxMenuHeight:N,menuPlacement:G,menuPosition:W,menuShouldScrollIntoView:$},st=A.createElement(wh,K({},m,Ee),function(D){var O=D.ref,H=D.placerProps,z=H.placement,V=H.maxHeight;return A.createElement(a,K({},m,Ee,{innerRef:O,innerProps:{onMouseDown:r.onMenuMouseDown,onMouseMove:r.onMenuMouseMove},isLoading:C,placement:z}),A.createElement(GE,{captureEnabled:E,onTopArrive:ve,onBottomArrive:Ue,lockEnabled:Q},function(q){return A.createElement(u,K({},m,{innerRef:function(ce){r.getMenuListRef(ce),q(ce)},isLoading:C,maxHeight:V,focusedOption:w}),pe)}))});return ne||W==="fixed"?A.createElement(c,K({},m,{appendTo:ne,controlElement:this.controlRef,menuPlacement:G,menuPosition:W}),st):st}},{key:"renderFormField",value:function(){var r=this,o=this.props,l=o.delimiter,s=o.isDisabled,a=o.isMulti,u=o.name,c=this.state.selectValue;if(!(!u||s))if(a)if(l){var h=c.map(function(m){return r.getOptionValue(m)}).join(l);return A.createElement("input",{name:u,type:"hidden",value:h})}else{var d=c.length>0?c.map(function(m,w){return A.createElement("input",{key:"i-".concat(w),name:u,type:"hidden",value:r.getOptionValue(m)})}):A.createElement("input",{name:u,type:"hidden"});return A.createElement("div",null,d)}else{var p=c[0]?this.getOptionValue(c[0]):"";return A.createElement("input",{name:u,type:"hidden",value:p})}}},{key:"renderLiveRegion",value:function(){var r=this.commonProps,o=this.state,l=o.ariaSelection,s=o.focusedOption,a=o.focusedValue,u=o.isFocused,c=o.selectValue,h=this.getFocusableOptions();return A.createElement(FE,K({},r,{ariaSelection:l,focusedOption:s,focusedValue:a,isFocused:u,selectValue:c,focusableOptions:h}))}},{key:"render",value:function(){var r=this.getComponents(),o=r.Control,l=r.IndicatorsContainer,s=r.SelectContainer,a=r.ValueContainer,u=this.props,c=u.className,h=u.id,d=u.isDisabled,p=u.menuIsOpen,m=this.state.isFocused,w=this.commonProps=this.getCommonProps();return A.createElement(s,K({},w,{className:c,innerProps:{id:h,onKeyDown:this.onKeyDown},isDisabled:d,isFocused:m}),this.renderLiveRegion(),A.createElement(o,K({},w,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:d,isFocused:m,menuIsOpen:p}),A.createElement(a,K({},w,{isDisabled:d}),this.renderPlaceholderOrValue(),this.renderInput()),A.createElement(l,K({},w,{isDisabled:d}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(r,o){var l=o.prevProps,s=o.clearFocusValueOnUpdate,a=o.inputIsHiddenAfterUpdate,u=r.options,c=r.value,h=r.menuIsOpen,d=r.inputValue,p={};if(l&&(c!==l.value||u!==l.options||h!==l.menuIsOpen||d!==l.inputValue)){var m=fh(c),w=h?i_(r,m):[],y=s?r_(o,m):null,E=o_(o,w);p={selectValue:m,focusedOption:E,focusedValue:y,clearFocusValueOnUpdate:!1}}var T=a!=null&&r!==l?{inputIsHidden:a,inputIsHiddenAfterUpdate:void 0}:{};return Le(Le(Le({},p),T),{},{prevProps:r})}}]),e}(Te);Qh.defaultProps=n_;var a_={defaultInputValue:"",defaultMenuIsOpen:!1,defaultValue:null},l_=function(t){var e,n;return n=e=function(r){rr(l,r);var o=sr(l);function l(){var s;tr(this,l);for(var a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return s=o.call.apply(o,[this].concat(u)),s.select=void 0,s.state={inputValue:s.props.inputValue!==void 0?s.props.inputValue:s.props.defaultInputValue,menuIsOpen:s.props.menuIsOpen!==void 0?s.props.menuIsOpen:s.props.defaultMenuIsOpen,value:s.props.value!==void 0?s.props.value:s.props.defaultValue},s.onChange=function(h,d){s.callProp("onChange",h,d),s.setState({value:h})},s.onInputChange=function(h,d){var p=s.callProp("onInputChange",h,d);s.setState({inputValue:p!==void 0?p:h})},s.onMenuOpen=function(){s.callProp("onMenuOpen"),s.setState({menuIsOpen:!0})},s.onMenuClose=function(){s.callProp("onMenuClose"),s.setState({menuIsOpen:!1})},s}return nr(l,[{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"getProp",value:function(a){return this.props[a]!==void 0?this.props[a]:this.state[a]}},{key:"callProp",value:function(a){if(typeof this.props[a]=="function"){for(var u,c=arguments.length,h=new Array(c>1?c-1:0),d=1;d<c;d++)h[d-1]=arguments[d];return(u=this.props)[a].apply(u,h)}}},{key:"render",value:function(){var a=this,u=this.props;u.defaultInputValue,u.defaultMenuIsOpen,u.defaultValue;var c=yn(u,["defaultInputValue","defaultMenuIsOpen","defaultValue"]);return A.createElement(t,K({},c,{ref:function(d){a.select=d},inputValue:this.getProp("inputValue"),menuIsOpen:this.getProp("menuIsOpen"),onChange:this.onChange,onInputChange:this.onInputChange,onMenuClose:this.onMenuClose,onMenuOpen:this.onMenuOpen,value:this.getProp("value")}))}}]),l}(Te),e.defaultProps=a_,n},u_=l_(Qh),c_=u_;const ws=[{value:"assessing",label:"Assessing"},{value:"bookmarking",label:"Bookmarking"},{value:"classifying",label:"Classifying"},{value:"commenting",label:"Commenting"},{value:"describing",label:"Describing"},{value:"editing",label:"Editing"},{value:"highlighting",label:"Highlighting"},{value:"identifying",label:"Identifying"},{value:"linking",label:"Linking"},{value:"moderating",label:"Moderating"},{value:"questioning",label:"Questioning"},{value:"replying",label:"Replying"},{value:"supplementing",label:"Transcription"}];var $h=i=>{const t=i.content?ws.find(e=>e.value===i.content):null;return A.createElement("div",{className:"r6o-purposedropdown"},A.createElement(c_,{value:t,onChange:i.onChange,options:ws,isDisabled:!i.editable}))};const h_=i=>A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 940",width:i.width},A.createElement("metadata",null,"IcoFont Icons"),A.createElement("title",null,"simple-down"),A.createElement("glyph",{glyphName:"simple-down",unicode:"\uEAB2",horizAdvX:"1000"}),A.createElement("path",{fill:"currentColor",d:"M200 392.6l300 300 300-300-85.10000000000002-85.10000000000002-214.89999999999998 214.79999999999995-214.89999999999998-214.89999999999998-85.10000000000002 85.20000000000005z"})),ed=i=>A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"180 150 700 800",width:i.width},A.createElement("metadata",null,"IcoFont Icons"),A.createElement("title",null,"close"),A.createElement("glyph",{glyphName:"close",unicode:"\uEEE4",horizAdvX:"1000"}),A.createElement("path",{fill:"currentColor",d:"M709.8 206.6c-64.39999999999998 65.50000000000003-128.89999999999998 131.20000000000002-194.19999999999993 197.6-8.600000000000023 8.699999999999989-22.400000000000034 8.800000000000011-31 0-65-66-129.70000000000005-131.8-194.5-197.6-8.600000000000023-8.699999999999989-22.400000000000034-8.599999999999994-30.900000000000034 0.09999999999999432-15.699999999999989 16.200000000000017-31.099999999999994 32.30000000000001-47.099999999999994 48.80000000000001-8.5 8.800000000000011-8.299999999999983 23 0.20000000000001705 31.69999999999999 63.099999999999966 64.19999999999999 127.89999999999998 130.10000000000002 193.59999999999997 197 8.600000000000023 8.699999999999989 8.5 22.80000000000001 0 31.599999999999966-65.19999999999999 66.40000000000009-130.2 132.5-194.7 198.10000000000002-8.5 8.700000000000045-8.5 22.800000000000068 0.20000000000001705 31.399999999999977l47.79999999999998 47.90000000000009c8.600000000000023 8.599999999999909 22.600000000000023 8.599999999999909 31.100000000000023-0.10000000000002274l194.2-197.30000000000007c8.600000000000023-8.699999999999932 22.399999999999977-8.699999999999932 31 0 64.70000000000005 65.80000000000007 129.20000000000005 131.4000000000001 194.20000000000005 197.5 8.599999999999909 8.700000000000045 22.5 8.800000000000068 31 0.10000000000002274 16-16.199999999999932 31.699999999999932-32.19999999999993 47.59999999999991-48.299999999999955 8.600000000000023-8.700000000000045 8.600000000000023-22.899999999999977 0.10000000000002274-31.600000000000023-63.799999999999955-65-128.5-130.89999999999998-194.19999999999993-197.79999999999995-8.600000000000023-8.700000000000045-8.600000000000023-22.900000000000034 0-31.600000000000023 65.19999999999993-66.40000000000003 130.0999999999999-132.5 194.5-198.20000000000005 8.599999999999909-8.699999999999989 8.5-22.799999999999955-0.10000000000002274-31.49999999999997l-47.80000000000007-48.099999999999994c-8.5-8.5-22.399999999999977-8.400000000000006-31 0.29999999999998295z"})),d_=i=>A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:i.width},A.createElement("path",{fill:"currentColor",d:"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"}));var f_=i=>{const[t,e]=rt(!1),[n,r]=rt(!1),o=h=>{e(!0),r(!1)},l=h=>{i.onDelete(i.body),r(!1)},s=h=>i.onUpdate(i.body,{...i.body,value:h.target.value}),a=h=>i.onUpdate(i.body,{...i.body,purpose:h.value}),u=i.body.modified||i.body.created,c=i.body.creator&&A.createElement("div",{className:"r6o-lastmodified"},A.createElement("span",{className:"r6o-lastmodified-by"},i.body.creator.name||i.body.creator.id),i.body.created&&A.createElement("span",{className:"r6o-lastmodified-at"},A.createElement(Pp,{datetime:i.env.toClientTime(u),locale:We.locale()})));return i.readOnly?A.createElement("div",{className:"r6o-widget comment"},A.createElement("div",{className:"r6o-readonly-comment"},i.body.value),c):A.createElement("div",{className:t?"r6o-widget comment editable":"r6o-widget comment"},A.createElement(Dc,{editable:t,content:i.body.value,onChange:s,onSaveAndClose:i.onSaveAndClose}),!t&&c,i.purposeSelector&&A.createElement($h,{editable:t,content:i.body.purpose,onChange:a,onSaveAndClose:i.onSaveAndClose}),A.createElement("div",{className:n?"r6o-icon r6o-arrow-down r6o-menu-open":"r6o-icon r6o-arrow-down",onClick:()=>r(!n)},A.createElement(h_,{width:12})),n&&A.createElement(Kw,{onEdit:o,onDelete:l,onClickOutside:()=>r(!1)}))};const p_=ws.map(i=>i.value),td=(i,t)=>{const e=t?p_.indexOf(i.purpose)>-1:i.purpose=="commenting"||i.purpose=="replying";return i.type==="TextualBody"&&(!Object.prototype.hasOwnProperty.call(i,"purpose")||e)},nd=(i,t)=>{var e,n;if(t.editable===!0)return!1;if(t.editable===!1)return!0;if(t.editable==="MINE_ONLY"){const r=(e=i.creator)==null?void 0:e.id;return((n=t.env.user)==null?void 0:n.id)!==r}return t.readOnly},g_=(i,t)=>i||{type:"TextualBody",value:"",purpose:t?"replying":"commenting",draft:!0},id=i=>{const t=i.annotation?i.annotation.bodies.filter(a=>td(a,i.purposeSelector)):[],e=g_(t.find(a=>a.draft==!0),t.length>1),n=t.filter(a=>a!=e),r=a=>{const u=e.value,c=a.target.value;u.length===0&&c.length>0?i.onAppendBody({...e,value:c}):u.length>0&&c.length===0?i.onRemoveBody(e):i.onUpdateBody(e,{...e,value:c})},o=a=>i.onUpdateBody(e,{...e,purpose:a.value}),l=!i.readOnly&&i.annotation,s=n.length===0||!i.disableReply;return A.createElement(A.Fragment,null,n.map((a,u)=>A.createElement(f_,{key:u,env:i.env,purposeSelector:i.purposeSelector,readOnly:nd(a,i),body:a,onUpdate:i.onUpdateBody,onDelete:i.onRemoveBody,onSaveAndClose:i.onSaveAndClose})),l&&s&&A.createElement("div",{className:"r6o-widget comment editable"},A.createElement(Dc,{focus:i.focus,content:e.value,editable:!0,placeholder:n.length>0?We.t("Add a reply..."):i.textPlaceHolder||We.t("Add a comment..."),onChange:r,onSaveAndClose:()=>i.onSaveAndClose()}),i.purposeSelector&&e.value.length>0&&A.createElement($h,{editable:!0,content:e.purpose,onChange:o,onSaveAndClose:()=>i.onSaveAndClose()})))};id.disableDelete=(i,t)=>i.bodies.filter(n=>td(n,t.purposeSelector)).some(n=>nd(n,t));var rd=id;function od(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,ir(i,t)}function m_(i,t){return i.classList?!!t&&i.classList.contains(t):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+t+" ")!==-1}function v_(i,t){i.classList?i.classList.add(t):m_(i,t)||(typeof i.className=="string"?i.className=i.className+" "+t:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+t))}function sd(i,t){return i.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function y_(i,t){i.classList?i.classList.remove(t):typeof i.className=="string"?i.className=sd(i.className,t):i.setAttribute("class",sd(i.className&&i.className.baseVal||"",t))}var ad={disabled:!1},ld=A.createContext(null),ud=function(t){return t.scrollTop},$n="unmounted",Xt="exited",Zt="entering",Sn="entered",bs="exiting",xt=function(i){od(t,i);function t(n,r){var o;o=i.call(this,n,r)||this;var l=r,s=l&&!l.isMounting?n.enter:n.appear,a;return o.appearStatus=null,n.in?s?(a=Xt,o.appearStatus=Zt):a=Sn:n.unmountOnExit||n.mountOnEnter?a=$n:a=Xt,o.state={status:a},o.nextCallback=null,o}t.getDerivedStateFromProps=function(r,o){var l=r.in;return l&&o.status===$n?{status:Xt}:null};var e=t.prototype;return e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},e.componentDidUpdate=function(r){var o=null;if(r!==this.props){var l=this.state.status;this.props.in?l!==Zt&&l!==Sn&&(o=Zt):(l===Zt||l===Sn)&&(o=bs)}this.updateStatus(!1,o)},e.componentWillUnmount=function(){this.cancelNextCallback()},e.getTimeouts=function(){var r=this.props.timeout,o,l,s;return o=l=s=r,r!=null&&typeof r!="number"&&(o=r.exit,l=r.enter,s=r.appear!==void 0?r.appear:l),{exit:o,enter:l,appear:s}},e.updateStatus=function(r,o){if(r===void 0&&(r=!1),o!==null)if(this.cancelNextCallback(),o===Zt){if(this.props.unmountOnExit||this.props.mountOnEnter){var l=this.props.nodeRef?this.props.nodeRef.current:A.findDOMNode(this);l&&ud(l)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Xt&&this.setState({status:$n})},e.performEnter=function(r){var o=this,l=this.props.enter,s=this.context?this.context.isMounting:r,a=this.props.nodeRef?[s]:[A.findDOMNode(this),s],u=a[0],c=a[1],h=this.getTimeouts(),d=s?h.appear:h.enter;if(!r&&!l||ad.disabled){this.safeSetState({status:Sn},function(){o.props.onEntered(u)});return}this.props.onEnter(u,c),this.safeSetState({status:Zt},function(){o.props.onEntering(u,c),o.onTransitionEnd(d,function(){o.safeSetState({status:Sn},function(){o.props.onEntered(u,c)})})})},e.performExit=function(){var r=this,o=this.props.exit,l=this.getTimeouts(),s=this.props.nodeRef?void 0:A.findDOMNode(this);if(!o||ad.disabled){this.safeSetState({status:Xt},function(){r.props.onExited(s)});return}this.props.onExit(s),this.safeSetState({status:bs},function(){r.props.onExiting(s),r.onTransitionEnd(l.exit,function(){r.safeSetState({status:Xt},function(){r.props.onExited(s)})})})},e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},e.safeSetState=function(r,o){o=this.setNextCallback(o),this.setState(r,o)},e.setNextCallback=function(r){var o=this,l=!0;return this.nextCallback=function(s){l&&(l=!1,o.nextCallback=null,r(s))},this.nextCallback.cancel=function(){l=!1},this.nextCallback},e.onTransitionEnd=function(r,o){this.setNextCallback(o);var l=this.props.nodeRef?this.props.nodeRef.current:A.findDOMNode(this),s=r==null&&!this.props.addEndListener;if(!l||s){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[l,this.nextCallback],u=a[0],c=a[1];this.props.addEndListener(u,c)}r!=null&&setTimeout(this.nextCallback,r)},e.render=function(){var r=this.state.status;if(r===$n)return null;var o=this.props,l=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var s=ss(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return A.createElement(ld.Provider,{value:null},typeof l=="function"?l(r,s):A.cloneElement(A.Children.only(l),s))},t}(A.Component);xt.contextType=ld,xt.propTypes={};function En(){}xt.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:En,onEntering:En,onEntered:En,onExit:En,onExiting:En,onExited:En},xt.UNMOUNTED=$n,xt.EXITED=Xt,xt.ENTERING=Zt,xt.ENTERED=Sn,xt.EXITING=bs;var w_=xt,b_=function(t,e){return t&&e&&e.split(" ").forEach(function(n){return v_(t,n)})},Ss=function(t,e){return t&&e&&e.split(" ").forEach(function(n){return y_(t,n)})},Es=function(i){od(t,i);function t(){for(var n,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return n=i.call.apply(i,[this].concat(o))||this,n.appliedClasses={appear:{},enter:{},exit:{}},n.onEnter=function(s,a){var u=n.resolveArguments(s,a),c=u[0],h=u[1];n.removeClasses(c,"exit"),n.addClass(c,h?"appear":"enter","base"),n.props.onEnter&&n.props.onEnter(s,a)},n.onEntering=function(s,a){var u=n.resolveArguments(s,a),c=u[0],h=u[1],d=h?"appear":"enter";n.addClass(c,d,"active"),n.props.onEntering&&n.props.onEntering(s,a)},n.onEntered=function(s,a){var u=n.resolveArguments(s,a),c=u[0],h=u[1],d=h?"appear":"enter";n.removeClasses(c,d),n.addClass(c,d,"done"),n.props.onEntered&&n.props.onEntered(s,a)},n.onExit=function(s){var a=n.resolveArguments(s),u=a[0];n.removeClasses(u,"appear"),n.removeClasses(u,"enter"),n.addClass(u,"exit","base"),n.props.onExit&&n.props.onExit(s)},n.onExiting=function(s){var a=n.resolveArguments(s),u=a[0];n.addClass(u,"exit","active"),n.props.onExiting&&n.props.onExiting(s)},n.onExited=function(s){var a=n.resolveArguments(s),u=a[0];n.removeClasses(u,"exit"),n.addClass(u,"exit","done"),n.props.onExited&&n.props.onExited(s)},n.resolveArguments=function(s,a){return n.props.nodeRef?[n.props.nodeRef.current,s]:[s,a]},n.getClassNames=function(s){var a=n.props.classNames,u=typeof a=="string",c=u&&a?a+"-":"",h=u?""+c+s:a[s],d=u?h+"-active":a[s+"Active"],p=u?h+"-done":a[s+"Done"];return{baseClassName:h,activeClassName:d,doneClassName:p}},n}var e=t.prototype;return e.addClass=function(r,o,l){var s=this.getClassNames(o)[l+"ClassName"],a=this.getClassNames("enter"),u=a.doneClassName;o==="appear"&&l==="done"&&u&&(s+=" "+u),l==="active"&&r&&ud(r),s&&(this.appliedClasses[o][l]=s,b_(r,s))},e.removeClasses=function(r,o){var l=this.appliedClasses[o],s=l.base,a=l.active,u=l.done;this.appliedClasses[o]={},s&&Ss(r,s),a&&Ss(r,a),u&&Ss(r,u)},e.render=function(){var r=this.props;r.classNames;var o=ss(r,["classNames"]);return A.createElement(w_,K({},o,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(A.Component);Es.defaultProps={classNames:""},Es.propTypes={};var cd=Es;const S_=(i,t)=>t.filter(e=>(e.label?e.label:e).toLowerCase().startsWith(i.toLowerCase())),E_=(i,t)=>t(i);var hd=i=>{const t=ut(),[e,n]=rt(i.initialValue||""),[r,o]=rt([]),[l,s]=rt(null);At(()=>{i.focus&&t.current.querySelector("input").focus({preventScroll:!0})},[]),At(()=>{i.onChange&&i.onChange(e)},[e]);const a=d=>{if(typeof i.vocabulary=="function"){const p=E_(d,i.vocabulary);p.then?p.then(o):o(p)}else{const p=S_(d,i.vocabulary);o(p)}},u=()=>{if(l!==null)i.onSubmit(r[l]);else{const d=e.trim();if(d){const p=Array.isArray(i.vocabulary)?i.vocabulary.find(m=>(m.label||m).toLowerCase()===d.toLowerCase()):null;p?i.onSubmit(p):i.onSubmit(d)}}n(""),o([]),s(null)},c=d=>{if(d.which===13)u();else if(d.which===27)i.onCancel&&i.onCancel();else if(r.length>0){if(d.which===38)if(l===null)s(0);else{const p=Math.max(0,l-1);s(p)}else if(d.which===40)if(l===null)s(0);else{const p=Math.min(r.length-1,l+1);s(p)}}else d.which===40&&Array.isArray(i.vocabulary)&&o(i.vocabulary)},h=d=>{const{value:p}=d.target;n(p),s(null),p?a(p):o([])};return A.createElement("div",{ref:t,className:"r6o-autocomplete"},A.createElement("div",null,A.createElement("input",{onKeyDown:c,onChange:h,value:e,placeholder:i.placeholder})),A.createElement("ul",null,r.length>0&&r.map((d,p)=>A.createElement("li",{key:`${d.label?d.label:d}${p}`,onClick:u,onMouseEnter:()=>s(p),style:l===p?{backgroundColor:"#bde4ff"}:{}},d.label?d.label:d))))};const __=i=>i||{type:"TextualBody",value:"",purpose:"tagging",draft:!0};var dd=i=>{const t=i.annotation?i.annotation.bodies.filter(h=>h.purpose==="tagging"):[],e=__(t.slice().reverse().find(h=>h.draft)),n=t.filter(h=>h!=e),[r,o]=rt(!1),l=h=>d=>{o(r===h?!1:h)},s=h=>{const d=e.value.trim(),p=h.trim();d.length===0&&p.length>0?i.onAppendBody({...e,value:p}):d.length>0&&p.length===0?i.onRemoveBody(e):d!==p&&i.onUpdateBody(e,{...e,value:p})},a=h=>d=>{d.stopPropagation(),i.onRemoveBody(h)},u=h=>{const d=h.uri?{type:"SpecificResource",purpose:"tagging",source:{id:h.uri,label:h.label}}:{type:"TextualBody",purpose:"tagging",value:h.label||h};e.value.trim().length===0?i.onAppendBody(d):i.onUpdateBody(e,d)},c=h=>h.value||h.source.label;return A.createElement("div",{className:"r6o-widget r6o-tag"},n.length>0&&A.createElement("ul",{className:"r6o-taglist"},n.map(h=>A.createElement("li",{key:c(h),onClick:l(h)},A.createElement("span",{className:"r6o-label"},c(h)),!i.readOnly&&A.createElement(cd,{in:r===h,timeout:200,classNames:"r6o-delete"},A.createElement("span",{className:"r6o-delete-wrapper",onClick:a(h)},A.createElement("span",{className:"r6o-delete"},A.createElement(ed,{width:12}))))))),!i.readOnly&&A.createElement(hd,{focus:i.focus,placeholder:i.textPlaceHolder||We.t("Add tag..."),vocabulary:i.vocabulary||[],onChange:s,onSubmit:u}))};const x_=i=>i||{type:"TextualBody",value:"",purpose:"type",draft:!0};var fd=i=>{const t=i.annotation?i.annotation.bodies.filter(h=>h.purpose==="type"):[],e=x_(t.slice().reverse().find(h=>h.draft)),n=t.filter(h=>h!=e),[r,o]=rt(!1),l=h=>d=>{o(r===h?!1:h)},s=h=>{const d=e.value.trim(),p=h.trim();d.length===0&&p.length>0?i.onAppendBody({...e,value:p}):d.length>0&&p.length===0?i.onRemoveBody(e):d!==p&&i.onUpdateBody(e,{...e,value:p})},a=h=>d=>{d.stopPropagation(),i.onRemoveBody(h)},u=h=>{const d=h.uri?{type:"SpecificResource",purpose:"type",source:{id:h.uri,label:h.label}}:{type:"TextualBody",purpose:"type",value:h.label||h};e.value.trim().length===0?i.onAppendBody(d):i.onUpdateBody(e,d)},c=h=>h.value||h.source.label;return A.createElement("div",{className:"r6o-widget r6o-tag"},n.length>0&&A.createElement("ul",{className:"r6o-taglist"},n.map(h=>A.createElement("li",{key:c(h),onClick:l(h)},A.createElement("span",{className:"r6o-label"},c(h)),!i.readOnly&&A.createElement(cd,{in:r===h,timeout:200,classNames:"r6o-delete"},A.createElement("span",{className:"r6o-delete-wrapper",onClick:a(h)},A.createElement("span",{className:"r6o-delete"},A.createElement(ed,{width:12}))))))),!i.readOnly&&A.createElement(hd,{focus:i.focus,placeholder:i.textPlaceHolder||We.t("Add type..."),vocabulary:i.vocabulary||[],onChange:s,onSubmit:u}))};class pd extends Te{constructor(t){super(t),this.element=A.createRef()}renderWidget(t){const e=this.props.widget({annotation:t.annotation,readOnly:t.readOnly,...t.config,onAppendBody:(n,r)=>t.onAppendBody(n,r),onUpdateBody:(n,r,o)=>t.onUpdateBody(n,r,o),onUpsertBody:(n,r,o)=>t.onUpsertBody(n,r,o),onRemoveBody:(n,r)=>t.onRemoveBody(n,r),onBatchModify:(n,r)=>t.onBatchModify(n,r),onSetProperty:(n,r)=>t.onSetProperty(n,r),onAddContext:n=>t.onAddContext(n),onSaveAndClose:()=>t.onSaveAndClose()});for(;this.element.current.firstChild;)this.element.current.removeChild(this.element.current.lastChild);this.element.current.appendChild(e)}componentDidMount(){this.renderWidget(this.props)}componentWillReceiveProps(t){this.element.current&&this.props.annotation!==t.annotation&&this.renderWidget(t)}render(){return A.createElement("div",{ref:this.element,className:"widget"})}}window.React=A,window.ReactDOM=A;const T_={COMMENT:rd,TAG:dd,TYPE:fd},C_=[A.createElement(rd,null),A.createElement(dd,null),A.createElement(fd,null)],P_=i=>{const t=n=>{var r;return typeof n=="function"&&!!((r=n.prototype)!=null&&r.isReactComponent)},e=n=>typeof n=="function"&&(String(n).match(/return .+\(['|"].+['|"],\s*\{/g)||String(n).match(/return .+preact_compat/)||String(n).match(/return .+\.createElement/g));return t(i)||e(i)},A_=i=>{const t=(e,n,r)=>{if(typeof e=="string"||e instanceof String)return A.createElement(T_[e],n);if((r==null?void 0:r.toLowerCase())==="react")return A.createElement(e,n);if((r==null?void 0:r.toLowerCase())==="plainjs")return A.createElement(pd,{widget:e,config:n});if(P_(e))return A.createElement(e,n);if(typeof e=="function"||e instanceof Function)return A.createElement(pd,{widget:e,config:n});throw`${e} is not a valid plugin`};if(i.widget){const{widget:e,force:n,...r}=i;return t(e,r,n)}else return t(i)},gd=14;var md=(i,t,e,n)=>{const r=i.getBoundingClientRect();t.className="r6o-editor r6o-arrow-top r6o-arrow-left";const{left:o,top:l,right:s,bottom:a}=e.getBoundingClientRect();if(t.style.top=`${a-r.top+gd}px`,t.style.left=`${o-r.left}px`,n){const u=t.children[1].getBoundingClientRect(),{innerWidth:c,innerHeight:h}=i.ownerDocument.defaultView;if(u.right>c&&(t.classList.remove("r6o-arrow-left"),t.classList.add("r6o-arrow-right"),t.style.left=`${s-u.width-r.left}px`),u.bottom>h){t.classList.remove("r6o-arrow-top"),t.classList.add("r6o-arrow-bottom");const p=t.children[1].getBoundingClientRect().height;t.style.top=`${l-r.top-p-gd}px`}const d=t.children[1].getBoundingClientRect();if(d.top<0){t.classList.add("pushed","down"),t.style.top=`${-r.top}px`;const p=a-r.top;d.height-r.top>p&&t.classList.remove("r6o-arrow-bottom")}d.left<0&&(t.classList.add("pushed","right"),t.style.left=`${-r.left}px`),requestAnimationFrame(()=>t.style.opacity=1)}};const vd=i=>{const{top:t,left:e,width:n,height:r}=i.getBoundingClientRect();return`${t}, ${e}, ${n}, ${r}`};class O_ extends Te{constructor(e){super(e);x(this,"initResizeObserver",()=>{const e=this.props.autoPosition===void 0?!0:this.props.autoPosition;if(window!=null&&window.ResizeObserver){const n=new ResizeObserver(()=>{this.state.dragged||md(this.props.wrapperEl,this.element.current,this.props.selectedElement,e)});return n.observe(this.props.wrapperEl),()=>n.disconnect()}else this.state.dragged||md(this.props.wrapperEl,this.element.current,this.props.selectedElement,e)});x(this,"creationMeta",e=>{const n={},{user:r}=this.props.env;return r&&(n.creator={},r.id&&(n.creator.id=r.id),r.displayName&&(n.creator.name=r.displayName),n[e.created?"modified":"created"]=this.props.env.getCurrentTimeAdjusted()),n});x(this,"getCurrentAnnotation",()=>this.state.currentAnnotation.clone());x(this,"hasChanges",()=>{var e;return!((e=this.props.annotation)!=null&&e.isEqual(this.state.currentAnnotation))});x(this,"updateCurrentAnnotation",(e,n)=>{this.setState({currentAnnotation:this.state.currentAnnotation.clone(e)},()=>{n?this.onOk():this.props.onChanged&&this.props.onChanged()})});x(this,"onAppendBody",(e,n)=>this.updateCurrentAnnotation({body:[...this.state.currentAnnotation.bodies,{...e,...this.creationMeta(e)}]},n));x(this,"onUpdateBody",(e,n,r)=>this.updateCurrentAnnotation({body:this.state.currentAnnotation.bodies.map(o=>o===e?{...n,...this.creationMeta(n)}:o)},r));x(this,"onRemoveBody",(e,n)=>this.updateCurrentAnnotation({body:this.state.currentAnnotation.bodies.filter(r=>r!==e)},n));x(this,"onUpsertBody",(e,n,r)=>{if(e==null&&n!=null)this.onAppendBody(n,r);else if(e!=null&&n!=null)this.onUpdateBody(e,n,r);else if(e!=null&&n==null){const o=this.state.currentAnnotation.bodies.find(l=>l.purpose===e.purpose);o?this.onUpdateBody(o,e,r):this.onAppendBody(e,r)}});x(this,"onBatchModify",(e,n)=>{const r=e.filter(u=>u.action==="upsert"&&u.body).map(u=>({previous:this.state.currentAnnotation.bodies.find(c=>c.purpose===u.body.purpose),updated:{...u.body,...this.creationMeta(u.body)}})),o=e.filter(u=>u.action==="remove").map(u=>u.body),l=[...e.filter(u=>u.action==="append"||u.action==="upsert"&&u.updated&&!u.previous).map(u=>({...u.body,...this.creationMeta(u.body)})),...r.filter(u=>!u.previous).map(u=>u.updated)],s=[...e.filter(u=>u.action==="update"||u.action==="upsert"&&u.updated&&u.previous).map(u=>({previous:u.previous,updated:{...u.updated,...this.creationMeta(u.updated)}})),...r.filter(u=>u.previous)],a=[...this.state.currentAnnotation.bodies.filter(u=>!o.includes(u)).map(u=>{const c=s.find(h=>h.previous===u);return c?c.updated:u}),...l];this.updateCurrentAnnotation({body:a},n)});x(this,"onSetProperty",(e,n)=>{if(["@context","id","type","body","target"].includes(e))throw new Exception(`Cannot set ${e} - not allowed`);if(n)this.updateCurrentAnnotation({[e]:n});else{const o=this.currentAnnotation.clone();delete o[e],this.setState({currentAnnotation:o})}});x(this,"onAddContext",e=>{const{currentAnnotation:n}=this.state,r=Array.isArray(n.context)?n.context:[n.context];r.indexOf(e)<0&&(r.push(e),this.updateCurrentAnnotation({"@context":r}))});x(this,"onCancel",()=>this.props.onCancel(this.props.annotation));x(this,"onOk",()=>{const e=r=>r.clone({body:r.bodies.map(({draft:o,...l})=>l)}),{currentAnnotation:n}=this.state;n.bodies.length===0&&!this.props.allowEmpty?n.isSelection?this.onCancel():this.props.onAnnotationDeleted(this.props.annotation):n.isSelection?this.props.onAnnotationCreated(e(n).toAnnotation()):this.props.onAnnotationUpdated(e(n),this.props.annotation)});x(this,"onDelete",()=>this.props.onAnnotationDeleted(this.props.annotation));this.element=A.createRef(),this.state={currentAnnotation:e.annotation,dragged:!1,selectionBounds:vd(e.selectedElement)}}componentWillReceiveProps(e){var o;const{selectionBounds:n}=this.state,r=vd(e.selectedElement);(o=this.props.annotation)!=null&&o.isEqual(e.annotation)?this.setState({selectionBounds:r}):this.setState({currentAnnotation:e.annotation,selectionBounds:r}),this.props.modifiedTarget!=e.modifiedTarget&&this.state.currentAnnotation&&this.updateCurrentAnnotation({target:this.props.modifiedTarget}),n!=r&&this.element.current&&(this.removeObserver&&this.removeObserver(),this.removeObserver=this.initResizeObserver())}componentDidMount(){this.removeObserver=this.initResizeObserver(),new MutationObserver(()=>{this.element.current&&(this.removeObserver&&this.removeObserver(),this.removeObserver=this.initResizeObserver())}).observe(this.element.current,{childList:!0,subtree:!0})}componentWillUnmount(){this.removeObserver&&this.removeObserver()}render(){const{currentAnnotation:e}=this.state,n=this.props.widgets?this.props.widgets.map(A_):C_,r=l=>l.type.disableDelete?l.type.disableDelete(e,{...l.props,readOnly:this.props.readOnly,env:this.props.env}):!1,o=e&&(e.bodies.length>0||this.props.allowEmpty)&&!this.props.readOnly&&!e.isSelection&&!n.some(r);return A.createElement(pp,{disabled:!this.props.detachable,handle:".r6o-draggable",cancel:".r6o-btn, .r6o-btn *",onDrag:()=>this.setState({dragged:!0})},A.createElement("div",{ref:this.element,className:this.state.dragged?"r6o-editor dragged":"r6o-editor"},A.createElement("div",{className:"r6o-arrow"}),A.createElement("div",{className:"r6o-editor-inner"},n.map((l,s)=>A.cloneElement(l,{key:`${s}`,focus:s===0,annotation:e,readOnly:this.props.readOnly,env:this.props.env,onAppendBody:this.onAppendBody,onUpdateBody:this.onUpdateBody,onRemoveBody:this.onRemoveBody,onUpsertBody:this.onUpsertBody,onBatchModify:this.onBatchModify,onSetProperty:this.onSetProperty,onAddContext:this.onAddContext,onSaveAndClose:this.onOk})),this.props.readOnly?A.createElement("div",{className:"r6o-footer"},A.createElement("button",{className:"r6o-btn",onClick:this.onCancel},We.t("Close"))):A.createElement("div",{className:this.props.detachable?"r6o-footer r6o-draggable":"r6o-footer"},o&&A.createElement("button",{className:"r6o-btn left delete-annotation",title:We.t("Delete"),onClick:this.onDelete},A.createElement(d_,{width:12})),A.createElement("button",{className:"r6o-btn outline",onClick:this.onCancel},We.t("Cancel")),A.createElement("button",{className:"r6o-btn ",onClick:this.onOk},We.t("Ok"))))))}}var dr,R_=new Uint8Array(16);function D_(){if(!dr&&(dr=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!dr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return dr(R_)}var M_=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function I_(i){return typeof i=="string"&&M_.test(i)}for(var Be=[],_s=0;_s<256;++_s)Be.push((_s+256).toString(16).substr(1));function F_(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(Be[i[t+0]]+Be[i[t+1]]+Be[i[t+2]]+Be[i[t+3]]+"-"+Be[i[t+4]]+Be[i[t+5]]+"-"+Be[i[t+6]]+Be[i[t+7]]+"-"+Be[i[t+8]]+Be[i[t+9]]+"-"+Be[i[t+10]]+Be[i[t+11]]+Be[i[t+12]]+Be[i[t+13]]+Be[i[t+14]]+Be[i[t+15]]).toLowerCase();if(!I_(e))throw TypeError("Stringified UUID is invalid");return e}function yd(i,t,e){i=i||{};var n=i.random||(i.rng||D_)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){e=e||0;for(var r=0;r<16;++r)t[e+r]=n[r];return t}return F_(n)}var k_=function i(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,r,o;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!i(t[r],e[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){var l=o[r];if(!i(t[l],e[l]))return!1}return!0}return t!==t&&e!==e},wd=k_;const _r=class{constructor(t,e){x(this,"clone",(t,e)=>new _r({...this.underlying,...t},{...this.opts,...e}));x(this,"selector",t=>{const{target:e}=this.underlying;if(e.selector)return(Array.isArray(e.selector)?e.selector:[e.selector]).find(r=>r.type===t)});this.underlying=t,this.opts=e}isEqual(t){return(t==null?void 0:t.type)!=="Annotation"?!1:this.underlying===t.underlying?!0:!this.underlying.id||!t.underlying.id?!1:wd(this.underlying,t.underlying)}get readOnly(){var t;return(t=this.opts)==null?void 0:t.readOnly}get id(){return this.underlying.id}get context(){return this.underlying["@context"]}get type(){return this.underlying.type}get motivation(){return this.underlying.motivation}get body(){return this.underlying.body}get target(){return this.underlying.target}get bodies(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}set bodies(t){this.underlying.body=t}get targets(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}get quote(){var t;return(t=this.selector("TextQuoteSelector"))==null?void 0:t.exact}get start(){var t;return(t=this.selector("TextPositionSelector"))==null?void 0:t.start}get end(){var t;return(t=this.selector("TextPositionSelector"))==null?void 0:t.end}};let Tt=_r;x(Tt,"create",t=>{const e={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:`#${yd()}`,body:[]};return new _r({...e,...t})});class ei{constructor(t,e){x(this,"clone",t=>{const e=new ei;return e.underlying=JSON.parse(JSON.stringify(this.underlying)),t&&(e.underlying={...e.underlying,...t}),e});x(this,"selector",t=>{const{target:e}=this.underlying;if(e.selector)return(Array.isArray(e.selector)?e.selector:[e.selector]).find(r=>r.type===t)});x(this,"toAnnotation",()=>{const t=Object.assign({},this.underlying,{type:"Annotation",id:`#${yd()}`});return new Tt(t)});this.underlying={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Selection",body:e||[],target:t}}get context(){return this.underlying["@context"]}get type(){return this.underlying.type}get body(){return this.underlying.body}get target(){return this.underlying.target}get targets(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}isEqual(t){return t?wd(this.underlying,t.underlying):!1}get bodies(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}get quote(){var t;return(t=this.selector("TextQuoteSelector"))==null?void 0:t.exact}get isSelection(){return!0}}let xs=0;var L_=()=>({setServerTime:i=>{const t=Date.now();xs=i-t},getCurrentTimeAdjusted:()=>new Date(Date.now()+xs).toISOString(),toClientTime:i=>Date.parse(i)-xs});const B_=(i,t)=>{if(i){const e=i==="auto"?window.navigator.userLanguage||window.navigator.language:i,n=e.split("-")[0].toLowerCase(),r=[e,n].find(o=>Yw.includes(o));r||console.warn(`Unsupported locale '${e}'. Falling back to default en.`),We.init(r,t)}else We.init(null,t)};var bd={exports:{}};(function(i){//! openseadragon 4.1.0
//! Built on 2023-05-25
//! Git commit: v4.1.0-0-8849681
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function t(e){return new t.Viewer(e)}(function(e){e.version={versionStr:"4.1.0",major:parseInt("4",10),minor:parseInt("1",10),revision:parseInt("0",10)};var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},r=Object.prototype.toString,o=Object.prototype.hasOwnProperty;e.isFunction=function(l){return e.type(l)==="function"},e.isArray=Array.isArray||function(l){return e.type(l)==="array"},e.isWindow=function(l){return l&&typeof l=="object"&&"setInterval"in l},e.type=function(l){return l==null?String(l):n[r.call(l)]||"object"},e.isPlainObject=function(l){if(!l||t.type(l)!=="object"||l.nodeType||e.isWindow(l)||l.constructor&&!o.call(l,"constructor")&&!o.call(l.constructor.prototype,"isPrototypeOf"))return!1;var s;for(var a in l)s=a;return s===void 0||o.call(l,s)},e.isEmptyObject=function(l){for(var s in l)return!1;return!0},e.freezeObject=function(l){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(s){return s},e.freezeObject(l)},e.supportsCanvas=function(){var l=document.createElement("canvas");return!!(e.isFunction(l.getContext)&&l.getContext("2d"))}(),e.isCanvasTainted=function(l){var s=!1;try{l.getContext("2d").getImageData(0,0,1,1)}catch{s=!0}return s},e.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),e.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),e.supportsEventListenerOptions=function(){var l=0;if(e.supportsAddEventListener)try{var s={get capture(){return l++,!1},get once(){return l++,!1},get passive(){return l++,!1}};window.addEventListener("test",null,s),window.removeEventListener("test",null,s)}catch{l=0}return l>=3}(),e.getCurrentPixelDensityRatio=function(){if(e.supportsCanvas){var l=document.createElement("canvas").getContext("2d"),s=window.devicePixelRatio||1,a=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1;return Math.max(s,1)/a}else return 1},e.pixelDensityRatio=e.getCurrentPixelDensityRatio()})(t),function(e){e.extend=function(){var a,u,c,h,d,p,m=arguments[0]||{},w=arguments.length,y=!1,E=1;for(typeof m=="boolean"&&(y=m,m=arguments[1]||{},E=2),typeof m!="object"&&!t.isFunction(m)&&(m={}),w===E&&(m=this,--E);E<w;E++)if(a=arguments[E],a!==null||a!==void 0)for(u in a){var T=Object.getOwnPropertyDescriptor(a,u);if(T!==void 0){if(T.get||T.set){Object.defineProperty(m,u,T);continue}h=T.value}else{e.console.warn('Could not copy inherited property "'+u+'".');continue}m!==h&&(y&&h&&(t.isPlainObject(h)||(d=t.isArray(h)))?(c=m[u],d?(d=!1,p=c&&t.isArray(c)?c:[]):p=c&&t.isPlainObject(c)?c:{},m[u]=t.extend(y,p,h)):h!==void 0&&(m[u]=h))}return m};var n=function(){if(typeof navigator!="object")return!1;var a=navigator.userAgent;return typeof a!="string"?!1:a.indexOf("iPhone")!==-1||a.indexOf("iPad")!==-1||a.indexOf("iPod")!==-1};e.extend(e,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:n(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(a,u){return function(){var c=arguments;return c===void 0&&(c=[]),u.apply(a,c)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(a){return e._viewers.get(this.getElement(a))},getElement:function(a){return typeof a=="string"&&(a=document.getElementById(a)),a},getElementPosition:function(a){var u=new e.Point,c,h;for(a=e.getElement(a),c=e.getElementStyle(a).position==="fixed",h=s(a,c);h;)u.x+=a.offsetLeft,u.y+=a.offsetTop,c&&(u=u.plus(e.getPageScroll())),a=h,c=e.getElementStyle(a).position==="fixed",h=s(a,c);return u},getElementOffset:function(a){a=e.getElement(a);var u=a&&a.ownerDocument,c,h,d={top:0,left:0};return u?(c=u.documentElement,typeof a.getBoundingClientRect!="undefined"&&(d=a.getBoundingClientRect()),h=u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1,new e.Point(d.left+(h.pageXOffset||c.scrollLeft)-(c.clientLeft||0),d.top+(h.pageYOffset||c.scrollTop)-(c.clientTop||0))):new e.Point},getElementSize:function(a){return a=e.getElement(a),new e.Point(a.clientWidth,a.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(a){return a=e.getElement(a),a.currentStyle}:function(a){return a=e.getElement(a),window.getComputedStyle(a,"")},getCssPropertyWithVendorPrefix:function(a){var u={};return e.getCssPropertyWithVendorPrefix=function(c){if(u[c]!==void 0)return u[c];var h=document.createElement("div").style,d=null;if(h[c]!==void 0)d=c;else for(var p=["Webkit","Moz","MS","O","webkit","moz","ms","o"],m=e.capitalizeFirstLetter(c),w=0;w<p.length;w++){var y=p[w]+m;if(h[y]!==void 0){d=y;break}}return u[c]=d,d},e.getCssPropertyWithVendorPrefix(a)},capitalizeFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},positiveModulo:function(a,u){var c=a%u;return c<0&&(c+=u),c},pointInElement:function(a,u){a=e.getElement(a);var c=e.getElementOffset(a),h=e.getElementSize(a);return u.x>=c.x&&u.x<c.x+h.x&&u.y<c.y+h.y&&u.y>=c.y},getMousePosition:function(a){if(typeof a.pageX=="number")e.getMousePosition=function(u){var c=new e.Point;return c.x=u.pageX,c.y=u.pageY,c};else if(typeof a.clientX=="number")e.getMousePosition=function(u){var c=new e.Point;return c.x=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c.y=u.clientY+document.body.scrollTop+document.documentElement.scrollTop,c};else throw new Error("Unknown event mouse position, no known technique.");return e.getMousePosition(a)},getPageScroll:function(){var a=document.documentElement||{},u=document.body||{};if(typeof window.pageXOffset=="number")e.getPageScroll=function(){return new e.Point(window.pageXOffset,window.pageYOffset)};else if(u.scrollLeft||u.scrollTop)e.getPageScroll=function(){return new e.Point(document.body.scrollLeft,document.body.scrollTop)};else if(a.scrollLeft||a.scrollTop)e.getPageScroll=function(){return new e.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new e.Point(0,0);return e.getPageScroll()},setPageScroll:function(a){if(typeof window.scrollTo!="undefined")e.setPageScroll=function(h){window.scrollTo(h.x,h.y)};else{var u=e.getPageScroll();if(u.x===a.x&&u.y===a.y)return;document.body.scrollLeft=a.x,document.body.scrollTop=a.y;var c=e.getPageScroll();if(c.x!==u.x&&c.y!==u.y){e.setPageScroll=function(h){document.body.scrollLeft=h.x,document.body.scrollTop=h.y};return}if(document.documentElement.scrollLeft=a.x,document.documentElement.scrollTop=a.y,c=e.getPageScroll(),c.x!==u.x&&c.y!==u.y){e.setPageScroll=function(h){document.documentElement.scrollLeft=h.x,document.documentElement.scrollTop=h.y};return}e.setPageScroll=function(h){}}e.setPageScroll(a)},getWindowSize:function(){var a=document.documentElement||{},u=document.body||{};if(typeof window.innerWidth=="number")e.getWindowSize=function(){return new e.Point(window.innerWidth,window.innerHeight)};else if(a.clientWidth||a.clientHeight)e.getWindowSize=function(){return new e.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(u.clientWidth||u.clientHeight)e.getWindowSize=function(){return new e.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return e.getWindowSize()},makeCenteredNode:function(a){a=e.getElement(a);var u=[e.makeNeutralElement("div"),e.makeNeutralElement("div"),e.makeNeutralElement("div")];return e.extend(u[0].style,{display:"table",height:"100%",width:"100%"}),e.extend(u[1].style,{display:"table-row"}),e.extend(u[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),u[0].appendChild(u[1]),u[1].appendChild(u[2]),u[2].appendChild(a),u[0]},makeNeutralElement:function(a){var u=document.createElement(a),c=u.style;return c.background="transparent none",c.border="none",c.margin="0px",c.padding="0px",c.position="static",u},now:function(){return Date.now?e.now=Date.now:e.now=function(){return new Date().getTime()},e.now()},makeTransparentImage:function(a){var u=e.makeNeutralElement("img");return u.src=a,u},setElementOpacity:function(a,u,c){var h,d;a=e.getElement(a),c&&!e.Browser.alpha&&(u=Math.round(u)),e.Browser.opacity?a.style.opacity=u<1?u:"":u<1?(h=Math.round(100*u),d="alpha(opacity="+h+")",a.style.filter=d):a.style.filter=""},setElementTouchActionNone:function(a){a=e.getElement(a),typeof a.style.touchAction!="undefined"?a.style.touchAction="none":typeof a.style.msTouchAction!="undefined"&&(a.style.msTouchAction="none")},setElementPointerEvents:function(a,u){a=e.getElement(a),typeof a.style!="undefined"&&typeof a.style.pointerEvents!="undefined"&&(a.style.pointerEvents=u)},setElementPointerEventsNone:function(a){e.setElementPointerEvents(a,"none")},addClass:function(a,u){a=e.getElement(a),a.className?(" "+a.className+" ").indexOf(" "+u+" ")===-1&&(a.className+=" "+u):a.className=u},indexOf:function(a,u,c){return Array.prototype.indexOf?this.indexOf=function(h,d,p){return h.indexOf(d,p)}:this.indexOf=function(h,d,p){var m,w=p||0,y;if(!h)throw new TypeError;if(y=h.length,y===0||w>=y)return-1;for(w<0&&(w=y-Math.abs(w)),m=w;m<y;m++)if(h[m]===d)return m;return-1},this.indexOf(a,u,c)},removeClass:function(a,u){var c,h=[],d;for(a=e.getElement(a),c=a.className.split(/\s+/),d=0;d<c.length;d++)c[d]&&c[d]!==u&&h.push(c[d]);a.className=h.join(" ")},normalizeEventListenerOptions:function(a){var u;return typeof a!="undefined"?typeof a=="boolean"?u=e.supportsEventListenerOptions?{capture:a}:a:u=e.supportsEventListenerOptions?a:typeof a.capture!="undefined"?a.capture:!1:u=e.supportsEventListenerOptions?{capture:!1}:!1,u},addEvent:function(){if(e.supportsAddEventListener)return function(a,u,c,h){h=e.normalizeEventListenerOptions(h),a=e.getElement(a),a.addEventListener(u,c,h)};if(document.documentElement.attachEvent&&document.attachEvent)return function(a,u,c){a=e.getElement(a),a.attachEvent("on"+u,c)};throw new Error("No known event model.")}(),removeEvent:function(){if(e.supportsRemoveEventListener)return function(a,u,c,h){h=e.normalizeEventListenerOptions(h),a=e.getElement(a),a.removeEventListener(u,c,h)};if(document.documentElement.detachEvent&&document.detachEvent)return function(a,u,c){a=e.getElement(a),a.detachEvent("on"+u,c)};throw new Error("No known event model.")}(),cancelEvent:function(a){a.preventDefault()},eventIsCanceled:function(a){return a.defaultPrevented},stopEvent:function(a){a.stopPropagation()},createCallback:function(a,u){var c=[],h;for(h=2;h<arguments.length;h++)c.push(arguments[h]);return function(){var d=c.concat([]),p;for(p=0;p<arguments.length;p++)d.push(arguments[p]);return u.apply(a,d)}},getUrlParameter:function(a){var u=l[a];return u||null},getUrlProtocol:function(a){var u=a.match(/^([a-z]+:)\/\//i);return u===null?window.location.protocol:u[1].toLowerCase()},createAjaxRequest:function(a){var u;try{u=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{u=!1}if(u)window.XMLHttpRequest?e.createAjaxRequest=function(c){return c?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:e.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)e.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return e.createAjaxRequest(a)},makeAjaxRequest:function(a,u,c){var h,d,p,m;e.isPlainObject(a)&&(u=a.success,c=a.error,h=a.withCredentials,d=a.headers,p=a.responseType||null,m=a.postData||null,a=a.url);var w=e.getUrlProtocol(a),y=e.createAjaxRequest(w==="file:");if(!e.isFunction(u))throw new Error("makeAjaxRequest requires a success callback");y.onreadystatechange=function(){y.readyState===4&&(y.onreadystatechange=function(){},y.status>=200&&y.status<300||y.status===0&&w!=="http:"&&w!=="https:"?u(y):e.isFunction(c)?c(y):e.console.error("AJAX request returned %d: %s",y.status,a))};var E=m?"POST":"GET";try{if(y.open(E,a,!0),p&&(y.responseType=p),d)for(var T in d)Object.prototype.hasOwnProperty.call(d,T)&&d[T]&&y.setRequestHeader(T,d[T]);h&&(y.withCredentials=!0),y.send(m)}catch(C){e.console.error("%s while making AJAX request: %s",C.name,C.message),y.onreadystatechange=function(){},e.isFunction(c)&&c(y,C)}return y},jsonp:function(a){var u,c=a.url,h=document.head||document.getElementsByTagName("head")[0]||document.documentElement,d=a.callbackName||"openseadragon"+e.now(),p=window[d],m="$1"+d+"$2",w=a.param||"callback",y=a.callback;c=c.replace(/(=)\?(&|$)|\?\?/i,m),c+=(/\?/.test(c)?"&":"?")+w+"="+d,window[d]=function(E){if(p)window[d]=p;else try{delete window[d]}catch{}y&&e.isFunction(y)&&y(E)},u=document.createElement("script"),(a.async!==void 0||a.async!==!1)&&(u.async="async"),a.scriptCharset&&(u.charset=a.scriptCharset),u.src=c,u.onload=u.onreadystatechange=function(E,T){(T||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,h&&u.parentNode&&h.removeChild(u),u=void 0)},h.insertBefore(u,h.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(a){if(window.DOMParser)e.parseXml=function(u){var c=null,h;return h=new DOMParser,c=h.parseFromString(u,"text/xml"),c};else if(window.ActiveXObject)e.parseXml=function(u){var c=null;return c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(u),c};else throw new Error("Browser doesn't support XML DOM.");return e.parseXml(a)},parseJSON:function(a){return e.parseJSON=window.JSON.parse,e.parseJSON(a)},imageFormatSupported:function(a){return a=a||"",!!o[a.toLowerCase()]},setImageFormatsSupported:function(a){e.extend(o,a)}});var r=function(a){};e.console=window.console||{log:r,debug:r,info:r,warn:r,error:r,assert:r},e.Browser={vendor:e.BROWSERS.UNKNOWN,version:0,alpha:!0};var o={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},l={};(function(){var a=navigator.appVersion,u=navigator.userAgent,c;switch(navigator.appName){case"Microsoft Internet Explorer":!!window.attachEvent&&!!window.ActiveXObject&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(u.substring(u.indexOf("MSIE")+5,u.indexOf(";",u.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(u.indexOf("Edge")>=0?(e.Browser.vendor=e.BROWSERS.EDGE,e.Browser.version=parseFloat(u.substring(u.indexOf("Edge")+5))):u.indexOf("Edg")>=0?(e.Browser.vendor=e.BROWSERS.CHROMEEDGE,e.Browser.version=parseFloat(u.substring(u.indexOf("Edg")+4))):u.indexOf("Firefox")>=0?(e.Browser.vendor=e.BROWSERS.FIREFOX,e.Browser.version=parseFloat(u.substring(u.indexOf("Firefox")+8))):u.indexOf("Safari")>=0?(e.Browser.vendor=u.indexOf("Chrome")>=0?e.BROWSERS.CHROME:e.BROWSERS.SAFARI,e.Browser.version=parseFloat(u.substring(u.substring(0,u.indexOf("Safari")).lastIndexOf("/")+1,u.indexOf("Safari")))):(c=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),c.exec(u)!==null&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":e.Browser.vendor=e.BROWSERS.OPERA,e.Browser.version=parseFloat(a);break}var h=window.location.search.substring(1),d=h.split("&"),p,m,w;for(w=0;w<d.length;w++)if(p=d[w],m=p.indexOf("="),m>0){var y=p.substring(0,m),E=p.substring(m+1);try{l[y]=decodeURIComponent(E)}catch{e.console.error("Ignoring malformed URL parameter: %s=%s",y,E)}}e.Browser.alpha=!(e.Browser.vendor===e.BROWSERS.CHROME&&e.Browser.version<2),e.Browser.opacity=!0,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<11&&e.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(a){var u=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,c=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame;if(u&&c)e.requestAnimationFrame=function(){return u.apply(a,arguments)},e.cancelAnimationFrame=function(){return c.apply(a,arguments)};else{var h=[],d=[],p=0,m;e.requestAnimationFrame=function(w){return h.push([++p,w]),m||(m=setInterval(function(){if(h.length){var y=e.now(),E=d;for(d=h,h=E;d.length;)d.shift()[1](y)}else clearInterval(m),m=void 0},1e3/50)),p},e.cancelAnimationFrame=function(w){var y,E;for(y=0,E=h.length;y<E;y+=1)if(h[y][0]===w){h.splice(y,1);return}for(y=0,E=d.length;y<E;y+=1)if(d[y][0]===w){d.splice(y,1);return}}}}(window);function s(a,u){return u&&a!==document.body?document.body:a.offsetParent}}(t),function(e,n){i.exports?i.exports=n():e.OpenSeadragon=n()}(Ot,function(){return t}),function(e){var n={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.fullscreenElement},n.requestFullScreen=function(r){return r.requestFullscreen()},n.exitFullScreen=function(){document.exitFullscreen()},n.fullScreenEventName="fullscreenchange",n.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.msFullscreenElement},n.requestFullScreen=function(r){return r.msRequestFullscreen()},n.exitFullScreen=function(){document.msExitFullscreen()},n.fullScreenEventName="MSFullscreenChange",n.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitFullscreenElement},n.requestFullScreen=function(r){return r.webkitRequestFullscreen()},n.exitFullScreen=function(){document.webkitExitFullscreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},n.requestFullScreen=function(r){return r.webkitRequestFullScreen()},n.exitFullScreen=function(){document.webkitCancelFullScreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.mozFullScreenElement},n.requestFullScreen=function(r){return r.mozRequestFullScreen()},n.exitFullScreen=function(){document.mozCancelFullScreen()},n.fullScreenEventName="mozfullscreenchange",n.fullScreenErrorEventName="mozfullscreenerror"),n.isFullScreen=function(){return n.getFullScreenElement()!==null},n.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),n.exitFullScreen()},e.extend(e,n)}(t),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(n,r,o,l,s){var a=this;l=l||1;var u=0,c=function(h){return u++,u===l&&a.removeHandler(n,c),r(h)};this.addHandler(n,c,o,s)},addHandler:function(n,r,o,l){var s=this.events[n];if(s||(this.events[n]=s=[]),r&&e.isFunction(r)){var a=s.length,u={handler:r,userData:o||null,priority:l||0};for(s[a]=u;a>0&&s[a-1].priority<s[a].priority;)s[a]=s[a-1],s[a-1]=u,a--}},removeHandler:function(n,r){var o=this.events[n],l=[],s;if(!!o&&e.isArray(o)){for(s=0;s<o.length;s++)o[s].handler!==r&&l.push(o[s]);this.events[n]=l}},numberOfHandlers:function(n){var r=this.events[n];return r?r.length:0},removeAllHandlers:function(n){if(n)this.events[n]=[];else for(var r in this.events)this.events[r]=[]},getHandler:function(n){var r=this.events[n];return!r||!r.length?null:(r=r.length===1?[r[0]]:Array.apply(null,r),function(o,l){var s,a=r.length;for(s=0;s<a;s++)r[s]&&(l.eventSource=o,l.userData=r[s].userData,r[s].handler(l))})},raiseEvent:function(n,r){var o=this.getHandler(n);if(o)return o(this,r||{})}}}(t),function(e){var n={};e.MouseTracker=function(v){var g=arguments;e.isPlainObject(v)||(v={element:g[0],clickTimeThreshold:g[1],clickDistThreshold:g[2]}),this.hash=Math.random(),this.element=e.getElement(v.element),this.clickTimeThreshold=v.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=v.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=v.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=v.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=v.userData||null,this.stopDelay=v.stopDelay||50,this.preProcessEventHandler=v.preProcessEventHandler||null,this.contextMenuHandler=v.contextMenuHandler||null,this.enterHandler=v.enterHandler||null,this.leaveHandler=v.leaveHandler||null,this.exitHandler=v.exitHandler||null,this.overHandler=v.overHandler||null,this.outHandler=v.outHandler||null,this.pressHandler=v.pressHandler||null,this.nonPrimaryPressHandler=v.nonPrimaryPressHandler||null,this.releaseHandler=v.releaseHandler||null,this.nonPrimaryReleaseHandler=v.nonPrimaryReleaseHandler||null,this.moveHandler=v.moveHandler||null,this.scrollHandler=v.scrollHandler||null,this.clickHandler=v.clickHandler||null,this.dblClickHandler=v.dblClickHandler||null,this.dragHandler=v.dragHandler||null,this.dragEndHandler=v.dragEndHandler||null,this.pinchHandler=v.pinchHandler||null,this.stopHandler=v.stopHandler||null,this.keyDownHandler=v.keyDownHandler||null,this.keyUpHandler=v.keyUpHandler||null,this.keyHandler=v.keyHandler||null,this.focusHandler=v.focusHandler||null,this.blurHandler=v.blurHandler||null;var b=this;n[this.hash]={click:function(_){C(b,_)},dblclick:function(_){B(b,_)},keydown:function(_){M(b,_)},keyup:function(_){N(b,_)},keypress:function(_){I(b,_)},focus:function(_){G(b,_)},blur:function(_){W(b,_)},contextmenu:function(_){ne(b,_)},wheel:function(_){Q(b,_)},mousewheel:function(_){$(b,_)},DOMMouseScroll:function(_){$(b,_)},MozMousePixelScroll:function(_){$(b,_)},losecapture:function(_){ve(b,_)},mouseenter:function(_){O(b,_)},mouseleave:function(_){H(b,_)},mouseover:function(_){z(b,_)},mouseout:function(_){V(b,_)},mousedown:function(_){q(b,_)},mouseup:function(_){te(b,_)},mousemove:function(_){Qe(b,_)},touchstart:function(_){Ue(b,_)},touchend:function(_){ye(b,_)},touchmove:function(_){pe(b,_)},touchcancel:function(_){Ge(b,_)},gesturestart:function(_){De(b,_)},gesturechange:function(_){Ee(b,_)},gotpointercapture:function(_){st(b,_)},lostpointercapture:function(_){D(b,_)},pointerenter:function(_){O(b,_)},pointerleave:function(_){H(b,_)},pointerover:function(_){z(b,_)},pointerout:function(_){V(b,_)},pointerdown:function(_){q(b,_)},pointerup:function(_){te(b,_)},pointermove:function(_){Qe(b,_)},pointercancel:function(_){qe(b,_)},pointerupcaptured:function(_){ce(b,_)},pointermovecaptured:function(_){$e(b,_)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,e.MouseTracker.havePointerEvents&&e.setElementPointerEvents(this.element,"auto"),this.exitHandler&&e.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),v.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){a(this),this.element=null,n[this.hash]=null,delete n[this.hash]},isTracking:function(){return n[this.hash].tracking},setTracking:function(v){return v?s(this):a(this),this},getActivePointersListByType:function(v){var g=n[this.hash],b,_=g.activePointersLists.length,R;for(b=0;b<_;b++)if(g.activePointersLists[b].type===v)return g.activePointersLists[b];return R=new e.MouseTracker.GesturePointList(v),g.activePointersLists.push(R),R},getActivePointerCount:function(){var v=n[this.hash],g,b=v.activePointersLists.length,_=0;for(g=0;g<b;g++)_+=v.activePointersLists[g].getLength();return _},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var r=function(){try{return window.self!==window.top}catch{return!0}}();function o(v){try{return v.addEventListener&&v.removeEventListener}catch{return!1}}e.MouseTracker.gesturePointVelocityTracker=function(){var v=[],g=0,b=0,_=function(fe,Y){return fe.hash.toString()+Y.type+Y.id.toString()},R=function(){var fe,Y=v.length,tt,Me,Cn=e.now(),Wd,jd,Gd;for(Wd=Cn-b,b=Cn,fe=0;fe<Y;fe++)tt=v[fe],Me=tt.gPoint,Me.direction=Math.atan2(Me.currentPos.y-tt.lastPos.y,Me.currentPos.x-tt.lastPos.x),jd=tt.lastPos.distanceTo(Me.currentPos),tt.lastPos=Me.currentPos,Gd=1e3*jd/(Wd+1),Me.speed=.75*Gd+.25*Me.speed},L=function(fe,Y){var tt=_(fe,Y);v.push({guid:tt,gPoint:Y,lastPos:Y.currentPos}),v.length===1&&(b=e.now(),g=window.setInterval(R,50))},Z=function(fe,Y){var tt=_(fe,Y),Me,Cn=v.length;for(Me=0;Me<Cn;Me++)if(v[Me].guid===tt){v.splice(Me,1),Cn--,Cn===0&&window.clearInterval(g);break}};return{addPoint:L,removePoint:Z}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",e.MouseTracker.wheelEventName],e.MouseTracker.wheelEventName==="DOMMouseScroll"&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.havePointerCapture=function(){var v=document.createElement("div");return e.isFunction(v.setPointerCapture)&&e.isFunction(v.releasePointerCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(e.MouseTracker.havePointerEvents=!1,e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.havePointerCapture=function(){var v=document.createElement("div");return e.isFunction(v.setCapture)&&e.isFunction(v.releaseCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),e.MouseTracker.GesturePointList=function(v){this._gPoints=[],this.type=v,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(v){return this._gPoints.push(v)},removeById:function(v){var g,b=this._gPoints.length;for(g=0;g<b;g++)if(this._gPoints[g].id===v){this._gPoints.splice(g,1);break}return this._gPoints.length},getByIndex:function(v){return v<this._gPoints.length?this._gPoints[v]:null},getById:function(v){var g,b=this._gPoints.length;for(g=0;g<b;g++)if(this._gPoints[g].id===v)return this._gPoints[g];return null},getPrimary:function(v){var g,b=this._gPoints.length;for(g=0;g<b;g++)if(this._gPoints[g].isPrimary)return this._gPoints[g];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(e.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function l(v){var g=n[v.hash],b,_,R,L,Z,fe=g.activePointersLists.length;for(b=0;b<fe;b++)if(R=g.activePointersLists[b],R.getLength()>0){for(Z=[],L=R.asArray(),_=0;_<L.length;_++)Z.push(L[_]);for(_=0;_<Z.length;_++)lt(v,R,Z[_])}for(b=0;b<fe;b++)g.activePointersLists.pop();g.sentDragEvent=!1}function s(v){var g=n[v.hash],b,_;if(!g.tracking){for(_=0;_<e.MouseTracker.subscribeEvents.length;_++)b=e.MouseTracker.subscribeEvents[_],e.addEvent(v.element,b,g[b],b===e.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);l(v),g.tracking=!0}}function a(v){var g=n[v.hash],b,_;if(g.tracking){for(_=0;_<e.MouseTracker.subscribeEvents.length;_++)b=e.MouseTracker.subscribeEvents[_],e.removeEvent(v.element,b,g[b],!1);l(v),g.tracking=!1}}function u(v,g){var b=n[v.hash];if(g==="pointerevent")return{upName:"pointerup",upHandler:b.pointerupcaptured,moveName:"pointermove",moveHandler:b.pointermovecaptured};if(g==="mouse")return{upName:"pointerup",upHandler:b.pointerupcaptured,moveName:"pointermove",moveHandler:b.pointermovecaptured};if(g==="touch")return{upName:"touchend",upHandler:b.touchendcaptured,moveName:"touchmove",moveHandler:b.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function c(v,g){var b;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents)try{v.element.setPointerCapture(g.id)}catch{e.console.warn("setPointerCapture() called on invalid pointer ID");return}else v.element.setCapture(!0);else b=u(v,e.MouseTracker.havePointerEvents?"pointerevent":g.type),r&&o(window.top)&&e.addEvent(window.top,b.upName,b.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,b.upName,b.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,b.moveName,b.moveHandler,!0);P(v,g,!0)}function h(v,g){var b,_,R;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents){if(_=v.getActivePointersListByType(g.type),R=_.getById(g.id),!R||!R.captured)return;try{v.element.releasePointerCapture(g.id)}catch{}}else v.element.releaseCapture();else b=u(v,e.MouseTracker.havePointerEvents?"pointerevent":g.type),r&&o(window.top)&&e.removeEvent(window.top,b.upName,b.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,b.moveName,b.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,b.upName,b.upHandler,!0);P(v,g,!1)}function d(v){return e.MouseTracker.havePointerEvents?v.pointerId:e.MouseTracker.mousePointerId}function p(v){return e.MouseTracker.havePointerEvents?v.pointerType||(e.Browser.vendor===e.BROWSERS.IE?"mouse":""):"mouse"}function m(v){return e.MouseTracker.havePointerEvents?v.isPrimary:!0}function w(v){return e.getMousePosition(v)}function y(v,g){return E(w(v),g)}function E(v,g){var b=e.getElementOffset(g);return v.minus(b)}function T(v,g){return new e.Point((v.x+g.x)/2,(v.y+g.y)/2)}function C(v,g){var b={originalEvent:g,eventType:"click",pointerType:"mouse",isEmulated:!1};S(v,b),b.preventDefault&&!b.defaultPrevented&&e.cancelEvent(g),b.stopPropagation&&e.stopEvent(g)}function B(v,g){var b={originalEvent:g,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};S(v,b),b.preventDefault&&!b.defaultPrevented&&e.cancelEvent(g),b.stopPropagation&&e.stopEvent(g)}function M(v,g){var b=null,_={originalEvent:g,eventType:"keydown",pointerType:"",isEmulated:!1};S(v,_),v.keyDownHandler&&!_.preventGesture&&!_.defaultPrevented&&(b={eventSource:v,keyCode:g.keyCode?g.keyCode:g.charCode,ctrl:g.ctrlKey,shift:g.shiftKey,alt:g.altKey,meta:g.metaKey,originalEvent:g,preventDefault:_.preventDefault||_.defaultPrevented,userData:v.userData},v.keyDownHandler(b)),(b&&b.preventDefault||_.preventDefault&&!_.defaultPrevented)&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function N(v,g){var b=null,_={originalEvent:g,eventType:"keyup",pointerType:"",isEmulated:!1};S(v,_),v.keyUpHandler&&!_.preventGesture&&!_.defaultPrevented&&(b={eventSource:v,keyCode:g.keyCode?g.keyCode:g.charCode,ctrl:g.ctrlKey,shift:g.shiftKey,alt:g.altKey,meta:g.metaKey,originalEvent:g,preventDefault:_.preventDefault||_.defaultPrevented,userData:v.userData},v.keyUpHandler(b)),(b&&b.preventDefault||_.preventDefault&&!_.defaultPrevented)&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function I(v,g){var b=null,_={originalEvent:g,eventType:"keypress",pointerType:"",isEmulated:!1};S(v,_),v.keyHandler&&!_.preventGesture&&!_.defaultPrevented&&(b={eventSource:v,keyCode:g.keyCode?g.keyCode:g.charCode,ctrl:g.ctrlKey,shift:g.shiftKey,alt:g.altKey,meta:g.metaKey,originalEvent:g,preventDefault:_.preventDefault||_.defaultPrevented,userData:v.userData},v.keyHandler(b)),(b&&b.preventDefault||_.preventDefault&&!_.defaultPrevented)&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function G(v,g){var b={originalEvent:g,eventType:"focus",pointerType:"",isEmulated:!1};S(v,b),v.focusHandler&&!b.preventGesture&&v.focusHandler({eventSource:v,originalEvent:g,userData:v.userData})}function W(v,g){var b={originalEvent:g,eventType:"blur",pointerType:"",isEmulated:!1};S(v,b),v.blurHandler&&!b.preventGesture&&v.blurHandler({eventSource:v,originalEvent:g,userData:v.userData})}function ne(v,g){var b=null,_={originalEvent:g,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};S(v,_),v.contextMenuHandler&&!_.preventGesture&&!_.defaultPrevented&&(b={eventSource:v,position:E(w(g),v.element),originalEvent:_.originalEvent,preventDefault:_.preventDefault||_.defaultPrevented,userData:v.userData},v.contextMenuHandler(b)),(b&&b.preventDefault||_.preventDefault&&!_.defaultPrevented)&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function Q(v,g){oe(v,g,g)}function $(v,g){var b={target:g.target||g.srcElement,type:"wheel",shiftKey:g.shiftKey||!1,clientX:g.clientX,clientY:g.clientY,pageX:g.pageX?g.pageX:g.clientX,pageY:g.pageY?g.pageY:g.clientY,deltaMode:g.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};e.MouseTracker.wheelEventName==="mousewheel"?b.deltaY=-g.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:b.deltaY=g.detail,oe(v,b,g)}function oe(v,g,b){var _=0,R,L=null;_=g.deltaY<0?1:-1,R={originalEvent:g,eventType:"wheel",pointerType:"mouse",isEmulated:g!==b},S(v,R),v.scrollHandler&&!R.preventGesture&&!R.defaultPrevented&&(L={eventSource:v,pointerType:"mouse",position:y(g,v.element),scroll:_,shift:g.shiftKey,isTouchEvent:!1,originalEvent:b,preventDefault:R.preventDefault||R.defaultPrevented,userData:v.userData},v.scrollHandler(L)),R.stopPropagation&&e.stopEvent(b),(L&&L.preventDefault||R.preventDefault&&!R.defaultPrevented)&&e.cancelEvent(b)}function ve(v,g){var b={id:e.MouseTracker.mousePointerId,type:"mouse"},_={originalEvent:g,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};S(v,_),g.target===v.element&&P(v,b,!1),_.stopPropagation&&e.stopEvent(g)}function Ue(v,g){var b,_,R=g.changedTouches.length,L,Z=v.getActivePointersListByType("touch");b=e.now(),Z.getLength()>g.touches.length-R&&e.console.warn("Tracked touch contact count doesn't match event.touches.length");var fe={originalEvent:g,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(S(v,fe),_=0;_<R;_++)L={id:g.changedTouches[_].identifier,type:"touch",isPrimary:Z.getLength()===0,currentPos:w(g.changedTouches[_]),currentTime:b},k(v,fe,L),he(v,fe,L,0),P(v,L,!0);fe.preventDefault&&!fe.defaultPrevented&&e.cancelEvent(g),fe.stopPropagation&&e.stopEvent(g)}function ye(v,g){var b,_,R=g.changedTouches.length,L;b=e.now();var Z={originalEvent:g,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(S(v,Z),_=0;_<R;_++)L={id:g.changedTouches[_].identifier,type:"touch",currentPos:w(g.changedTouches[_]),currentTime:b},me(v,Z,L,0),P(v,L,!1),F(v,Z,L);Z.preventDefault&&!Z.defaultPrevented&&e.cancelEvent(g),Z.stopPropagation&&e.stopEvent(g)}function pe(v,g){var b,_,R=g.changedTouches.length,L;b=e.now();var Z={originalEvent:g,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(S(v,Z),_=0;_<R;_++)L={id:g.changedTouches[_].identifier,type:"touch",currentPos:w(g.changedTouches[_]),currentTime:b},we(v,Z,L);Z.preventDefault&&!Z.defaultPrevented&&e.cancelEvent(g),Z.stopPropagation&&e.stopEvent(g)}function Ge(v,g){var b=g.changedTouches.length,_,R,L={originalEvent:g,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(S(v,L),_=0;_<b;_++)R={id:g.changedTouches[_].identifier,type:"touch"},ee(v,L,R);L.stopPropagation&&e.stopEvent(g)}function De(v,g){return e.eventIsCanceled(g)||g.preventDefault(),!1}function Ee(v,g){return e.eventIsCanceled(g)||g.preventDefault(),!1}function st(v,g){var b={originalEvent:g,eventType:"gotpointercapture",pointerType:p(g),isEmulated:!1};S(v,b),g.target===v.element&&P(v,{id:g.pointerId,type:p(g)},!0),b.stopPropagation&&e.stopEvent(g)}function D(v,g){var b={originalEvent:g,eventType:"lostpointercapture",pointerType:p(g),isEmulated:!1};S(v,b),g.target===v.element&&P(v,{id:g.pointerId,type:p(g)},!1),b.stopPropagation&&e.stopEvent(g)}function O(v,g){var b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()},_={originalEvent:g,eventType:"pointerenter",pointerType:b.type,isEmulated:!1};S(v,_),k(v,_,b)}function H(v,g){var b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()},_={originalEvent:g,eventType:"pointerleave",pointerType:b.type,isEmulated:!1};S(v,_),F(v,_,b)}function z(v,g){var b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()},_={originalEvent:g,eventType:"pointerover",pointerType:b.type,isEmulated:!1};S(v,_),X(v,_,b),_.preventDefault&&!_.defaultPrevented&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function V(v,g){var b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()},_={originalEvent:g,eventType:"pointerout",pointerType:b.type,isEmulated:!1};S(v,_),U(v,_,b),_.preventDefault&&!_.defaultPrevented&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function q(v,g){var b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()},_=e.MouseTracker.havePointerEvents&&b.type==="touch"&&e.Browser.vendor!==e.BROWSERS.IE,R={originalEvent:g,eventType:"pointerdown",pointerType:b.type,isEmulated:!1};S(v,R),he(v,R,b,g.button),R.preventDefault&&!R.defaultPrevented&&e.cancelEvent(g),R.stopPropagation&&e.stopEvent(g),R.shouldCapture&&(_?P(v,b,!0):c(v,b))}function te(v,g){ae(v,g)}function ce(v,g){var b=v.getActivePointersListByType(p(g));b.getById(g.pointerId)&&ae(v,g),e.stopEvent(g)}function ae(v,g){var b;b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()};var _={originalEvent:g,eventType:"pointerup",pointerType:b.type,isEmulated:!1};S(v,_),me(v,_,b,g.button),_.preventDefault&&!_.defaultPrevented&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g),_.shouldReleaseCapture&&(g.target===v.element?h(v,b):P(v,b,!1))}function Qe(v,g){et(v,g)}function $e(v,g){var b=v.getActivePointersListByType(p(g));b.getById(g.pointerId)&&et(v,g),e.stopEvent(g)}function et(v,g){var b={id:d(g),type:p(g),isPrimary:m(g),currentPos:w(g),currentTime:e.now()},_={originalEvent:g,eventType:"pointermove",pointerType:b.type,isEmulated:!1};S(v,_),we(v,_,b),_.preventDefault&&!_.defaultPrevented&&e.cancelEvent(g),_.stopPropagation&&e.stopEvent(g)}function qe(v,g){var b={id:g.pointerId,type:p(g)},_={originalEvent:g,eventType:"pointercancel",pointerType:b.type,isEmulated:!1};S(v,_),ee(v,_,b),_.stopPropagation&&e.stopEvent(g)}function at(v,g){return g.speed=0,g.direction=0,g.contactPos=g.currentPos,g.contactTime=g.currentTime,g.lastPos=g.currentPos,g.lastTime=g.currentTime,v.add(g)}function lt(v,g,b){var _,R=g.getById(b.id);return R?(R.captured&&(e.console.warn("stopTrackingPointer() called on captured pointer"),h(v,R)),g.removeContact(),_=g.removeById(b.id)):_=g.getLength(),_}function f(v,g){switch(g.eventType){case"pointermove":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!1,g.preventGesture=!v.hasGestureHandlers,g.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!1,g.preventGesture=!1,g.stopPropagation=!1;break;case"pointerdown":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!1,g.preventGesture=!v.hasGestureHandlers,g.stopPropagation=!1;break;case"pointerup":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!1,g.preventGesture=!v.hasGestureHandlers,g.stopPropagation=!1;break;case"wheel":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!1,g.preventGesture=!v.hasScrollHandler,g.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":g.isStoppable=!0,g.isCancelable=!1,g.preventDefault=!1,g.preventGesture=!1,g.stopPropagation=!1;break;case"click":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!!v.clickHandler,g.preventGesture=!1,g.stopPropagation=!1;break;case"dblclick":g.isStoppable=!0,g.isCancelable=!0,g.preventDefault=!!v.dblClickHandler,g.preventGesture=!1,g.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:g.isStoppable=!1,g.isCancelable=!1,g.preventDefault=!1,g.preventGesture=!1,g.stopPropagation=!1;break}}function S(v,g){g.eventSource=v,g.eventPhase=g.originalEvent&&typeof g.originalEvent.eventPhase!="undefined"?g.originalEvent.eventPhase:0,g.defaultPrevented=e.eventIsCanceled(g.originalEvent),g.shouldCapture=!1,g.shouldReleaseCapture=!1,g.userData=v.userData,f(v,g),v.preProcessEventHandler&&v.preProcessEventHandler(g)}function P(v,g,b){var _=v.getActivePointersListByType(g.type),R=_.getById(g.id);R?b&&!R.captured?(R.captured=!0,_.captureCount++):!b&&R.captured&&(R.captured=!1,_.captureCount--,_.captureCount<0&&(_.captureCount=0,e.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):e.console.warn("updatePointerCaptured() called on untracked pointer")}function k(v,g,b){var _=v.getActivePointersListByType(b.type),R;R=_.getById(b.id),R?(R.insideElement=!0,R.lastPos=R.currentPos,R.lastTime=R.currentTime,R.currentPos=b.currentPos,R.currentTime=b.currentTime,b=R):(b.captured=!1,b.insideElementPressed=!1,b.insideElement=!0,at(_,b)),v.enterHandler&&v.enterHandler({eventSource:v,pointerType:b.type,position:E(b.currentPos,v.element),buttons:_.buttons,pointers:v.getActivePointerCount(),insideElementPressed:b.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData})}function F(v,g,b){var _=v.getActivePointersListByType(b.type),R,L;R=_.getById(b.id),R?(R.captured?(R.insideElement=!1,R.lastPos=R.currentPos,R.lastTime=R.currentTime,R.currentPos=b.currentPos,R.currentTime=b.currentTime):lt(v,_,R),b=R):(b.captured=!1,b.insideElementPressed=!1),(v.leaveHandler||v.exitHandler)&&(L={eventSource:v,pointerType:b.type,position:b.currentPos&&E(b.currentPos,v.element),buttons:_.buttons,pointers:v.getActivePointerCount(),insideElementPressed:b.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData},v.leaveHandler&&v.leaveHandler(L),v.exitHandler&&v.exitHandler(L))}function X(v,g,b){var _,R;_=v.getActivePointersListByType(b.type),R=_.getById(b.id),R?b=R:(b.captured=!1,b.insideElementPressed=!1),v.overHandler&&v.overHandler({eventSource:v,pointerType:b.type,position:E(b.currentPos,v.element),buttons:_.buttons,pointers:v.getActivePointerCount(),insideElementPressed:b.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData})}function U(v,g,b){var _,R;_=v.getActivePointersListByType(b.type),R=_.getById(b.id),R?b=R:(b.captured=!1,b.insideElementPressed=!1),v.outHandler&&v.outHandler({eventSource:v,pointerType:b.type,position:b.currentPos&&E(b.currentPos,v.element),buttons:_.buttons,pointers:v.getActivePointerCount(),insideElementPressed:b.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData})}function he(v,g,b,_){var R=n[v.hash],L=v.getActivePointersListByType(b.type),Z;if(typeof g.originalEvent.buttons!="undefined"?L.buttons=g.originalEvent.buttons:_===0?L.buttons|=1:_===1?L.buttons|=4:_===2?L.buttons|=2:_===3?L.buttons|=8:_===4?L.buttons|=16:_===5&&(L.buttons|=32),_!==0){g.shouldCapture=!1,g.shouldReleaseCapture=!1,v.nonPrimaryPressHandler&&!g.preventGesture&&!g.defaultPrevented&&(g.preventDefault=!0,v.nonPrimaryPressHandler({eventSource:v,pointerType:b.type,position:E(b.currentPos,v.element),button:_,buttons:L.buttons,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData}));return}Z=L.getById(b.id),Z?(Z.insideElementPressed=!0,Z.insideElement=!0,Z.originalTarget=g.originalEvent.target,Z.contactPos=b.currentPos,Z.contactTime=b.currentTime,Z.lastPos=Z.currentPos,Z.lastTime=Z.currentTime,Z.currentPos=b.currentPos,Z.currentTime=b.currentTime,b=Z):(b.captured=!1,b.insideElementPressed=!0,b.insideElement=!0,b.originalTarget=g.originalEvent.target,at(L,b)),L.addContact(),!g.preventGesture&&!g.defaultPrevented?(g.shouldCapture=!0,g.shouldReleaseCapture=!1,g.preventDefault=!0,(v.dragHandler||v.dragEndHandler||v.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(v,b),L.contacts===1?v.pressHandler&&!g.preventGesture&&v.pressHandler({eventSource:v,pointerType:b.type,position:E(b.contactPos,v.element),buttons:L.buttons,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData}):L.contacts===2&&v.pinchHandler&&b.type==="touch"&&(R.pinchGPoints=L.asArray(),R.lastPinchDist=R.currentPinchDist=R.pinchGPoints[0].currentPos.distanceTo(R.pinchGPoints[1].currentPos),R.lastPinchCenter=R.currentPinchCenter=T(R.pinchGPoints[0].currentPos,R.pinchGPoints[1].currentPos))):(g.shouldCapture=!1,g.shouldReleaseCapture=!1)}function me(v,g,b,_){var R=n[v.hash],L=v.getActivePointersListByType(b.type),Z,fe,Y,tt=!1,Me;if(typeof g.originalEvent.buttons!="undefined"?L.buttons=g.originalEvent.buttons:_===0?L.buttons^=-2:_===1?L.buttons^=-5:_===2?L.buttons^=-3:_===3?L.buttons^=-9:_===4?L.buttons^=-17:_===5&&(L.buttons^=-33),g.shouldCapture=!1,_!==0){g.shouldReleaseCapture=!1,v.nonPrimaryReleaseHandler&&!g.preventGesture&&!g.defaultPrevented&&(g.preventDefault=!0,v.nonPrimaryReleaseHandler({eventSource:v,pointerType:b.type,position:E(b.currentPos,v.element),button:_,buttons:L.buttons,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData}));return}Y=L.getById(b.id),Y?(L.removeContact(),Y.captured&&(tt=!0),Y.lastPos=Y.currentPos,Y.lastTime=Y.currentTime,Y.currentPos=b.currentPos,Y.currentTime=b.currentTime,Y.insideElement||lt(v,L,Y),Z=Y.currentPos,fe=Y.currentTime):(b.captured=!1,b.insideElementPressed=!1,b.insideElement=!0,at(L,b),Y=b),!g.preventGesture&&!g.defaultPrevented&&(tt?(g.shouldReleaseCapture=!0,g.preventDefault=!0,(v.dragHandler||v.dragEndHandler||v.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(v,Y),L.contacts===0?(v.releaseHandler&&Z&&v.releaseHandler({eventSource:v,pointerType:Y.type,position:E(Z,v.element),buttons:L.buttons,insideElementPressed:Y.insideElementPressed,insideElementReleased:Y.insideElement,isTouchEvent:Y.type==="touch",originalEvent:g.originalEvent,userData:v.userData}),v.dragEndHandler&&R.sentDragEvent&&v.dragEndHandler({eventSource:v,pointerType:Y.type,position:E(Y.currentPos,v.element),speed:Y.speed,direction:Y.direction,shift:g.originalEvent.shiftKey,isTouchEvent:Y.type==="touch",originalEvent:g.originalEvent,userData:v.userData}),R.sentDragEvent=!1,(v.clickHandler||v.dblClickHandler)&&Y.insideElement&&(Me=fe-Y.contactTime<=v.clickTimeThreshold&&Y.contactPos.distanceTo(Z)<=v.clickDistThreshold,v.clickHandler&&v.clickHandler({eventSource:v,pointerType:Y.type,position:E(Y.currentPos,v.element),quick:Me,shift:g.originalEvent.shiftKey,isTouchEvent:Y.type==="touch",originalEvent:g.originalEvent,originalTarget:Y.originalTarget,userData:v.userData}),v.dblClickHandler&&Me&&(L.clicks++,L.clicks===1?(R.lastClickPos=Z,R.dblClickTimeOut=setTimeout(function(){L.clicks=0},v.dblClickTimeThreshold)):L.clicks===2&&(clearTimeout(R.dblClickTimeOut),L.clicks=0,R.lastClickPos.distanceTo(Z)<=v.dblClickDistThreshold&&v.dblClickHandler({eventSource:v,pointerType:Y.type,position:E(Y.currentPos,v.element),shift:g.originalEvent.shiftKey,isTouchEvent:Y.type==="touch",originalEvent:g.originalEvent,userData:v.userData}),R.lastClickPos=null)))):L.contacts===2&&v.pinchHandler&&Y.type==="touch"&&(R.pinchGPoints=L.asArray(),R.lastPinchDist=R.currentPinchDist=R.pinchGPoints[0].currentPos.distanceTo(R.pinchGPoints[1].currentPos),R.lastPinchCenter=R.currentPinchCenter=T(R.pinchGPoints[0].currentPos,R.pinchGPoints[1].currentPos))):(g.shouldReleaseCapture=!1,v.releaseHandler&&Z&&(v.releaseHandler({eventSource:v,pointerType:Y.type,position:E(Z,v.element),buttons:L.buttons,insideElementPressed:Y.insideElementPressed,insideElementReleased:Y.insideElement,isTouchEvent:Y.type==="touch",originalEvent:g.originalEvent,userData:v.userData}),g.preventDefault=!0)))}function we(v,g,b){var _=n[v.hash],R=v.getActivePointersListByType(b.type),L,Z,fe;if(typeof g.originalEvent.buttons!="undefined"&&(R.buttons=g.originalEvent.buttons),L=R.getById(b.id),L)L.lastPos=L.currentPos,L.lastTime=L.currentTime,L.currentPos=b.currentPos,L.currentTime=b.currentTime;else return;g.shouldCapture=!1,g.shouldReleaseCapture=!1,v.stopHandler&&b.type==="mouse"&&(clearTimeout(v.stopTimeOut),v.stopTimeOut=setTimeout(function(){_e(v,g.originalEvent,b.type)},v.stopDelay)),R.contacts===0?v.moveHandler&&v.moveHandler({eventSource:v,pointerType:b.type,position:E(b.currentPos,v.element),buttons:R.buttons,isTouchEvent:b.type==="touch",originalEvent:g.originalEvent,userData:v.userData}):R.contacts===1?(v.moveHandler&&(L=R.asArray()[0],v.moveHandler({eventSource:v,pointerType:L.type,position:E(L.currentPos,v.element),buttons:R.buttons,isTouchEvent:L.type==="touch",originalEvent:g.originalEvent,userData:v.userData})),v.dragHandler&&!g.preventGesture&&!g.defaultPrevented&&(L=R.asArray()[0],fe=L.currentPos.minus(L.lastPos),v.dragHandler({eventSource:v,pointerType:L.type,position:E(L.currentPos,v.element),buttons:R.buttons,delta:fe,speed:L.speed,direction:L.direction,shift:g.originalEvent.shiftKey,isTouchEvent:L.type==="touch",originalEvent:g.originalEvent,userData:v.userData}),g.preventDefault=!0,_.sentDragEvent=!0)):R.contacts===2&&(v.moveHandler&&(Z=R.asArray(),v.moveHandler({eventSource:v,pointerType:Z[0].type,position:E(T(Z[0].currentPos,Z[1].currentPos),v.element),buttons:R.buttons,isTouchEvent:Z[0].type==="touch",originalEvent:g.originalEvent,userData:v.userData})),v.pinchHandler&&b.type==="touch"&&!g.preventGesture&&!g.defaultPrevented&&(fe=_.pinchGPoints[0].currentPos.distanceTo(_.pinchGPoints[1].currentPos),fe!==_.currentPinchDist&&(_.lastPinchDist=_.currentPinchDist,_.currentPinchDist=fe,_.lastPinchCenter=_.currentPinchCenter,_.currentPinchCenter=T(_.pinchGPoints[0].currentPos,_.pinchGPoints[1].currentPos),v.pinchHandler({eventSource:v,pointerType:"touch",gesturePoints:_.pinchGPoints,lastCenter:E(_.lastPinchCenter,v.element),center:E(_.currentPinchCenter,v.element),lastDistance:_.lastPinchDist,distance:_.currentPinchDist,shift:g.originalEvent.shiftKey,originalEvent:g.originalEvent,userData:v.userData}),g.preventDefault=!0)))}function ee(v,g,b){var _=v.getActivePointersListByType(b.type),R;R=_.getById(b.id),R&&lt(v,_,R)}function _e(v,g,b){v.stopHandler&&v.stopHandler({eventSource:v,pointerType:b,position:y(g,v.element),buttons:v.getActivePointersListByType(b).buttons,isTouchEvent:b==="touch",originalEvent:g,userData:v.userData})}}(t),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(n,r,o){var l=n.parentNode;typeof r=="number"&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),r={anchor:r}),r.attachToViewer=typeof r.attachToViewer=="undefined"?!0:r.attachToViewer,this.autoFade=typeof r.autoFade=="undefined"?!0:r.autoFade,this.element=n,this.anchor=r.anchor,this.container=o,this.anchor===e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof r.top=="number"?r.top+"px":r.top,this.wrapper.style.left=typeof r.left=="number"?r.left+"px":r.left,this.wrapper.style.height=typeof r.height=="number"?r.height+"px":r.height,this.wrapper.style.width=typeof r.width=="number"?r.width+"px":r.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),r.attachToViewer?this.anchor===e.ControlAnchor.TOP_RIGHT||this.anchor===e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):l.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==e.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(n){this.wrapper.style.display=n?this.anchor===e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(n){this.element[e.SIGNAL]&&e.Browser.vendor===e.BROWSERS.IE?e.setElementOpacity(this.element,n,!0):e.setElementOpacity(this.wrapper,n,!0)}}}(t),function(e){e.ControlDock=function(r){var o=["topleft","topright","bottomright","bottomleft"],l,s;for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(Math.random()*1e6),container:e.makeNeutralElement("div"),controls:[]},r),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),s=0;s<o.length;s++)l=o[s],this.controls[l]=e.makeNeutralElement("div"),this.controls[l].style.position="absolute",l.match("left")&&(this.controls[l].style.left="0px"),l.match("right")&&(this.controls[l].style.right="0px"),l.match("top")&&(this.controls[l].style.top="0px"),l.match("bottom")&&(this.controls[l].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(r,o){r=e.getElement(r);var l=null;if(!(n(this,r)>=0)){switch(o.anchor){case e.ControlAnchor.TOP_RIGHT:l=this.controls.topright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:l=this.controls.bottomright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:l=this.controls.bottomleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:l=this.controls.topleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:l=this.container,r.style.margin="0px",r.style.padding="0px";break;default:case e.ControlAnchor.NONE:l=this.container,r.style.margin="0px",r.style.padding="0px";break}this.controls.push(new e.Control(r,o,l)),r.style.display="inline-block"}},removeControl:function(r){r=e.getElement(r);var o=n(this,r);return o>=0&&(this.controls[o].destroy(),this.controls.splice(o,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var r;for(r=this.controls.length-1;r>=0;r--)if(this.controls[r].isVisible())return!0;return!1},setControlsEnabled:function(r){var o;for(o=this.controls.length-1;o>=0;o--)this.controls[o].setVisible(r);return this}};function n(r,o){var l=r.controls,s;for(s=l.length-1;s>=0;s--)if(l[s].element===o)return s;return-1}}(t),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(t),function(e){var n={},r=1;e.Viewer=function(f){var S=arguments,P=this,k;if(e.isPlainObject(f)||(f={id:S[0],xmlPath:S.length>1?S[1]:void 0,prefixUrl:S.length>2?S[2]:void 0,controls:S.length>3?S[3]:void 0,overlays:S.length>4?S[4]:void 0}),f.config&&(e.extend(!0,f,f.config),delete f.config),e.extend(!0,this,{id:f.id,hash:f.hash||r++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},e.DEFAULT_SETTINGS,f),typeof this.hash=="undefined")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof n[this.hash]!="undefined"&&e.console.warn("Hash "+this.hash+" has already been used."),n[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(F){var X=e.getString("Errors.OpenFailed",F.eventSource,F.message);P._showMessage(X)}),e.ControlDock.call(this,f),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(F){F.width="100%",F.height="100%",F.overflow="hidden",F.position="absolute",F.top="0px",F.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),f.tabIndex!==""&&(this.canvas.tabIndex=f.tabIndex===void 0?0:f.tabIndex),this.container.className="openseadragon-container",function(F){F.width="100%",F.height="100%",F.position="relative",F.overflow="hidden",F.left="0px",F.top="0px",F.textAlign="left"}(this.container.style),e.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:e.delegate(this,y),keyDownHandler:e.delegate(this,E),keyHandler:e.delegate(this,T),clickHandler:e.delegate(this,C),dblClickHandler:e.delegate(this,B),dragHandler:e.delegate(this,M),dragEndHandler:e.delegate(this,N),enterHandler:e.delegate(this,I),leaveHandler:e.delegate(this,G),pressHandler:e.delegate(this,W),releaseHandler:e.delegate(this,ne),nonPrimaryPressHandler:e.delegate(this,Q),nonPrimaryReleaseHandler:e.delegate(this,$),scrollHandler:e.delegate(this,ye),pinchHandler:e.delegate(this,oe),focusHandler:e.delegate(this,ve),blurHandler:e.delegate(this,Ue)}),this.outerTracker=new e.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,pe),leaveHandler:e.delegate(this,Ge)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),n[this.hash].prevContainerSize=o(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){n[P.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(F){P.source=P.world.getItemAt(0).source,n[P.hash].forceRedraw=!0,P._updateRequestId||(P._updateRequestId=u(P,De))}),this.world.addHandler("remove-item",function(F){P.world.getItemCount()?P.source=P.world.getItemAt(0).source:P.source=null,n[P.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(F){P.viewport&&P.viewport._setContentBounds(P.world.getHomeBounds(),P.world.getContentFactor())}),this.world.addHandler("item-index-change",function(F){P.source=P.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:n[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:f.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(k=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(k,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(k=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(k,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new e.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),k=0;k<this.customControls.length;k++)this.addControl(this.customControls[k].id,{anchor:this.customControls[k].anchor});e.requestAnimationFrame(function(){h(P)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),e._viewers.set(this.element,this)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(f){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(f)},openTileSource:function(f){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(f)},get buttons(){return e.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(f,S){var P=this;if(this.close(),!f)return this;if(this.sequenceMode&&e.isArray(f))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof S!="undefined"&&!isNaN(S)&&(this.initialPage=S),this.tileSources=f,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(e.isArray(f)||(f=[f]),!f.length)return this;this._opening=!0;for(var k=f.length,F=0,X=0,U,he=function(){if(F+X===k)if(F){(P._firstOpen||!P.preserveViewport)&&(P.viewport.goHome(!0),P.viewport.update()),P._firstOpen=!1;var ee=f[0];if(ee.tileSource&&(ee=ee.tileSource),P.overlays&&!P.preserveOverlays)for(var _e=0;_e<P.overlays.length;_e++)P.currentOverlays[_e]=s(P,P.overlays[_e]);P._drawOverlays(),P._opening=!1,P.raiseEvent("open",{source:ee})}else P._opening=!1,P.raiseEvent("open-failed",U)},me=function(ee){(!e.isPlainObject(ee)||!ee.tileSource)&&(ee={tileSource:ee}),ee.index!==void 0&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete ee.index),ee.collectionImmediately===void 0&&(ee.collectionImmediately=!0);var _e=ee.success;ee.success=function(g){if(F++,ee.tileSource.overlays)for(var b=0;b<ee.tileSource.overlays.length;b++)P.addOverlay(ee.tileSource.overlays[b]);_e&&_e(g),he()};var v=ee.error;ee.error=function(g){X++,U||(U=g),v&&v(g),he()},P.addTiledImage(ee)},we=0;we<f.length;we++)me(f[we]);return this},close:function(){return n[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),n[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(!!n[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),n[this.navigator.hash]=null,delete n[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),n[this.hash]=null,delete n[this.hash],this.canvas=null,this.container=null,e._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(f){return this.innerTracker.setTracking(f),this.outerTracker.setTracking(f),this.raiseEvent("mouse-enabled",{enabled:f}),this},areControlsEnabled:function(){var f=this.controls.length,S;for(S=0;S<this.controls.length;S++)f=f&&this.controls[S].isVisible();return f},setControlsEnabled:function(f){return f?p(this):h(this),this.raiseEvent("controls-enabled",{enabled:f}),this},setDebugMode:function(f){for(var S=0;S<this.world.getItemCount();S++)this.world.getItemAt(S).debugMode=f;this.debugMode=f,this.forceRedraw()},setAjaxHeaders:function(f,S){if(f===null&&(f={}),!e.isPlainObject(f)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(S===void 0&&(S=!0),this.ajaxHeaders=f,S){for(var P=0;P<this.world.getItemCount();P++)this.world.getItemAt(P)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(var k in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[k].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(f){this.buttonGroup.addButton(f)},isFullPage:function(){return n[this.hash].fullPage},setFullPage:function(f){var S=document.body,P=S.style,k=document.documentElement.style,F=this,X,U;if(f===this.isFullPage())return this;var he={fullPage:f,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",he),he.preventDefaultAction)return this;if(f){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=P.margin,this.docMargin=k.margin,P.margin="0",k.margin="0",this.bodyPadding=P.padding,this.docPadding=k.padding,P.padding="0",k.padding="0",this.bodyWidth=P.width,this.docWidth=k.width,P.width="100%",k.width="100%",this.bodyHeight=P.height,this.docHeight=k.height,P.height="100%",k.height="100%",this.bodyDisplay=P.display,P.display="block",this.previousBody=[],n[this.hash].prevElementParent=this.element.parentNode,n[this.hash].prevNextSibling=this.element.nextSibling,n[this.hash].prevElementWidth=this.element.style.width,n[this.hash].prevElementHeight=this.element.style.height,X=S.childNodes.length,U=0;U<X;U++)this.previousBody.push(S.childNodes[0]),S.removeChild(S.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,S.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),S.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),n[this.hash].fullPage=!0,e.delegate(this,pe)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,P.margin=this.bodyMargin,k.margin=this.docMargin,P.padding=this.bodyPadding,k.padding=this.docPadding,P.width=this.bodyWidth,k.width=this.docWidth,P.height=this.bodyHeight,k.height=this.docHeight,P.display=this.bodyDisplay,S.removeChild(this.element),X=this.previousBody.length,U=0;U<X;U++)S.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),n[this.hash].prevElementParent.insertBefore(this.element,n[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(S.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=n[this.hash].prevElementWidth,this.element.style.height=n[this.hash].prevElementHeight;var me=0,we=function(){e.setPageScroll(F.pageScroll);var ee=e.getPageScroll();me++,me<10&&(ee.x!==F.pageScroll.x||ee.y!==F.pageScroll.y)&&e.requestAnimationFrame(we)};e.requestAnimationFrame(we),n[this.hash].fullPage=!1,e.delegate(this,Ge)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:f}),this},setFullScreen:function(f){var S=this;if(!e.supportsFullScreen)return this.setFullPage(f);if(e.isFullScreen()===f)return this;var P={fullScreen:f,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",P),P.preventDefaultAction)return this;if(f){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var k=function(){var F=e.isFullScreen();F||(e.removeEvent(document,e.fullScreenEventName,k),e.removeEvent(document,e.fullScreenErrorEventName,k),S.setFullPage(!1),S.isFullPage()&&(S.element.style.width=S.fullPageStyleWidth,S.element.style.height=S.fullPageStyleHeight)),S.navigator&&S.viewport&&setTimeout(function(){S.navigator.update(S.viewport)}),S.raiseEvent("full-screen",{fullScreen:F})};e.addEvent(document,e.fullScreenEventName,k),e.addEvent(document,e.fullScreenErrorEventName,k),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return e.isFullScreen()&&this.isFullPage()},setVisible:function(f){return this.container.style.visibility=f?"":"hidden",this.raiseEvent("visible",{visible:f}),this},addTiledImage:function(f){e.console.assert(f,"[Viewer.addTiledImage] options is required"),e.console.assert(f.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!f.replace||f.index>-1&&f.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var S=this;f.replace&&(f.replaceItem=S.world.getItemAt(f.index)),this._hideMessage(),f.placeholderFillStyle===void 0&&(f.placeholderFillStyle=this.placeholderFillStyle),f.opacity===void 0&&(f.opacity=this.opacity),f.preload===void 0&&(f.preload=this.preload),f.compositeOperation===void 0&&(f.compositeOperation=this.compositeOperation),f.crossOriginPolicy===void 0&&(f.crossOriginPolicy=f.tileSource.crossOriginPolicy!==void 0?f.tileSource.crossOriginPolicy:this.crossOriginPolicy),f.ajaxWithCredentials===void 0&&(f.ajaxWithCredentials=this.ajaxWithCredentials),f.loadTilesWithAjax===void 0&&(f.loadTilesWithAjax=this.loadTilesWithAjax),e.isPlainObject(f.ajaxHeaders)||(f.ajaxHeaders={});var P={options:f};function k(U){for(var he=0;he<S._loadQueue.length;he++)if(S._loadQueue[he]===P){S._loadQueue.splice(he,1);break}S._loadQueue.length===0&&F(P),S.raiseEvent("add-item-failed",U),f.error&&f.error(U)}function F(U){S.collectionMode&&(S.world.arrange({immediately:U.options.collectionImmediately,rows:S.collectionRows,columns:S.collectionColumns,layout:S.collectionLayout,tileSize:S.collectionTileSize,tileMargin:S.collectionTileMargin}),S.world.setAutoRefigureSizes(!0))}if(e.isArray(f.tileSource)){setTimeout(function(){k({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:f.tileSource,options:f})});return}this._loadQueue.push(P);function X(){for(var U,he,me;S._loadQueue.length&&(U=S._loadQueue[0],!!U.tileSource);){if(S._loadQueue.splice(0,1),U.options.replace){var we=S.world.getIndexOfItem(U.options.replaceItem);we!==-1&&(U.options.index=we),S.world.removeItem(U.options.replaceItem)}he=new e.TiledImage({viewer:S,source:U.tileSource,viewport:S.viewport,drawer:S.drawer,tileCache:S.tileCache,imageLoader:S.imageLoader,x:U.options.x,y:U.options.y,width:U.options.width,height:U.options.height,fitBounds:U.options.fitBounds,fitBoundsPlacement:U.options.fitBoundsPlacement,clip:U.options.clip,placeholderFillStyle:U.options.placeholderFillStyle,opacity:U.options.opacity,preload:U.options.preload,degrees:U.options.degrees,flipped:U.options.flipped,compositeOperation:U.options.compositeOperation,springStiffness:S.springStiffness,animationTime:S.animationTime,minZoomImageRatio:S.minZoomImageRatio,wrapHorizontal:S.wrapHorizontal,wrapVertical:S.wrapVertical,immediateRender:S.immediateRender,blendTime:S.blendTime,alwaysBlend:S.alwaysBlend,minPixelRatio:S.minPixelRatio,smoothTileEdgesMinZoom:S.smoothTileEdgesMinZoom,iOSDevice:S.iOSDevice,crossOriginPolicy:U.options.crossOriginPolicy,ajaxWithCredentials:U.options.ajaxWithCredentials,loadTilesWithAjax:U.options.loadTilesWithAjax,ajaxHeaders:U.options.ajaxHeaders,debugMode:S.debugMode,subPixelRoundingForTransparency:S.subPixelRoundingForTransparency}),S.collectionMode&&S.world.setAutoRefigureSizes(!1),S.navigator&&(me=e.extend({},U.options,{replace:!1,originalTiledImage:he,tileSource:U.tileSource}),S.navigator.addTiledImage(me)),S.world.addItem(he,{index:U.options.index}),S._loadQueue.length===0&&F(U),S.world.getItemCount()===1&&!S.preserveViewport&&S.viewport.goHome(!0),U.options.success&&U.options.success({item:he})}}l(this,f.tileSource,f,function(U){P.tileSource=U,X()},function(U){U.options=f,k(U),X()})},addSimpleImage:function(f){e.console.assert(f,"[Viewer.addSimpleImage] options is required"),e.console.assert(f.url,"[Viewer.addSimpleImage] options.url is required");var S=e.extend({},f,{tileSource:{type:"image",url:f.url}});delete S.url,this.addTiledImage(S)},addLayer:function(f){var S=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var P=e.extend({},f,{success:function(k){S.raiseEvent("add-layer",{options:f,drawer:k.item})},error:function(k){S.raiseEvent("add-layer-failed",k)}});return this.addTiledImage(P),this},getLayerAtLevel:function(f){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(f)},getLevelOfLayer:function(f){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(f)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(f,S){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(f,S)},removeLayer:function(f){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(f)},forceRedraw:function(){return n[this.hash].forceRedraw=!0,this},forceResize:function(){n[this.hash].needsResize=!0,n[this.hash].forceResize=!0},bindSequenceControls:function(){var f=e.delegate(this,m),S=e.delegate(this,w),P=e.delegate(this,this.goToNextPage),k=e.delegate(this,this.goToPreviousPage),F=this.navImages,X=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(X=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:O(this.prefixUrl,F.previous.REST),srcGroup:O(this.prefixUrl,F.previous.GROUP),srcHover:O(this.prefixUrl,F.previous.HOVER),srcDown:O(this.prefixUrl,F.previous.DOWN),onRelease:k,onFocus:f,onBlur:S}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:O(this.prefixUrl,F.next.REST),srcGroup:O(this.prefixUrl,F.next.GROUP),srcHover:O(this.prefixUrl,F.next.HOVER),srcDown:O(this.prefixUrl,F.next.DOWN),onRelease:P,onFocus:f,onBlur:S}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),X&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var f=e.delegate(this,H),S=e.delegate(this,V),P=e.delegate(this,ce),k=e.delegate(this,z),F=e.delegate(this,ae),X=e.delegate(this,$e),U=e.delegate(this,et),he=e.delegate(this,qe),me=e.delegate(this,at),we=e.delegate(this,lt),ee=e.delegate(this,m),_e=e.delegate(this,w),v=this.navImages,g=[],b=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(b=!1),this.showZoomControl&&(g.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:O(this.prefixUrl,v.zoomIn.REST),srcGroup:O(this.prefixUrl,v.zoomIn.GROUP),srcHover:O(this.prefixUrl,v.zoomIn.HOVER),srcDown:O(this.prefixUrl,v.zoomIn.DOWN),onPress:f,onRelease:S,onClick:P,onEnter:f,onExit:S,onFocus:ee,onBlur:_e})),g.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:O(this.prefixUrl,v.zoomOut.REST),srcGroup:O(this.prefixUrl,v.zoomOut.GROUP),srcHover:O(this.prefixUrl,v.zoomOut.HOVER),srcDown:O(this.prefixUrl,v.zoomOut.DOWN),onPress:k,onRelease:S,onClick:F,onEnter:k,onExit:S,onFocus:ee,onBlur:_e}))),this.showHomeControl&&g.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:O(this.prefixUrl,v.home.REST),srcGroup:O(this.prefixUrl,v.home.GROUP),srcHover:O(this.prefixUrl,v.home.HOVER),srcDown:O(this.prefixUrl,v.home.DOWN),onRelease:X,onFocus:ee,onBlur:_e})),this.showFullPageControl&&g.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:O(this.prefixUrl,v.fullpage.REST),srcGroup:O(this.prefixUrl,v.fullpage.GROUP),srcHover:O(this.prefixUrl,v.fullpage.HOVER),srcDown:O(this.prefixUrl,v.fullpage.DOWN),onRelease:U,onFocus:ee,onBlur:_e})),this.showRotationControl&&(g.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:O(this.prefixUrl,v.rotateleft.REST),srcGroup:O(this.prefixUrl,v.rotateleft.GROUP),srcHover:O(this.prefixUrl,v.rotateleft.HOVER),srcDown:O(this.prefixUrl,v.rotateleft.DOWN),onRelease:he,onFocus:ee,onBlur:_e})),g.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:O(this.prefixUrl,v.rotateright.REST),srcGroup:O(this.prefixUrl,v.rotateright.GROUP),srcHover:O(this.prefixUrl,v.rotateright.HOVER),srcDown:O(this.prefixUrl,v.rotateright.DOWN),onRelease:me,onFocus:ee,onBlur:_e}))),this.showFlipControl&&g.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:O(this.prefixUrl,v.flip.REST),srcGroup:O(this.prefixUrl,v.flip.GROUP),srcHover:O(this.prefixUrl,v.flip.HOVER),srcDown:O(this.prefixUrl,v.flip.DOWN),onRelease:we,onFocus:ee,onBlur:_e})),b?(this.buttonGroup=new e.ButtonGroup({buttons:g,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",e.delegate(this,Qe)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT})):this.customButtons=g),this},currentPage:function(){return this._sequenceIndex},goToPage:function(f){return this.tileSources&&f>=0&&f<this.tileSources.length&&(this._sequenceIndex=f,this._updateSequenceButtons(f),this.open(this.tileSources[f]),this.referenceStrip&&this.referenceStrip.setFocus(f),this.raiseEvent("page",{page:f})),this},addOverlay:function(f,S,P,k){var F;if(e.isPlainObject(f)?F=f:F={element:f,location:S,placement:P,onDraw:k},f=e.getElement(F.element),a(this.currentOverlays,f)>=0)return this;var X=s(this,F);return this.currentOverlays.push(X),X.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:f,location:F.location,placement:F.placement}),this},updateOverlay:function(f,S,P){var k;return f=e.getElement(f),k=a(this.currentOverlays,f),k>=0&&(this.currentOverlays[k].update(S,P),n[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:f,location:S,placement:P})),this},removeOverlay:function(f){var S;return f=e.getElement(f),S=a(this.currentOverlays,f),S>=0&&(this.currentOverlays[S].destroy(),this.currentOverlays.splice(S,1),n[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:f})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return n[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(f){var S;return f=e.getElement(f),S=a(this.currentOverlays,f),S>=0?this.currentOverlays[S]:null},_updateSequenceButtons:function(f){this.nextButton&&(!this.tileSources||this.tileSources.length-1===f?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(f>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(f){this._hideMessage();var S=e.makeNeutralElement("div");S.appendChild(document.createTextNode(f)),this.messageDiv=e.makeCenteredNode(S),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var f=this.messageDiv;f&&(f.parentNode.removeChild(f),delete this.messageDiv)},gestureSettingsByDeviceType:function(f){switch(f){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var f,S=this.currentOverlays.length;for(f=0;f<S;f++)this.currentOverlays[f].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),e.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){e.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var f=e.pixelDensityRatio,S=e.getCurrentPixelDensityRatio();f!==S&&(e.pixelDensityRatio=S,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var f=this._sequenceIndex-1;this.navPrevNextWrap&&f<0&&(f+=this.tileSources.length),this.goToPage(f)},goToNextPage:function(){var f=this._sequenceIndex+1;this.navPrevNextWrap&&f>=this.tileSources.length&&(f=0),this.goToPage(f)},isAnimating:function(){return n[this.hash].animating}});function o(f){return f=e.getElement(f),new e.Point(f.clientWidth===0?1:f.clientWidth,f.clientHeight===0?1:f.clientHeight)}function l(f,S,P,k,F){var X=f;if(e.type(S)==="string"){if(S.match(/^\s*<.*>\s*$/))S=e.parseXml(S);else if(S.match(/^\s*[{[].*[}\]]\s*$/))try{var U=e.parseJSON(S);S=U}catch{}}function he(me,we){me.ready?k(me):(me.addHandler("ready",function(){k(me)}),me.addHandler("open-failed",function(ee){F({message:ee.message,source:we})}))}setTimeout(function(){if(e.type(S)==="string")S=new e.TileSource({url:S,crossOriginPolicy:P.crossOriginPolicy!==void 0?P.crossOriginPolicy:f.crossOriginPolicy,ajaxWithCredentials:f.ajaxWithCredentials,ajaxHeaders:P.ajaxHeaders?P.ajaxHeaders:f.ajaxHeaders,splitHashDataForPost:f.splitHashDataForPost,useCanvas:f.useCanvas,success:function(_e){k(_e.tileSource)}}),S.addHandler("open-failed",function(_e){F(_e)});else if(e.isPlainObject(S)||S.nodeType)if(S.crossOriginPolicy===void 0&&(P.crossOriginPolicy!==void 0||f.crossOriginPolicy!==void 0)&&(S.crossOriginPolicy=P.crossOriginPolicy!==void 0?P.crossOriginPolicy:f.crossOriginPolicy),S.ajaxWithCredentials===void 0&&(S.ajaxWithCredentials=f.ajaxWithCredentials),S.useCanvas===void 0&&(S.useCanvas=f.useCanvas),e.isFunction(S.getTileUrl)){var me=new e.TileSource(S);me.getTileUrl=S.getTileUrl,k(me)}else{var we=e.TileSource.determineType(X,S);if(!we){F({message:"Unable to load TileSource",source:S});return}var ee=we.prototype.configure.apply(X,[S]);he(new we(ee),S)}else he(S,S)})}function s(f,S){if(S instanceof e.Overlay)return S;var P=null;if(S.element)P=e.getElement(S.element);else{var k=S.id?S.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);P=e.getElement(S.id),P||(P=document.createElement("a"),P.href="#/overlay/"+k),P.id=k,e.addClass(P,S.className?S.className:"openseadragon-overlay")}var F=S.location,X=S.width,U=S.height;if(!F){var he=S.x,me=S.y;if(S.px!==void 0){var we=f.viewport.imageToViewportRectangle(new e.Rect(S.px,S.py,X||0,U||0));he=we.x,me=we.y,X=X!==void 0?we.width:void 0,U=U!==void 0?we.height:void 0}F=new e.Point(he,me)}var ee=S.placement;return ee&&e.type(ee)==="string"&&(ee=e.Placement[S.placement.toUpperCase()]),new e.Overlay({element:P,location:F,placement:ee,onDraw:S.onDraw,checkResize:S.checkResize,width:X,height:U,rotationMode:S.rotationMode})}function a(f,S){var P;for(P=f.length-1;P>=0;P--)if(f[P].element===S)return P;return-1}function u(f,S){return e.requestAnimationFrame(function(){S(f)})}function c(f){e.requestAnimationFrame(function(){d(f)})}function h(f){!f.autoHideControls||(f.controlsShouldFade=!0,f.controlsFadeBeginTime=e.now()+f.controlsFadeDelay,window.setTimeout(function(){c(f)},f.controlsFadeDelay))}function d(f){var S,P,k,F;if(f.controlsShouldFade){for(S=e.now(),P=S-f.controlsFadeBeginTime,k=1-P/f.controlsFadeLength,k=Math.min(1,k),k=Math.max(0,k),F=f.controls.length-1;F>=0;F--)f.controls[F].autoFade&&f.controls[F].setOpacity(k);k>0&&c(f)}}function p(f){var S;for(f.controlsShouldFade=!1,S=f.controls.length-1;S>=0;S--)f.controls[S].setOpacity(1)}function m(){p(this)}function w(){h(this)}function y(f){var S={tracker:f.eventSource,position:f.position,originalEvent:f.originalEvent,preventDefault:f.preventDefault};this.raiseEvent("canvas-contextmenu",S),f.preventDefault=S.preventDefault}function E(f){var S={originalEvent:f.originalEvent,preventDefaultAction:!1,preventVerticalPan:f.preventVerticalPan||!this.panVertical,preventHorizontalPan:f.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",S),!S.preventDefaultAction&&!f.ctrl&&!f.alt&&!f.meta)switch(f.keyCode){case 38:S.preventVerticalPan||(f.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 40:S.preventVerticalPan||(f.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 37:S.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 39:S.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 87:S.preventVerticalPan||(f.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 83:S.preventVerticalPan||(f.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 65:S.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 68:S.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 82:f.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),f.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:f.preventDefault=!1;break}else f.preventDefault=!1}function T(f){var S={originalEvent:f.originalEvent};this.raiseEvent("canvas-key-press",S)}function C(f){var S,P=document.activeElement===this.canvas;P||this.canvas.focus(),this.viewport.flipped&&(f.position.x=this.viewport.getContainerSize().x-f.position.x);var k={tracker:f.eventSource,position:f.position,quick:f.quick,shift:f.shift,originalEvent:f.originalEvent,originalTarget:f.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",k),!k.preventDefaultAction&&this.viewport&&f.quick&&(S=this.gestureSettingsByDeviceType(f.pointerType),S.clickToZoom===!0&&(this.viewport.zoomBy(f.shift?1/this.zoomPerClick:this.zoomPerClick,S.zoomToRefPoint?this.viewport.pointFromPixel(f.position,!0):null),this.viewport.applyConstraints()),S.dblClickDragToZoom&&(n[this.hash].draggingToZoom===!0?(n[this.hash].lastClickTime=null,n[this.hash].draggingToZoom=!1):n[this.hash].lastClickTime=e.now()))}function B(f){var S,P={tracker:f.eventSource,position:f.position,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",P),!P.preventDefaultAction&&this.viewport&&(S=this.gestureSettingsByDeviceType(f.pointerType),S.dblClickToZoom&&(this.viewport.zoomBy(f.shift?1/this.zoomPerClick:this.zoomPerClick,S.zoomToRefPoint?this.viewport.pointFromPixel(f.position,!0):null),this.viewport.applyConstraints()))}function M(f){var S,P={tracker:f.eventSource,pointerType:f.pointerType,position:f.position,delta:f.delta,speed:f.speed,direction:f.direction,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",P),S=this.gestureSettingsByDeviceType(f.pointerType),!P.preventDefaultAction&&this.viewport){if(S.dblClickDragToZoom&&n[this.hash].draggingToZoom){var k=Math.pow(this.zoomPerDblClickDrag,f.delta.y/50);this.viewport.zoomBy(k)}else if(S.dragToPan&&!n[this.hash].draggingToZoom){if(this.panHorizontal||(f.delta.x=0),this.panVertical||(f.delta.y=0),this.viewport.flipped&&(f.delta.x=-f.delta.x),this.constrainDuringPan){var F=this.viewport.deltaPointsFromPixels(f.delta.negate());this.viewport.centerSpringX.target.value+=F.x,this.viewport.centerSpringY.target.value+=F.y;var X=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=F.x,this.viewport.centerSpringY.target.value-=F.y,X.xConstrained&&(f.delta.x=0),X.yConstrained&&(f.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(f.delta.negate()),S.flickEnabled&&!this.constrainDuringPan)}}}function N(f){var S,P={tracker:f.eventSource,pointerType:f.pointerType,position:f.position,speed:f.speed,direction:f.direction,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",P),S=this.gestureSettingsByDeviceType(f.pointerType),!P.preventDefaultAction&&this.viewport){if(!n[this.hash].draggingToZoom&&S.flickEnabled&&f.speed>=S.flickMinSpeed){var k=0;this.panHorizontal&&(k=S.flickMomentum*f.speed*Math.cos(f.direction));var F=0;this.panVertical&&(F=S.flickMomentum*f.speed*Math.sin(f.direction));var X=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),U=this.viewport.pointFromPixel(new e.Point(X.x-k,X.y-F));this.viewport.panTo(U,!1)}this.viewport.applyConstraints()}S.dblClickDragToZoom&&n[this.hash].draggingToZoom===!0&&(n[this.hash].draggingToZoom=!1)}function I(f){this.raiseEvent("canvas-enter",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function G(f){this.raiseEvent("canvas-exit",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function W(f){var S;if(this.raiseEvent("canvas-press",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,insideElementPressed:f.insideElementPressed,insideElementReleased:f.insideElementReleased,originalEvent:f.originalEvent}),S=this.gestureSettingsByDeviceType(f.pointerType),S.dblClickDragToZoom){var P=n[this.hash].lastClickTime,k=e.now();if(P===null)return;k-P<this.dblClickTimeThreshold&&(n[this.hash].draggingToZoom=!0),n[this.hash].lastClickTime=null}}function ne(f){this.raiseEvent("canvas-release",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,insideElementPressed:f.insideElementPressed,insideElementReleased:f.insideElementReleased,originalEvent:f.originalEvent})}function Q(f){this.raiseEvent("canvas-nonprimary-press",{tracker:f.eventSource,position:f.position,pointerType:f.pointerType,button:f.button,buttons:f.buttons,originalEvent:f.originalEvent})}function $(f){this.raiseEvent("canvas-nonprimary-release",{tracker:f.eventSource,position:f.position,pointerType:f.pointerType,button:f.button,buttons:f.buttons,originalEvent:f.originalEvent})}function oe(f){var S,P,k,F,X={tracker:f.eventSource,pointerType:f.pointerType,gesturePoints:f.gesturePoints,lastCenter:f.lastCenter,center:f.center,lastDistance:f.lastDistance,distance:f.distance,shift:f.shift,originalEvent:f.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",X),this.viewport&&(S=this.gestureSettingsByDeviceType(f.pointerType),S.pinchToZoom&&(!X.preventDefaultPanAction||!X.preventDefaultZoomAction)&&(P=this.viewport.pointFromPixel(f.center,!0),S.zoomToRefPoint&&!X.preventDefaultPanAction&&(k=this.viewport.pointFromPixel(f.lastCenter,!0),F=k.minus(P),this.panHorizontal||(F.x=0),this.panVertical||(F.y=0),this.viewport.panBy(F,!0)),X.preventDefaultZoomAction||this.viewport.zoomBy(f.distance/f.lastDistance,P,!0),this.viewport.applyConstraints()),S.pinchRotate&&!X.preventDefaultRotateAction)){var U=Math.atan2(f.gesturePoints[0].currentPos.y-f.gesturePoints[1].currentPos.y,f.gesturePoints[0].currentPos.x-f.gesturePoints[1].currentPos.x),he=Math.atan2(f.gesturePoints[0].lastPos.y-f.gesturePoints[1].lastPos.y,f.gesturePoints[0].lastPos.x-f.gesturePoints[1].lastPos.x);P=this.viewport.pointFromPixel(f.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(U-he)*(180/Math.PI),P,!0)}}function ve(f){this.raiseEvent("canvas-focus",{tracker:f.eventSource,originalEvent:f.originalEvent})}function Ue(f){this.raiseEvent("canvas-blur",{tracker:f.eventSource,originalEvent:f.originalEvent})}function ye(f){var S,P,k,F,X;F=e.now(),X=F-this._lastScrollTime,X>this.minScrollDeltaTime?(this._lastScrollTime=F,S={tracker:f.eventSource,position:f.position,scroll:f.scroll,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",S),!S.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(f.position.x=this.viewport.getContainerSize().x-f.position.x),P=this.gestureSettingsByDeviceType(f.pointerType),P.scrollToZoom&&(k=Math.pow(this.zoomPerScroll,f.scroll),this.viewport.zoomBy(k,P.zoomToRefPoint?this.viewport.pointFromPixel(f.position,!0):null),this.viewport.applyConstraints())),f.preventDefault=S.preventDefault):f.preventDefault=!0}function pe(f){n[this.hash].mouseInside=!0,p(this),this.raiseEvent("container-enter",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function Ge(f){f.pointers<1&&(n[this.hash].mouseInside=!1,n[this.hash].animating||h(this)),this.raiseEvent("container-exit",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function De(f){st(f),f.isOpen()?f._updateRequestId=u(f,De):f._updateRequestId=!1}function Ee(f,S){var P=f.viewport,k=P.getZoom(),F=P.getCenter();P.resize(S,f.preserveImageSizeOnResize),P.panTo(F,!0);var X;if(f.preserveImageSizeOnResize)X=n[f.hash].prevContainerSize.x/S.x;else{var U=new e.Point(0,0),he=new e.Point(n[f.hash].prevContainerSize.x,n[f.hash].prevContainerSize.y).distanceTo(U),me=new e.Point(S.x,S.y).distanceTo(U);X=me/he*n[f.hash].prevContainerSize.x/S.x}P.zoomTo(k*X,null,!0),n[f.hash].prevContainerSize=S,n[f.hash].forceRedraw=!0,n[f.hash].needsResize=!1,n[f.hash].forceResize=!1}function st(f){if(!(f._opening||!n[f.hash])){if(f.autoResize||n[f.hash].forceResize){var S;if(f._autoResizePolling){S=o(f.container);var P=n[f.hash].prevContainerSize;S.equals(P)||(n[f.hash].needsResize=!0)}n[f.hash].needsResize&&Ee(f,S||o(f.container))}var k=f.viewport.update(),F=f.world.update()||k;k&&f.raiseEvent("viewport-change"),f.referenceStrip&&(F=f.referenceStrip.update(f.viewport)||F);var X=n[f.hash].animating;!X&&F&&(f.raiseEvent("animation-start"),p(f));var U=X&&!F;U&&(n[f.hash].animating=!1),(F||U||n[f.hash].forceRedraw||f.world.needsDraw())&&(D(f),f._drawOverlays(),f.navigator&&f.navigator.update(f.viewport),n[f.hash].forceRedraw=!1,F&&f.raiseEvent("animation")),U&&(f.raiseEvent("animation-finish"),n[f.hash].mouseInside||h(f)),n[f.hash].animating=F}}function D(f){f.imageLoader.clear(),f.drawer.clear(),f.world.draw(),f.raiseEvent("update-viewport",{})}function O(f,S){return f?f+S:S}function H(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=this.zoomPerSecond,n[this.hash].zooming=!0,q(this)}function z(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=1/this.zoomPerSecond,n[this.hash].zooming=!0,q(this)}function V(){n[this.hash].zooming=!1}function q(f){e.requestAnimationFrame(e.delegate(f,te))}function te(){var f,S,P;n[this.hash].zooming&&this.viewport&&(f=e.now(),S=f-n[this.hash].lastZoomTime,P=Math.pow(n[this.hash].zoomFactor,S/1e3),this.viewport.zoomBy(P),this.viewport.applyConstraints(),n[this.hash].lastZoomTime=f,q(this))}function ce(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function ae(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function Qe(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function $e(){this.viewport&&this.viewport.goHome()}function et(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function qe(){if(this.viewport){var f=this.viewport.getRotation();this.viewport.flipped?f+=this.rotationIncrement:f-=this.rotationIncrement,this.viewport.setRotation(f)}}function at(){if(this.viewport){var f=this.viewport.getRotation();this.viewport.flipped?f-=this.rotationIncrement:f+=this.rotationIncrement,this.viewport.setRotation(f)}}function lt(){this.viewport.toggleFlip()}}(t),function(e){e.Navigator=function(u){var c=u.viewer,h=this,d,p;u.element||u.id?(u.element?(u.id&&e.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),u.element.id?u.id=u.element.id:u.id="navigator-"+e.now(),this.element=u.element):this.element=document.getElementById(u.id),u.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(u.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),u.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:u.autoFade},u.position&&(u.position==="BOTTOM_RIGHT"?u.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:u.position==="BOTTOM_LEFT"?u.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:u.position==="TOP_RIGHT"?u.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:u.position==="TOP_LEFT"?u.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:u.position==="ABSOLUTE"&&(u.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,u.controlOptions.top=u.top,u.controlOptions.left=u.left,u.controlOptions.height=u.height,u.controlOptions.width=u.width))),this.element.id=u.id,this.element.className+=" navigator",u=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},u,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:u.animationTime,autoResize:!1,minZoomImageRatio:1,background:u.background,opacity:u.opacity,borderColor:u.borderColor,displayRegionColor:u.displayRegionColor}),u.minPixelRatio=this.minPixelRatio=c.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),u.controlOptions.anchor!==e.ControlAnchor.NONE&&function(y,E){y.margin="0px",y.border=E+"px solid "+u.borderColor,y.padding="0px",y.background=u.background,y.opacity=u.opacity,y.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(y,E){y.position="relative",y.top="0px",y.left="0px",y.fontSize="0px",y.overflow="hidden",y.border=E+"px solid "+u.displayRegionColor,y.margin="0px",y.padding="0px",y.background="transparent",y.float="left",y.cssFloat="left",y.styleFloat="left",y.zIndex=999999999,y.cursor="default",y.boxSizing="content-box"}(this.displayRegion.style,this.borderWidth),e.setElementPointerEventsNone(this.displayRegion),e.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",e.setElementPointerEventsNone(this.displayRegionContainer),e.setElementTouchActionNone(this.displayRegionContainer),c.addControl(this.element,u.controlOptions),this._resizeWithViewer=u.controlOptions.anchor!==e.ControlAnchor.ABSOLUTE&&u.controlOptions.anchor!==e.ControlAnchor.NONE,u.width&&u.height?(this.setWidth(u.width),this.setHeight(u.height)):this._resizeWithViewer&&(d=e.getElementSize(c.element),this.element.style.height=Math.round(d.y*u.sizeRatio)+"px",this.element.style.width=Math.round(d.x*u.sizeRatio)+"px",this.oldViewerSize=d,p=e.getElementSize(this.element),this.elementArea=p.x*p.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[u]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function m(y,E){s(h.displayRegionContainer,y),s(h.displayRegion,-y),h.viewport.setRotation(y,E)}if(u.navigatorRotate){var w=u.viewer.viewport?u.viewer.viewport.getRotation():u.viewer.degrees||0;m(w,!0),u.viewer.addHandler("rotate",function(y){m(y.degrees,y.immediately)})}this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:e.delegate(this,r),clickHandler:e.delegate(this,n),releaseHandler:e.delegate(this,o),scrollHandler:e.delegate(this,l),preProcessEventHandler:function(y){y.eventType==="wheel"&&(y.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",e.setElementPointerEventsNone(this.canvas),e.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){h.viewport&&h.viewport.goHome(!0)}),c.world.addHandler("item-index-change",function(y){window.setTimeout(function(){var E=h.world.getItemAt(y.previousIndex);h.world.setItemIndex(E,y.newIndex)},1)}),c.world.addHandler("remove-item",function(y){var E=y.item,T=h._getMatchingItem(E);T&&h.world.removeItem(T)}),this.update(c.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var u=new e.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);u.equals(this.oldContainerSize)||(this.viewport.resize(u,!0),this.viewport.goHome(!0),this.oldContainerSize=u,this.drawer.clear(),this.world.draw())}},setWidth:function(u){this.width=u,this.element.style.width=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(u){this.height=u,this.element.style.height=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(u){return this.viewport.setFlip(u),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(u){a(this.displayRegion,u),a(this.canvas,u),a(this.element,u)},update:function(u){var c,h,d,p,m,w;if(c=e.getElementSize(this.viewer.element),this._resizeWithViewer&&c.x&&c.y&&!c.equals(this.oldViewerSize)&&(this.oldViewerSize=c,this.maintainSizeRatio||!this.elementArea?(h=c.x*this.sizeRatio,d=c.y*this.sizeRatio):(h=Math.sqrt(this.elementArea*(c.x/c.y)),d=this.elementArea/h),this.element.style.width=Math.round(h)+"px",this.element.style.height=Math.round(d)+"px",this.elementArea||(this.elementArea=h*d),this.updateSize()),u&&this.viewport){if(p=u.getBoundsNoRotate(!0),m=this.viewport.pixelFromPointNoRotate(p.getTopLeft(),!1),w=this.viewport.pixelFromPointNoRotate(p.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate){var y=u.getRotation(!0);s(this.displayRegion,-y)}var E=this.displayRegion.style;E.display=this.world.getItemCount()?"block":"none",E.top=m.y.toFixed(2)+"px",E.left=m.x.toFixed(2)+"px";var T=w.x-m.x,C=w.y-m.y;E.width=Math.round(Math.max(T,0))+"px",E.height=Math.round(Math.max(C,0))+"px"}},addTiledImage:function(u){var c=this,h=u.originalTiledImage;delete u.original;var d=e.extend({},u,{success:function(p){var m=p.item;m._originalForNavigator=h,c._matchBounds(m,h,!0),c._matchOpacity(m,h),c._matchCompositeOperation(m,h);function w(){c._matchBounds(m,h)}function y(){c._matchOpacity(m,h)}function E(){c._matchCompositeOperation(m,h)}h.addHandler("bounds-change",w),h.addHandler("clip-change",w),h.addHandler("opacity-change",y),h.addHandler("composite-operation-change",E)}});return e.Viewer.prototype.addTiledImage.apply(this,[d])},destroy:function(){return e.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(u){for(var c=this.world.getItemCount(),h,d=0;d<c;d++)if(h=this.world.getItemAt(d),h._originalForNavigator===u)return h;return null},_matchBounds:function(u,c,h){var d=c.getBoundsNoRotate();u.setPosition(d.getTopLeft(),h),u.setWidth(d.width,h),u.setRotation(c.getRotation(),h),u.setClip(c.getClip()),u.setFlip(c.getFlip())},_matchOpacity:function(u,c){u.setOpacity(c.opacity)},_matchCompositeOperation:function(u,c){u.setCompositeOperation(c.compositeOperation)}});function n(u){var c={tracker:u.eventSource,position:u.position,quick:u.quick,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",c),!c.preventDefaultAction&&u.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(u.position.x=this.viewport.getContainerSize().x-u.position.x);var h=this.viewport.pointFromPixel(u.position);this.panVertical?this.panHorizontal||(h.x=this.viewer.viewport.getCenter(!0).x):h.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(h),this.viewer.viewport.applyConstraints()}}function r(u){var c={tracker:u.eventSource,position:u.position,delta:u.delta,speed:u.speed,direction:u.direction,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",c),!c.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(u.delta.x=0),this.panVertical||(u.delta.y=0),this.viewer.viewport.flipped&&(u.delta.x=-u.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(u.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function o(u){u.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function l(u){var c={tracker:u.eventSource,position:u.position,scroll:u.scroll,shift:u.shift,originalEvent:u.originalEvent,preventDefault:u.preventDefault};this.viewer.raiseEvent("navigator-scroll",c),u.preventDefault=c.preventDefault}function s(u,c){a(u,"rotate("+c+"deg)")}function a(u,c){u.style.webkitTransform=c,u.style.mozTransform=c,u.style.msTransform=c,u.style.oTransform=c,u.style.transform=c}}(t),function(e){var n={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(r){var o=r.split("."),l=null,s=arguments,a=n,u;for(u=0;u<o.length-1;u++)a=a[o[u]]||{};return l=a[o[u]],typeof l!="string"&&(e.console.error("Untranslated source string:",r),l=""),l.replace(/\{\d+\}/g,function(c){var h=parseInt(c.match(/\d+/),10)+1;return h<s.length?s[h]:""})},setString:function(r,o){var l=r.split("."),s=n,a;for(a=0;a<l.length-1;a++)s[l[a]]||(s[l[a]]={}),s=s[l[a]];s[l[a]]=o}})}(t),function(e){e.Point=function(n,r){this.x=typeof n=="number"?n:0,this.y=typeof r=="number"?r:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(n){return new e.Point(this.x+n.x,this.y+n.y)},minus:function(n){return new e.Point(this.x-n.x,this.y-n.y)},times:function(n){return new e.Point(this.x*n,this.y*n)},divide:function(n){return new e.Point(this.x/n,this.y/n)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(n){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))},squaredDistanceTo:function(n){return Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2)},apply:function(n){return new e.Point(n(this.x),n(this.y))},equals:function(n){return n instanceof e.Point&&this.x===n.x&&this.y===n.y},rotate:function(n,r){r=r||new e.Point(0,0);var o,l;if(n%90===0){var s=e.positiveModulo(n,360);switch(s){case 0:o=1,l=0;break;case 90:o=0,l=1;break;case 180:o=-1,l=0;break;case 270:o=0,l=-1;break}}else{var a=n*Math.PI/180;o=Math.cos(a),l=Math.sin(a)}var u=o*(this.x-r.x)-l*(this.y-r.y)+r.x,c=l*(this.x-r.x)+o*(this.y-r.y)+r.y;return new e.Point(u,c)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(t),function(e){e.TileSource=function(r,o,l,s,a,u){var c=this,h=arguments,d,p;if(e.isPlainObject(r)?d=r:d={width:h[0],height:h[1],tileSize:h[2],tileOverlap:h[3],minLevel:h[4],maxLevel:h[5]},e.EventSource.call(this),e.extend(!0,this,d),!this.success){for(p=0;p<arguments.length;p++)if(e.isFunction(arguments[p])){this.success=arguments[p];break}}this.success&&this.addHandler("ready",function(m){c.success(m)}),e.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=d.width&&d.height?d.width/d.height:1,this.dimensions=new e.Point(d.width,d.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=d.tileOverlap?d.tileOverlap:0,this.minLevel=d.minLevel?d.minLevel:0,this.maxLevel=d.maxLevel!==void 0&&d.maxLevel!==null?d.maxLevel:d.width&&d.height?Math.ceil(Math.log(Math.max(d.width,d.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(r){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(r){return this._tileWidth?this._tileWidth:this.getTileSize(r)},getTileHeight:function(r){return this._tileHeight?this._tileHeight:this.getTileSize(r)},setMaxLevel:function(r){this.maxLevel=r,this._memoizeLevelScale()},getLevelScale:function(r){return this._memoizeLevelScale(),this.getLevelScale(r)},_memoizeLevelScale:function(){var r={},o;for(o=0;o<=this.maxLevel;o++)r[o]=1/Math.pow(2,this.maxLevel-o);this.getLevelScale=function(l){return r[l]}},getNumTiles:function(r){var o=this.getLevelScale(r),l=Math.ceil(o*this.dimensions.x/this.getTileWidth(r)),s=Math.ceil(o*this.dimensions.y/this.getTileHeight(r));return new e.Point(l,s)},getPixelRatio:function(r){var o=this.dimensions.times(this.getLevelScale(r)),l=1/o.x*e.pixelDensityRatio,s=1/o.y*e.pixelDensityRatio;return new e.Point(l,s)},getClosestLevel:function(){var r,o;for(r=this.minLevel+1;r<=this.maxLevel&&(o=this.getNumTiles(r),!(o.x>1||o.y>1));r++);return r-1},getTileAtPoint:function(r,o){var l=o.x>=0&&o.x<=1&&o.y>=0&&o.y<=1/this.aspectRatio;e.console.assert(l,"[TileSource.getTileAtPoint] must be called with a valid point.");var s=this.dimensions.x*this.getLevelScale(r),a=o.x*s,u=o.y*s,c=Math.floor(a/this.getTileWidth(r)),h=Math.floor(u/this.getTileHeight(r));o.x>=1&&(c=this.getNumTiles(r).x-1);var d=1e-15;return o.y>=1/this.aspectRatio-d&&(h=this.getNumTiles(r).y-1),new e.Point(c,h)},getTileBounds:function(r,o,l,s){var a=this.dimensions.times(this.getLevelScale(r)),u=this.getTileWidth(r),c=this.getTileHeight(r),h=o===0?0:u*o-this.tileOverlap,d=l===0?0:c*l-this.tileOverlap,p=u+(o===0?1:2)*this.tileOverlap,m=c+(l===0?1:2)*this.tileOverlap,w=1/a.x;return p=Math.min(p,a.x-h),m=Math.min(m,a.y-d),s?new e.Rect(0,0,p,m):new e.Rect(h*w,d*w,p*w,m*w)},getImageInfo:function(r){var o=this,l,s,a,u,c,h,d;r&&(c=r.split("/"),h=c[c.length-1],d=h.lastIndexOf("."),d>-1&&(c[c.length-1]=h.slice(0,d)));var p=null;if(this.splitHashDataForPost){var m=r.indexOf("#");m!==-1&&(p=r.substring(m+1),r=r.substr(0,m))}s=function(w){typeof w=="string"&&(w=e.parseXml(w));var y=e.TileSource.determineType(o,w,r);if(!y){o.raiseEvent("open-failed",{message:"Unable to load TileSource",source:r});return}u=y.prototype.configure.apply(o,[w,r,p]),u.ajaxWithCredentials===void 0&&(u.ajaxWithCredentials=o.ajaxWithCredentials),a=new y(u),o.ready=!0,o.raiseEvent("ready",{tileSource:a})},r.match(/\.js$/)?(l=r.split("/").pop().replace(".js",""),e.jsonp({url:r,async:!1,callbackName:l,callback:s})):e.makeAjaxRequest({url:r,postData:p,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(w){var y=n(w);s(y)},error:function(w,y){var E;try{E="HTTP "+w.status+" attempting to load TileSource: "+r}catch{var T;typeof y=="undefined"||!y.toString?T="Unknown error":T=y.toString(),E=T+" attempting to load TileSource: "+r}e.console.error(E),o.raiseEvent("open-failed",{message:E,source:r,postData:p})}})},supports:function(r,o){return!1},configure:function(r,o,l){throw new Error("Method not implemented.")},getTileUrl:function(r,o,l){throw new Error("Method not implemented.")},getTilePostData:function(r,o,l){return null},getTileAjaxHeaders:function(r,o,l){return{}},getTileHashKey:function(r,o,l,s,a,u){function c(h){return a?h+"+"+JSON.stringify(a):h}return c(typeof s!="string"?r+"/"+o+"_"+l:s)},tileExists:function(r,o,l){var s=this.getNumTiles(r);return r>=this.minLevel&&r<=this.maxLevel&&o>=0&&l>=0&&o<s.x&&l<s.y},hasTransparency:function(r,o,l,s){return!!r||o.match(".png")},downloadTileStart:function(r){var o=r.userData,l=new Image;o.image=l,o.request=null;var s=function(a){if(!l){r.finish(null,o.request,"Image load failed: undefined Image instance.");return}l.onload=l.onerror=l.onabort=null,r.finish(a?null:l,o.request,a)};l.onload=function(){s()},l.onabort=l.onerror=function(){s("Image load aborted.")},r.loadWithAjax?o.request=e.makeAjaxRequest({url:r.src,withCredentials:r.ajaxWithCredentials,headers:r.ajaxHeaders,responseType:"arraybuffer",postData:r.postData,success:function(a){var u;try{u=new window.Blob([a.response])}catch(d){var c=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(d.name==="TypeError"&&c){var h=new c;h.append(a.response),u=h.getBlob()}}u.size===0?s("Empty image response."):l.src=(window.URL||window.webkitURL).createObjectURL(u)},error:function(a){s("Image load aborted - XHR error")}}):(r.crossOriginPolicy!==!1&&(l.crossOrigin=r.crossOriginPolicy),l.src=r.src)},downloadTileAbort:function(r){r.userData.request&&r.userData.request.abort();var o=r.userData.image;r.userData.image&&(o.onload=o.onerror=o.onabort=null)},createTileCache:function(r,o,l){r._data=o},destroyTileCache:function(r){r._data=null,r._renderedContext=null},getTileCacheData:function(r){return r._data},getTileCacheDataAsImage:function(r){return r._data},getTileCacheDataAsContext2D:function(r){if(!r._renderedContext){var o=document.createElement("canvas");o.width=r._data.width,o.height=r._data.height,r._renderedContext=o.getContext("2d"),r._renderedContext.drawImage(r._data,0,0),r._data=null}return r._renderedContext}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype);function n(r){var o=r.responseText,l=r.status,s,a;if(r){if(r.status!==200&&r.status!==0)throw l=r.status,s=l===404?"Not Found":r.statusText,new Error(e.getString("Errors.Status",l,s))}else throw new Error(e.getString("Errors.Security"));if(o.match(/^\s*<.*/))try{a=r.responseXML&&r.responseXML.documentElement?r.responseXML:e.parseXml(o)}catch{a=r.responseText}else if(o.match(/\s*[{[].*/))try{a=e.parseJSON(o)}catch{a=o}else a=o;return a}e.TileSource.determineType=function(r,o,l){var s;for(s in t)if(s.match(/.+TileSource$/)&&e.isFunction(t[s])&&e.isFunction(t[s].prototype.supports)&&t[s].prototype.supports.call(r,o,l))return t[s];return e.console.error("No TileSource was able to open %s %s",l,o),null}}(t),function(e){e.DziTileSource=function(o,l,s,a,u,c,h,d,p){var m,w,y,E;if(e.isPlainObject(o)?E=o:E={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=E.tilesUrl,this.fileFormat=E.fileFormat,this.displayRects=E.displayRects,this.displayRects)for(m=this.displayRects.length-1;m>=0;m--)for(w=this.displayRects[m],y=w.minLevel;y<=w.maxLevel;y++)this._levelRects[y]||(this._levelRects[y]=[]),this._levelRects[y].push(w);e.TileSource.apply(this,[E])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(o,l){var s;return o.Image?s=o.Image.xmlns:o.documentElement&&(o.documentElement.localName==="Image"||o.documentElement.tagName==="Image")&&(s=o.documentElement.namespaceURI),s=(s||"").toLowerCase(),s.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||s.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(o,l,s){var a;return e.isPlainObject(o)?a=r(this,o):a=n(this,o),l&&!a.tilesUrl&&(a.tilesUrl=l.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),l.search(/\.(dzi|xml|js)\?/)!==-1?a.queryParams=l.match(/\?.*/):a.queryParams=""),a},getTileUrl:function(o,l,s){return[this.tilesUrl,o,"/",l,"_",s,".",this.fileFormat,this.queryParams].join("")},tileExists:function(o,l,s){var a=this._levelRects[o],u,c,h,d,p,m,w;if(this.minLevel&&o<this.minLevel||this.maxLevel&&o>this.maxLevel)return!1;if(!a||!a.length)return!0;for(w=a.length-1;w>=0;w--)if(u=a[w],!(o<u.minLevel||o>u.maxLevel)&&(c=this.getLevelScale(o),h=u.x*c,d=u.y*c,p=h+u.width*c,m=d+u.height*c,h=Math.floor(h/this._tileWidth),d=Math.floor(d/this._tileWidth),p=Math.ceil(p/this._tileWidth),m=Math.ceil(m/this._tileWidth),h<=l&&l<p&&d<=s&&s<m))return!0;return!1}});function n(o,l){if(!l||!l.documentElement)throw new Error(e.getString("Errors.Xml"));var s=l.documentElement,a=s.localName||s.tagName,u=l.documentElement.namespaceURI,c=null,h=[],d,p,m,w,y;if(a==="Image")try{if(w=s.getElementsByTagName("Size")[0],w===void 0&&(w=s.getElementsByTagNameNS(u,"Size")[0]),c={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:s.getAttribute("Url"),Format:s.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(s.getAttribute("Overlap"),10),TileSize:parseInt(s.getAttribute("TileSize"),10),Size:{Height:parseInt(w.getAttribute("Height"),10),Width:parseInt(w.getAttribute("Width"),10)}}},!e.imageFormatSupported(c.Image.Format))throw new Error(e.getString("Errors.ImageFormat",c.Image.Format.toUpperCase()));for(d=s.getElementsByTagName("DisplayRect"),d===void 0&&(d=s.getElementsByTagNameNS(u,"DisplayRect")[0]),y=0;y<d.length;y++)p=d[y],m=p.getElementsByTagName("Rect")[0],m===void 0&&(m=p.getElementsByTagNameNS(u,"Rect")[0]),h.push({Rect:{X:parseInt(m.getAttribute("X"),10),Y:parseInt(m.getAttribute("Y"),10),Width:parseInt(m.getAttribute("Width"),10),Height:parseInt(m.getAttribute("Height"),10),MinLevel:parseInt(p.getAttribute("MinLevel"),10),MaxLevel:parseInt(p.getAttribute("MaxLevel"),10)}});return h.length&&(c.Image.DisplayRect=h),r(o,c)}catch(C){throw C instanceof Error?C:new Error(e.getString("Errors.Dzi"))}else{if(a==="Collection")throw new Error(e.getString("Errors.Dzc"));if(a==="Error"){var E=s.getElementsByTagName("Message")[0],T=E.firstChild.nodeValue;throw new Error(T)}}throw new Error(e.getString("Errors.Dzi"))}function r(o,l){var s=l.Image,a=s.Url,u=s.Format,c=s.Size,h=s.DisplayRect||[],d=parseInt(c.Width,10),p=parseInt(c.Height,10),m=parseInt(s.TileSize,10),w=parseInt(s.Overlap,10),y=[],E,T;for(T=0;T<h.length;T++)E=h[T].Rect,y.push(new e.DisplayRect(parseInt(E.X,10),parseInt(E.Y,10),parseInt(E.Width,10),parseInt(E.Height,10),parseInt(E.MinLevel,10),parseInt(E.MaxLevel,10)));return e.extend(!0,{width:d,height:p,tileSize:m,tileOverlap:w,minLevel:null,maxLevel:null,tilesUrl:a,fileFormat:u,displayRects:y},l)}}(t),function(e){e.IIIFTileSource=function(s){if(e.extend(!0,this,s),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(s.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=s.version,this.tile_width&&this.tile_height)s.tileWidth=this.tile_width,s.tileHeight=this.tile_height;else if(this.tile_width)s.tileSize=this.tile_width;else if(this.tile_height)s.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)s.tileWidth=this.tiles[0].width,s.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var a=0;a<this.tiles.length;a++)for(var u=0;u<this.tiles[a].scaleFactors.length;u++){var c=this.tiles[a].scaleFactors[u];this.scale_factors.push(c),s.tileSizePerScaleFactor[c]={width:this.tiles[a].width,height:this.tiles[a].height||this.tiles[a].width}}}else if(n(s)){for(var h=Math.min(this.height,this.width),d=[256,512,1024],p=[],m=0;m<d.length;m++)d[m]<=h&&p.push(d[m]);p.length>0?s.tileSize=Math.max.apply(null,p):s.tileSize=h}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,s.levels=r(this),e.extend(!0,s,{width:s.levels[s.levels.length-1].width,height:s.levels[s.levels.length-1].height,tileSize:Math.max(s.height,s.width),tileOverlap:0,minLevel:0,maxLevel:s.levels.length-1}),this.levels=s.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!s.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)s.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var w=Math.max.apply(null,this.scale_factors);s.maxLevel=Math.round(Math.log(w)*Math.LOG2E)}if(this.sizes){var y=this.sizes.length;(y===s.maxLevel||y===s.maxLevel+1)&&(this.levelSizes=this.sizes,y===s.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))}e.TileSource.apply(this,[s])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(s,a){return s.protocol&&s.protocol==="http://iiif.io/api/image"||s["@context"]&&(s["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||s["@context"]==="http://iiif.io/api/image/1/context.json")||s.profile&&s.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||s.identifier&&s.width&&s.height?!0:!!(s.documentElement&&s.documentElement.tagName==="info"&&s.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(s,a,u){if(e.isPlainObject(s)){if(!s["@context"])s["@context"]="http://iiif.io/api/image/1.0/context.json",s["@id"]=a.replace("/info.json",""),s.version=1;else{var h=s["@context"];if(Array.isArray(h)){for(var d=0;d<h.length;d++)if(typeof h[d]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(h[d])||h[d]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){h=h[d];break}}switch(h){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":s.version=1;break;case"http://iiif.io/api/image/2/context.json":s.version=2;break;case"http://iiif.io/api/image/3/context.json":s.version=3;break;default:e.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(s.preferredFormats){for(var p=0;p<s.preferredFormats.length;p++)if(t.imageFormatSupported(s.preferredFormats[p])){s.tileFormat=s.preferredFormats[p];break}}return s}else{var c=o(s);return c["@context"]="http://iiif.io/api/image/1.0/context.json",c["@id"]=a.replace("/info.xml",""),c.version=1,c}},getTileWidth:function(s){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,s);var a=Math.pow(2,this.maxLevel-s);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[a]?this.tileSizePerScaleFactor[a].width:this._tileWidth},getTileHeight:function(s){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,s);var a=Math.pow(2,this.maxLevel-s);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[a]?this.tileSizePerScaleFactor[a].height:this._tileHeight},getLevelScale:function(s){if(this.emulateLegacyImagePyramid){var a=NaN;return this.levels.length>0&&s>=this.minLevel&&s<=this.maxLevel&&(a=this.levels[s].width/this.levels[this.maxLevel].width),a}return e.TileSource.prototype.getLevelScale.call(this,s)},getNumTiles:function(s){if(this.emulateLegacyImagePyramid){var a=this.getLevelScale(s);return a?new e.Point(1,1):new e.Point(0,0)}if(this.levelSizes){var u=this.levelSizes[s],c=Math.ceil(u.width/this.getTileWidth(s)),h=Math.ceil(u.height/this.getTileHeight(s));return new e.Point(c,h)}else return e.TileSource.prototype.getNumTiles.call(this,s)},getTileAtPoint:function(s,a){if(this.emulateLegacyImagePyramid)return new e.Point(0,0);if(this.levelSizes){var u=a.x>=0&&a.x<=1&&a.y>=0&&a.y<=1/this.aspectRatio;e.console.assert(u,"[TileSource.getTileAtPoint] must be called with a valid point.");var c=this.levelSizes[s].width,h=a.x*c,d=a.y*c,p=Math.floor(h/this.getTileWidth(s)),m=Math.floor(d/this.getTileHeight(s));a.x>=1&&(p=this.getNumTiles(s).x-1);var w=1e-15;return a.y>=1/this.aspectRatio-w&&(m=this.getNumTiles(s).y-1),new e.Point(p,m)}return e.TileSource.prototype.getTileAtPoint.call(this,s,a)},getTileUrl:function(s,a,u){if(this.emulateLegacyImagePyramid){var c=null;return this.levels.length>0&&s>=this.minLevel&&s<=this.maxLevel&&(c=this.levels[s].url),c}var h="0",d=Math.pow(.5,this.maxLevel-s),p,m,w,y,E,T,C,B,M,N,I,G,W,ne,Q,$;return this.levelSizes?(p=this.levelSizes[s].width,m=this.levelSizes[s].height):(p=Math.ceil(this.width*d),m=Math.ceil(this.height*d)),w=this.getTileWidth(s),y=this.getTileHeight(s),E=Math.round(w/d),T=Math.round(y/d),this.version===1?Q="native."+this.tileFormat:Q="default."+this.tileFormat,p<w&&m<y?(this.version===2&&p===this.width?G="full":this.version===3&&p===this.width&&m===this.height?G="max":this.version===3?G=p+","+m:G=p+",",C="full"):(B=a*E,M=u*T,N=Math.min(E,this.width-B),I=Math.min(T,this.height-M),a===0&&u===0&&N===this.width&&I===this.height?C="full":C=[B,M,N,I].join(","),W=Math.min(w,p-a*w),ne=Math.min(y,m-u*y),this.version===2&&W===this.width?G="full":this.version===3&&W===this.width&&ne===this.height?G="max":this.version===3?G=W+","+ne:G=W+","),$=[this._id,C,G,h,Q].join("/"),$},__testonly__:{canBeTiled:n,constructLevels:r}});function n(s){var a=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],u=Array.isArray(s.profile)?s.profile[0]:s.profile,c=a.indexOf(u)!==-1,h=!1;return s.version===2&&s.profile.length>1&&s.profile[1].supports&&(h=s.profile[1].supports.indexOf("sizeByW")!==-1),s.version===3&&s.extraFeatures&&(h=s.extraFeatures.indexOf("sizeByWh")!==-1),!c||h}function r(s){for(var a=[],u=0;u<s.sizes.length;u++)a.push({url:s._id+"/full/"+s.sizes[u].width+","+(s.version===3?s.sizes[u].height:"")+"/0/default."+s.tileFormat,width:s.sizes[u].width,height:s.sizes[u].height});return a.sort(function(c,h){return c.width-h.width})}function o(s){if(!s||!s.documentElement)throw new Error(e.getString("Errors.Xml"));var a=s.documentElement,u=a.tagName,c=null;if(u==="info")try{return c={},l(a,c),c}catch(h){throw h instanceof Error?h:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function l(s,a,u){var c,h;if(s.nodeType===3&&u)h=s.nodeValue.trim(),h.match(/^\d*$/)&&(h=Number(h)),a[u]?(e.isArray(a[u])||(a[u]=[a[u]]),a[u].push(h)):a[u]=h;else if(s.nodeType===1)for(c=0;c<s.childNodes.length;c++)l(s.childNodes[c],a,s.nodeName)}}(t),function(e){e.OsmTileSource=function(n,r,o,l,s){var a;e.isPlainObject(n)?a=n:a={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!a.width||!a.height)&&(a.width=65572864,a.height=65572864),a.tileSize||(a.tileSize=256,a.tileOverlap=0),a.tilesUrl||(a.tilesUrl="http://tile.openstreetmap.org/"),a.minLevel=8,e.TileSource.apply(this,[a])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="openstreetmaps"},configure:function(n,r,o){return n},getTileUrl:function(n,r,o){return this.tilesUrl+(n-8)+"/"+r+"/"+o+".png"}})}(t),function(e){e.TmsTileSource=function(n,r,o,l,s){var a;e.isPlainObject(n)?a=n:a={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var u=Math.ceil(a.width/256)*256,c=Math.ceil(a.height/256)*256,h;u>c?h=u/256:h=c/256,a.maxLevel=Math.ceil(Math.log(h)/Math.log(2))-1,a.tileSize=256,a.width=u,a.height=c,e.TileSource.apply(this,[a])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="tiledmapservice"},configure:function(n,r,o){return n},getTileUrl:function(n,r,o){var l=this.getNumTiles(n).y-1;return this.tilesUrl+n+"/"+r+"/"+(l-o)+".png"}})}(t),function(e){e.ZoomifyTileSource=function(n){typeof n.tileSize=="undefined"&&(n.tileSize=256),typeof n.fileFormat=="undefined"&&(n.fileFormat="jpg",this.fileFormat=n.fileFormat);var r={x:n.width,y:n.height};for(n.imageSizes=[{x:n.width,y:n.height}],n.gridSize=[this._getGridSize(n.width,n.height,n.tileSize)];parseInt(r.x,10)>n.tileSize||parseInt(r.y,10)>n.tileSize;)r.x=Math.floor(r.x/2),r.y=Math.floor(r.y/2),n.imageSizes.push({x:r.x,y:r.y}),n.gridSize.push(this._getGridSize(r.x,r.y,n.tileSize));n.imageSizes.reverse(),n.gridSize.reverse(),n.minLevel=0,n.maxLevel=n.gridSize.length-1,t.TileSource.apply(this,[n])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(n,r,o){return{x:Math.ceil(n/o),y:Math.ceil(r/o)}},_calculateAbsoluteTileNumber:function(n,r,o){for(var l=0,s={},a=0;a<n;a++)s=this.gridSize[a],l+=s.x*s.y;return s=this.gridSize[n],l+=s.x*o+r,l},supports:function(n,r){return n.type&&n.type==="zoomifytileservice"},configure:function(n,r,o){return n},getTileUrl:function(n,r,o){var l=0,s=this._calculateAbsoluteTileNumber(n,r,o);return l=Math.floor(s/256),this.tilesUrl+"TileGroup"+l+"/"+n+"-"+r+"-"+o+"."+this.fileFormat}})}(t),function(e){e.LegacyTileSource=function(l){var s,a,u;e.isArray(l)&&(s={type:"legacy-image-pyramid",levels:l}),s.levels=n(s.levels),s.levels.length>0?(a=s.levels[s.levels.length-1].width,u=s.levels[s.levels.length-1].height):(a=0,u=0,e.console.error("No supported image formats found")),e.extend(!0,s,{width:a,height:u,tileSize:Math.max(u,a),tileOverlap:0,minLevel:0,maxLevel:s.levels.length>0?s.levels.length-1:0}),e.TileSource.apply(this,[s]),this.levels=s.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(l,s){return l.type&&l.type==="legacy-image-pyramid"||l.documentElement&&l.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(l,s,a){var u;return e.isPlainObject(l)?u=o(this,l):u=r(this,l),u},getLevelScale:function(l){var s=NaN;return this.levels.length>0&&l>=this.minLevel&&l<=this.maxLevel&&(s=this.levels[l].width/this.levels[this.maxLevel].width),s},getNumTiles:function(l){var s=this.getLevelScale(l);return s?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(l,s,a){var u=null;return this.levels.length>0&&l>=this.minLevel&&l<=this.maxLevel&&(u=this.levels[l].url),u}});function n(l){var s=[],a,u;for(u=0;u<l.length;u++)a=l[u],a.height&&a.width&&a.url?s.push({url:a.url,width:Number(a.width),height:Number(a.height)}):e.console.error("Unsupported image format: %s",a.url?a.url:"<no URL>");return s.sort(function(c,h){return c.height-h.height})}function r(l,s){if(!s||!s.documentElement)throw new Error(e.getString("Errors.Xml"));var a=s.documentElement,u=a.tagName,c=null,h=[],d,p;if(u==="image")try{for(c={type:a.getAttribute("type"),levels:[]},h=a.getElementsByTagName("level"),p=0;p<h.length;p++)d=h[p],c.levels.push({url:d.getAttribute("url"),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10)});return o(l,c)}catch(m){throw m instanceof Error?m:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(u==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(u==="error")throw new Error("Error: "+s)}throw new Error("Unknown element "+u)}function o(l,s){return s.levels}}(t),function(e){e.ImageTileSource=function(n){n=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},n),e.TileSource.apply(this,[n])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="image"},configure:function(n,r,o){return n},getImageInfo:function(n){var r=this._image=new Image,o=this;this.crossOriginPolicy&&(r.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(r.useCredentials=this.ajaxWithCredentials),e.addEvent(r,"load",function(){o.width=r.naturalWidth,o.height=r.naturalHeight,o.aspectRatio=o.width/o.height,o.dimensions=new e.Point(o.width,o.height),o._tileWidth=o.width,o._tileHeight=o.height,o.tileOverlap=0,o.minLevel=0,o.levels=o._buildLevels(),o.maxLevel=o.levels.length-1,o.ready=!0,o.raiseEvent("ready",{tileSource:o})}),e.addEvent(r,"error",function(){o.raiseEvent("open-failed",{message:"Error loading image at "+n,source:n})}),r.src=n},getLevelScale:function(n){var r=NaN;return n>=this.minLevel&&n<=this.maxLevel&&(r=this.levels[n].width/this.levels[this.maxLevel].width),r},getNumTiles:function(n){var r=this.getLevelScale(n);return r?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(n,r,o){var l=null;return n>=this.minLevel&&n<=this.maxLevel&&(l=this.levels[n].url),l},getContext2D:function(n,r,o){var l=null;return n>=this.minLevel&&n<=this.maxLevel&&(l=this.levels[n].context2D),l},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var n=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,n;var r=this._image.naturalWidth,o=this._image.naturalHeight,l=document.createElement("canvas"),s=l.getContext("2d");if(l.width=r,l.height=o,s.drawImage(this._image,0,0,r,o),n[0].context2D=s,delete this._image,e.isCanvasTainted(l))return n;for(;r>=2&&o>=2;){r=Math.floor(r/2),o=Math.floor(o/2);var a=document.createElement("canvas"),u=a.getContext("2d");a.width=r,a.height=o,u.drawImage(l,0,0,r,o),n.splice(0,0,{context2D:u,width:r,height:o}),l=a,s=u}return n},_freeupCanvasMemory:function(){for(var n=0;n<this.levels.length;n++)this.levels[n].context2D&&(this.levels[n].context2D.canvas.height=0,this.levels[n].context2D.canvas.width=0)}})}(t),function(e){e.TileSourceCollection=function(n,r,o,l){e.console.error("TileSourceCollection is deprecated; use World instead")}}(t),function(e){e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(u){var c=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},u),this.element=u.element||e.makeNeutralElement("div"),u.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,e.setElementPointerEventsNone(this.imgRest),e.setElementPointerEventsNone(this.imgGroup),e.setElementPointerEventsNone(this.imgHover),e.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor===e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(h){h.insideElementPressed?(s(c,e.ButtonState.DOWN),c.raiseEvent("enter",{originalEvent:h.originalEvent})):h.buttonDownAny||s(c,e.ButtonState.HOVER)},focusHandler:function(h){c.tracker.enterHandler(h),c.raiseEvent("focus",{originalEvent:h.originalEvent})},leaveHandler:function(h){a(c,e.ButtonState.GROUP),h.insideElementPressed&&c.raiseEvent("exit",{originalEvent:h.originalEvent})},blurHandler:function(h){c.tracker.leaveHandler(h),c.raiseEvent("blur",{originalEvent:h.originalEvent})},pressHandler:function(h){s(c,e.ButtonState.DOWN),c.raiseEvent("press",{originalEvent:h.originalEvent})},releaseHandler:function(h){h.insideElementPressed&&h.insideElementReleased?(a(c,e.ButtonState.HOVER),c.raiseEvent("release",{originalEvent:h.originalEvent})):h.insideElementPressed?a(c,e.ButtonState.GROUP):s(c,e.ButtonState.HOVER)},clickHandler:function(h){h.quick&&c.raiseEvent("click",{originalEvent:h.originalEvent})},keyHandler:function(h){h.keyCode===13?(c.raiseEvent("click",{originalEvent:h.originalEvent}),c.raiseEvent("release",{originalEvent:h.originalEvent}),h.preventDefault=!0):h.preventDefault=!1}}),a(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){s(this,e.ButtonState.GROUP)},notifyGroupExit:function(){a(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function n(u){e.requestAnimationFrame(function(){r(u)})}function r(u){var c,h,d;u.shouldFade&&(c=e.now(),h=c-u.fadeBeginTime,d=1-h/u.fadeLength,d=Math.min(1,d),d=Math.max(0,d),u.imgGroup&&e.setElementOpacity(u.imgGroup,d,!0),d>0&&n(u))}function o(u){u.shouldFade=!0,u.fadeBeginTime=e.now()+u.fadeDelay,window.setTimeout(function(){n(u)},u.fadeDelay)}function l(u){u.shouldFade=!1,u.imgGroup&&e.setElementOpacity(u.imgGroup,1,!0)}function s(u,c){u.element.disabled||(c>=e.ButtonState.GROUP&&u.currentState===e.ButtonState.REST&&(l(u),u.currentState=e.ButtonState.GROUP),c>=e.ButtonState.HOVER&&u.currentState===e.ButtonState.GROUP&&(u.imgHover&&(u.imgHover.style.visibility=""),u.currentState=e.ButtonState.HOVER),c>=e.ButtonState.DOWN&&u.currentState===e.ButtonState.HOVER&&(u.imgDown&&(u.imgDown.style.visibility=""),u.currentState=e.ButtonState.DOWN))}function a(u,c){u.element.disabled||(c<=e.ButtonState.HOVER&&u.currentState===e.ButtonState.DOWN&&(u.imgDown&&(u.imgDown.style.visibility="hidden"),u.currentState=e.ButtonState.HOVER),c<=e.ButtonState.GROUP&&u.currentState===e.ButtonState.HOVER&&(u.imgHover&&(u.imgHover.style.visibility="hidden"),u.currentState=e.ButtonState.GROUP),c<=e.ButtonState.REST&&u.currentState===e.ButtonState.GROUP&&(o(u),u.currentState=e.ButtonState.REST))}}(t),function(e){e.ButtonGroup=function(n){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},n);var r=this.buttons.concat([]),o=this,l;if(this.element=n.element||e.makeNeutralElement("div"),!n.group)for(this.element.style.display="inline-block",l=0;l<r.length;l++)this.element.appendChild(r[l].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(s){var a;for(a=0;a<o.buttons.length;a++)o.buttons[a].notifyGroupEnter()},leaveHandler:function(s){var a;if(!s.insideElementPressed)for(a=0;a<o.buttons.length;a++)o.buttons[a].notifyGroupExit()}})},e.ButtonGroup.prototype={addButton:function(n){this.buttons.push(n),this.element.appendChild(n.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var n=this.buttons.pop();this.element.removeChild(n.element),n.destroy()}this.tracker.destroy(),this.element=null}}}(t),function(e){e.Rect=function(n,r,o,l,s){this.x=typeof n=="number"?n:0,this.y=typeof r=="number"?r:0,this.width=typeof o=="number"?o:0,this.height=typeof l=="number"?l:0,this.degrees=typeof s=="number"?s:0,this.degrees=e.positiveModulo(this.degrees,360);var a,u;this.degrees>=270?(a=this.getTopRight(),this.x=a.x,this.y=a.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=270):this.degrees>=180?(a=this.getBottomRight(),this.x=a.x,this.y=a.y,this.degrees-=180):this.degrees>=90&&(a=this.getBottomLeft(),this.x=a.x,this.y=a.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=90)},e.Rect.fromSummits=function(n,r,o){var l=n.distanceTo(r),s=n.distanceTo(o),a=r.minus(n),u=Math.atan(a.y/a.x);return a.x<0?u+=Math.PI:a.y<0&&(u+=2*Math.PI),new e.Rect(n.x,n.y,l,s,u/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(n){return n instanceof e.Rect&&this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height&&this.degrees===n.degrees},times:function(n){return new e.Rect(this.x*n,this.y*n,this.width*n,this.height*n,this.degrees)},translate:function(n){return new e.Rect(this.x+n.x,this.y+n.y,this.width,this.height,this.degrees)},union:function(n){var r=this.getBoundingBox(),o=n.getBoundingBox(),l=Math.min(r.x,o.x),s=Math.min(r.y,o.y),a=Math.max(r.x+r.width,o.x+o.width),u=Math.max(r.y+r.height,o.y+o.height);return new e.Rect(l,s,a-l,u-s)},intersection:function(n){var r=1e-10,o=[],l=this.getTopLeft();n.containsPoint(l,r)&&o.push(l);var s=this.getTopRight();n.containsPoint(s,r)&&o.push(s);var a=this.getBottomLeft();n.containsPoint(a,r)&&o.push(a);var u=this.getBottomRight();n.containsPoint(u,r)&&o.push(u);var c=n.getTopLeft();this.containsPoint(c,r)&&o.push(c);var h=n.getTopRight();this.containsPoint(h,r)&&o.push(h);var d=n.getBottomLeft();this.containsPoint(d,r)&&o.push(d);var p=n.getBottomRight();this.containsPoint(p,r)&&o.push(p);for(var m=this._getSegments(),w=n._getSegments(),y=0;y<m.length;y++)for(var E=m[y],T=0;T<w.length;T++){var C=w[T],B=M(E[0],E[1],C[0],C[1]);B&&o.push(B)}function M($,oe,ve,Ue){var ye=oe.minus($),pe=Ue.minus(ve),Ge=-pe.x*ye.y+ye.x*pe.y;if(Ge===0)return null;var De=(ye.x*($.y-ve.y)-ye.y*($.x-ve.x))/Ge,Ee=(pe.x*($.y-ve.y)-pe.y*($.x-ve.x))/Ge;return-r<=De&&De<=1-r&&-r<=Ee&&Ee<=1-r?new e.Point($.x+Ee*ye.x,$.y+Ee*ye.y):null}if(o.length===0)return null;for(var N=o[0].x,I=o[0].x,G=o[0].y,W=o[0].y,ne=1;ne<o.length;ne++){var Q=o[ne];Q.x<N&&(N=Q.x),Q.x>I&&(I=Q.x),Q.y<G&&(G=Q.y),Q.y>W&&(W=Q.y)}return new e.Rect(N,G,I-N,W-G)},_getSegments:function(){var n=this.getTopLeft(),r=this.getTopRight(),o=this.getBottomLeft(),l=this.getBottomRight();return[[n,r],[r,l],[l,o],[o,n]]},rotate:function(n,r){if(n=e.positiveModulo(n,360),n===0)return this.clone();r=r||this.getCenter();var o=this.getTopLeft().rotate(n,r),l=this.getTopRight().rotate(n,r),s=l.minus(o);s=s.apply(function(u){var c=1e-15;return Math.abs(u)<c?0:u});var a=Math.atan(s.y/s.x);return s.x<0?a+=Math.PI:s.y<0&&(a+=2*Math.PI),new e.Rect(o.x,o.y,this.width,this.height,a/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var n=this.getTopLeft(),r=this.getTopRight(),o=this.getBottomLeft(),l=this.getBottomRight(),s=Math.min(n.x,r.x,o.x,l.x),a=Math.max(n.x,r.x,o.x,l.x),u=Math.min(n.y,r.y,o.y,l.y),c=Math.max(n.y,r.y,o.y,l.y);return new e.Rect(s,u,a-s,c-u)},getIntegerBoundingBox:function(){var n=this.getBoundingBox(),r=Math.floor(n.x),o=Math.floor(n.y),l=Math.ceil(n.width+n.x-r),s=Math.ceil(n.height+n.y-o);return new e.Rect(r,o,l,s)},containsPoint:function(n,r){r=r||0;var o=this.getTopLeft(),l=this.getTopRight(),s=this.getBottomLeft(),a=l.minus(o),u=s.minus(o);return(n.x-o.x)*a.x+(n.y-o.y)*a.y>=-r&&(n.x-l.x)*a.x+(n.y-l.y)*a.y<=r&&(n.x-o.x)*u.x+(n.y-o.y)*u.y>=-r&&(n.x-s.x)*u.x+(n.y-s.y)*u.y<=r},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(t),function(e){var n={};e.ReferenceStrip=function(d){var p=this,m=d.viewer,w=e.getElementSize(m.element),y,E,T;for(d.id||(d.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=d.id,this.element.className="referencestrip"),d=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},d,{element:this.element}),e.extend(this,d),n[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,E=this.element.style,E.marginTop="0px",E.marginRight="0px",E.marginBottom="0px",E.marginLeft="0px",E.left="0px",E.bottom="0px",E.border="0px",E.background="#000",E.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=m,this.tracker=new e.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:e.delegate(this,r),dragHandler:e.delegate(this,o),scrollHandler:e.delegate(this,l),enterHandler:e.delegate(this,a),leaveHandler:e.delegate(this,u),keyDownHandler:e.delegate(this,c),keyHandler:e.delegate(this,h),preProcessEventHandler:function(C){C.eventType==="wheel"&&(C.preventDefault=!0)}}),d.width&&d.height?(this.element.style.width=d.width+"px",this.element.style.height=d.height+"px",m.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):d.scroll==="horizontal"?(this.element.style.width=w.x*d.sizeRatio*m.tileSources.length+12*m.tileSources.length+"px",this.element.style.height=w.y*d.sizeRatio+"px",m.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=w.y*d.sizeRatio*m.tileSources.length+12*m.tileSources.length+"px",this.element.style.width=w.x*d.sizeRatio+"px",m.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=w.x*this.sizeRatio+8,this.panelHeight=w.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},T=0;T<m.tileSources.length;T++)y=e.makeNeutralElement("div"),y.id=this.element.id+"-"+T,y.style.width=p.panelWidth+"px",y.style.height=p.panelHeight+"px",y.style.display="inline",y.style.float="left",y.style.cssFloat="left",y.style.styleFloat="left",y.style.padding="2px",e.setElementTouchActionNone(y),e.setElementPointerEventsNone(y),this.element.appendChild(y),y.activePanel=!1,this.panels.push(y);s(this,this.scroll==="vertical"?w.y:w.x,0),this.setFocus(0)},e.ReferenceStrip.prototype={setFocus:function(d){var p=this.element.querySelector("#"+this.element.id+"-"+d),m=e.getElementSize(this.viewer.canvas),w=Number(this.element.style.width.replace("px","")),y=Number(this.element.style.height.replace("px","")),E=-Number(this.element.style.marginLeft.replace("px","")),T=-Number(this.element.style.marginTop.replace("px","")),C;this.currentSelected!==p&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=p,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(C=Number(d)*(this.panelWidth+3),C>E+m.x-this.panelWidth?(C=Math.min(C,w-m.x),this.element.style.marginLeft=-C+"px",s(this,m.x,-C)):C<E&&(C=Math.max(0,C-m.x/2),this.element.style.marginLeft=-C+"px",s(this,m.x,-C))):(C=Number(d)*(this.panelHeight+3),C>T+m.y-this.panelHeight?(C=Math.min(C,y-m.y),this.element.style.marginTop=-C+"px",s(this,m.y,-C)):C<T&&(C=Math.max(0,C-m.y/2),this.element.style.marginTop=-C+"px",s(this,m.y,-C))),this.currentPage=d,a.call(this,{eventSource:this.tracker}))},update:function(){return!!n[this.id].animating},destroy:function(){if(this.miniViewers)for(var d in this.miniViewers)this.miniViewers[d].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function r(d){if(d.quick){var p;this.scroll==="horizontal"?p=Math.floor(d.position.x/(this.panelWidth+4)):p=Math.floor(d.position.y/this.panelHeight),this.viewer.goToPage(p)}this.element.focus()}function o(d){if(this.dragging=!0,this.element){var p=Number(this.element.style.marginLeft.replace("px","")),m=Number(this.element.style.marginTop.replace("px","")),w=Number(this.element.style.width.replace("px","")),y=Number(this.element.style.height.replace("px","")),E=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-d.delta.x>0?p>-(w-E.x)&&(this.element.style.marginLeft=p+d.delta.x*2+"px",s(this,E.x,p+d.delta.x*2)):-d.delta.x<0&&p<0&&(this.element.style.marginLeft=p+d.delta.x*2+"px",s(this,E.x,p+d.delta.x*2)):-d.delta.y>0?m>-(y-E.y)&&(this.element.style.marginTop=m+d.delta.y*2+"px",s(this,E.y,m+d.delta.y*2)):-d.delta.y<0&&m<0&&(this.element.style.marginTop=m+d.delta.y*2+"px",s(this,E.y,m+d.delta.y*2))}}function l(d){if(this.element){var p=Number(this.element.style.marginLeft.replace("px","")),m=Number(this.element.style.marginTop.replace("px","")),w=Number(this.element.style.width.replace("px","")),y=Number(this.element.style.height.replace("px","")),E=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?d.scroll>0?p>-(w-E.x)&&(this.element.style.marginLeft=p-d.scroll*60+"px",s(this,E.x,p-d.scroll*60)):d.scroll<0&&p<0&&(this.element.style.marginLeft=p-d.scroll*60+"px",s(this,E.x,p-d.scroll*60)):d.scroll<0?m>E.y-y&&(this.element.style.marginTop=m+d.scroll*60+"px",s(this,E.y,m+d.scroll*60)):d.scroll>0&&m<0&&(this.element.style.marginTop=m+d.scroll*60+"px",s(this,E.y,m+d.scroll*60)),d.preventDefault=!0}}function s(d,p,m){var w,y,E,T,C,B;for(d.scroll==="horizontal"?w=d.panelWidth:w=d.panelHeight,y=Math.ceil(p/w)+5,E=Math.ceil((Math.abs(m)+p)/w)+1,y=E-y,y=y<0?0:y,C=y;C<E&&C<d.panels.length;C++)if(B=d.panels[C],!B.activePanel){var M,N=d.viewer.tileSources[C];N.referenceStripThumbnailUrl?M={type:"image",url:N.referenceStripThumbnailUrl}:M=N,T=new e.Viewer({id:B.id,tileSources:[M],element:B,navigatorSizeRatio:d.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:d.viewer.loadTilesWithAjax,ajaxHeaders:d.viewer.ajaxHeaders,useCanvas:d.useCanvas}),e.setElementPointerEventsNone(T.canvas),e.setElementPointerEventsNone(T.container),T.innerTracker.setTracking(!1),T.outerTracker.setTracking(!1),d.miniViewers[B.id]=T,B.activePanel=!0}}function a(d){var p=d.eventSource.element;this.scroll==="horizontal"?p.style.marginBottom="0px":p.style.marginLeft="0px"}function u(d){var p=d.eventSource.element;this.scroll==="horizontal"?p.style.marginBottom="-"+e.getElementSize(p).y/2+"px":p.style.marginLeft="-"+e.getElementSize(p).x/2+"px"}function c(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 38:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 40:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 37:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 39:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}function h(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 61:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 45:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 48:case 119:case 87:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 115:case 83:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 97:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 100:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}}(t),function(e){e.DisplayRect=function(n,r,o,l,s,a){e.Rect.apply(this,[n,r,o,l]),this.minLevel=s,this.maxLevel=a},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(t),function(e){e.Spring=function(r){var o=arguments;typeof r!="object"&&(r={initial:o.length&&typeof o[0]=="number"?o[0]:void 0,springStiffness:o.length>1?o[1].springStiffness:5,animationTime:o.length>1?o[1].animationTime:1.5}),e.console.assert(typeof r.springStiffness=="number"&&r.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert(typeof r.animationTime=="number"&&r.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),r.exponential&&(this._exponential=!0,delete r.exponential),e.extend(!0,this,r),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(r){e.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=r,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(r){e.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=r,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(r){this.start.value+=r,this.target.value+=r,this._exponential&&(e.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(r){this._exponential=r,this._exponential&&(e.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=e.now();var r,o;this._exponential?(r=this.start._logValue,o=this.target._logValue):(r=this.start.value,o=this.target.value);var l=this.current.time>=this.target.time?o:r+(o-r)*n(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),s=this.current.value;return this._exponential?this.current.value=Math.exp(l):this.current.value=l,s!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function n(r,o){return(1-Math.exp(r*-o))/(1-Math.exp(-r))}}(t),function(e){e.ImageJob=function(r){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},r),this.data=null,this.userData={},this.errorMsg=null},e.ImageJob.prototype={start:function(){this.tries++;var r=this,o=this.abort;this.jobId=window.setTimeout(function(){r.finish(null,null,"Image load exceeded timeout ("+r.timeout+" ms)")},this.timeout),this.abort=function(){r.source.downloadTileAbort(r),typeof o=="function"&&o()},this.source.downloadTileStart(this)},finish:function(r,o,l){this.data=r,this.request=o,this.errorMsg=l,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(r){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},r)},e.ImageLoader.prototype={addJob:function(r){if(!r.source){e.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var o=e.TileSource.prototype;r.source={downloadTileStart:o.downloadTileStart,downloadTileAbort:o.downloadTileAbort}}var l=this,s=function(c){n(l,c,r.callback)},a={src:r.src,tile:r.tile||{},source:r.source,loadWithAjax:r.loadWithAjax,ajaxHeaders:r.loadWithAjax?r.ajaxHeaders:null,crossOriginPolicy:r.crossOriginPolicy,ajaxWithCredentials:r.ajaxWithCredentials,postData:r.postData,callback:s,abort:r.abort,timeout:this.timeout},u=new e.ImageJob(a);!this.jobLimit||this.jobsInProgress<this.jobLimit?(u.start(),this.jobsInProgress++):this.jobQueue.push(u)},clear:function(){for(var r=0;r<this.jobQueue.length;r++){var o=this.jobQueue[r];typeof o.abort=="function"&&o.abort()}this.jobQueue=[]}};function n(r,o,l){o.errorMsg!==""&&(o.data===null||o.data===void 0)&&o.tries<1+r.tileRetryMax&&r.failedTiles.push(o);var s;r.jobsInProgress--,(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.jobQueue.length>0&&(s=r.jobQueue.shift(),s.start(),r.jobsInProgress++),r.tileRetryMax>0&&r.jobQueue.length===0&&(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.failedTiles.length>0&&(s=r.failedTiles.shift(),setTimeout(function(){s.start()},r.tileRetryDelay),r.jobsInProgress++),l(o.data,o.errorMsg,o.request)}}(t),function(e){e.Tile=function(n,r,o,l,s,a,u,c,h,d,p,m){this.level=n,this.x=r,this.y=o,this.bounds=l,this.sourceBounds=d,this.exists=s,this._url=a,this.postData=p,this.context2D=u,this.loadWithAjax=c,this.ajaxHeaders=h,m===void 0&&(e.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),m=e.TileSource.prototype.getTileHashKey(n,r,o,a,h,p)),this.cacheKey=m,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},drawHTML:function(n){if(!this.cacheImageRecord){e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}if(!this.element){var r=this.getImage();if(!r)return;this.element=e.makeNeutralElement("div"),this.imgElement=r.cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"}this.element.parentNode!==n&&n.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),e.setElementOpacity(this.element,this.opacity)},get image(){return e.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return e.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord.getRenderedContext()},drawCanvas:function(n,r,o,l,s,a){var u=this.position.times(e.pixelDensityRatio),c=this.size.times(e.pixelDensityRatio),h;if(!this.context2D&&!this.cacheImageRecord){e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(h=this.getCanvasContext(),!this.loaded||!h){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}n.save(),n.globalAlpha=this.opacity,typeof o=="number"&&o!==1&&(u=u.times(o),c=c.times(o)),l instanceof e.Point&&(u=u.plus(l)),n.globalAlpha===1&&this.hasTransparency&&(s&&(u.x=Math.round(u.x),u.y=Math.round(u.y),c.x=Math.round(c.x),c.y=Math.round(c.y)),n.clearRect(u.x,u.y,c.x,c.y)),r({context:n,tile:this,rendered:h});var d,p;this.sourceBounds?(d=Math.min(this.sourceBounds.width,h.canvas.width),p=Math.min(this.sourceBounds.height,h.canvas.height)):(d=h.canvas.width,p=h.canvas.height),n.translate(u.x+c.x/2,0),this.flipped&&n.scale(-1,1),n.drawImage(h.canvas,0,0,d,p,-c.x/2,u.y,c.x,c.y),n.restore()},getScaleForEdgeSmoothing:function(){var n;if(this.cacheImageRecord)n=this.cacheImageRecord.getRenderedContext();else if(this.context2D)n=this.context2D;else return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return n.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(n,r,o){var l=Math.max(1,Math.ceil((o.x-r.x)/2)),s=Math.max(1,Math.ceil((o.y-r.y)/2));return new e.Point(l,s).minus(this.position.times(e.pixelDensityRatio).times(n||1).apply(function(a){return a%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(t),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(n,r,o){var l;e.isPlainObject(n)?l=n:l={element:n,location:r,placement:o},this.element=l.element,this.style=l.element.style,this._init(l)},e.Overlay.prototype={_init:function(n){this.location=n.location,this.placement=n.placement===void 0?e.Placement.TOP_LEFT:n.placement,this.onDraw=n.onDraw,this.checkResize=n.checkResize===void 0?!0:n.checkResize,this.width=n.width===void 0?null:n.width,this.height=n.height===void 0?null:n.height,this.rotationMode=n.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(n,r){var o=e.Placement.properties[this.placement];!o||(o.isHorizontallyCentered?n.x-=r.x/2:o.isRight&&(n.x-=r.x),o.isVerticallyCentered?n.y-=r.y/2:o.isBottom&&(n.y-=r.y))},destroy:function(){var n=this.element,r=this.style;n.parentNode&&(n.parentNode.removeChild(n),n.prevElementParent&&(r.display="none",document.body.appendChild(n))),this.onDraw=null,r.top="",r.left="",r.position="",this.width!==null&&(r.width=""),this.height!==null&&(r.height="");var o=e.getCssPropertyWithVendorPrefix("transformOrigin"),l=e.getCssPropertyWithVendorPrefix("transform");o&&l&&(r[o]="",r[l]="")},drawHTML:function(n,r){var o=this.element;o.parentNode!==n&&(o.prevElementParent=o.parentNode,o.prevNextSibling=o.nextSibling,n.appendChild(o),this.style.position="absolute",this.size=e.getElementSize(o));var l=this._getOverlayPositionAndSize(r),s=l.position,a=this.size=l.size,u=l.rotate;if(this.onDraw)this.onDraw(s,a,this.element);else{var c=this.style;c.left=s.x+"px",c.top=s.y+"px",this.width!==null&&(c.width=a.x+"px"),this.height!==null&&(c.height=a.y+"px");var h=e.getCssPropertyWithVendorPrefix("transformOrigin"),d=e.getCssPropertyWithVendorPrefix("transform");h&&d&&(u?(c[h]=this._getTransformOrigin(),c[d]="rotate("+u+"deg)"):(c[h]="",c[d]="")),c.display="block"}},_getOverlayPositionAndSize:function(n){var r=n.pixelFromPoint(this.location,!0),o=this._getSizeInPixels(n);this.adjust(r,o);var l=0;if(n.getRotation(!0)&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var s=new e.Rect(r.x,r.y,o.x,o.y),a=this._getBoundingBox(s,n.getRotation(!0));r=a.getTopLeft(),o=a.getSize()}else l=n.getRotation(!0);return{position:r,size:o,rotate:l}},_getSizeInPixels:function(n){var r=this.size.x,o=this.size.y;if(this.width!==null||this.height!==null){var l=n.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);this.width!==null&&(r=l.x),this.height!==null&&(o=l.y)}if(this.checkResize&&(this.width===null||this.height===null)){var s=this.size=e.getElementSize(this.element);this.width===null&&(r=s.x),this.height===null&&(o=s.y)}return new e.Point(r,o)},_getBoundingBox:function(n,r){var o=this._getPlacementPoint(n);return n.rotate(r,o).getBoundingBox()},_getPlacementPoint:function(n){var r=new e.Point(n.x,n.y),o=e.Placement.properties[this.placement];return o&&(o.isHorizontallyCentered?r.x+=n.width/2:o.isRight&&(r.x+=n.width),o.isVerticallyCentered?r.y+=n.height/2:o.isBottom&&(r.y+=n.height)),r},_getTransformOrigin:function(){var n="",r=e.Placement.properties[this.placement];return r&&(r.isLeft?n="left":r.isRight&&(n="right"),r.isTop?n+=" top":r.isBottom&&(n+=" bottom")),n},update:function(n,r){var o=e.isPlainObject(n)?n:{location:n,placement:r};this._init({location:o.location||this.location,placement:o.placement!==void 0?o.placement:this.placement,onDraw:o.onDraw||this.onDraw,checkResize:o.checkResize||this.checkResize,width:o.width!==void 0?o.width:this.width,height:o.height!==void 0?o.height:this.height,rotationMode:o.rotationMode||this.rotationMode})},getBounds:function(n){e.console.assert(n,"A viewport must now be passed to Overlay.getBounds.");var r=this.width,o=this.height;if(r===null||o===null){var l=n.deltaPointsFromPixelsNoRotate(this.size,!0);r===null&&(r=l.x),o===null&&(o=l.y)}var s=this.location.clone();return this.adjust(s,new e.Point(r,o)),this._adjustBoundsForRotation(n,new e.Rect(s.x,s.y,r,o))},_adjustBoundsForRotation:function(n,r){if(!n||n.getRotation(!0)===0||this.rotationMode===e.OverlayRotationMode.EXACT)return r;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return r;var o=this._getOverlayPositionAndSize(n);return n.viewerElementToViewportRectangle(new e.Rect(o.position.x,o.position.y,o.size.x,o.size.y))}return r.rotate(-n.getRotation(!0),this._getPlacementPoint(r))}}}(t),function(e){e.Drawer=function(n){e.console.assert(n.viewer,"[Drawer] options.viewer is required");var r=arguments;if(e.isPlainObject(n)||(n={source:r[0],viewport:r[1],element:r[2]}),e.console.assert(n.viewport,"[Drawer] options.viewport is required"),e.console.assert(n.element,"[Drawer] options.element is required"),n.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=n.viewer,this.viewport=n.viewport,this.debugGridColor=typeof n.debugGridColor=="string"?[n.debugGridColor]:n.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,n.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=e.getElement(n.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var o=this._calculateCanvasSize();this.canvas.width=o.x,this.canvas.height=o.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),e.setElementPointerEventsNone(this.canvas),e.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},e.Drawer.prototype={addOverlay:function(n,r,o,l){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(n,r,o,l),this},updateOverlay:function(n,r,o){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(n,r,o),this},removeOverlay:function(n){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(n),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(n){var r=this.viewport.pixelFromPointNoRotate(n,!0);return new e.Point(r.x*e.pixelDensityRatio,r.y*e.pixelDensityRatio)},clipWithPolygons:function(n,r){if(!!this.useCanvas){var o=this._getContext(r);o.beginPath(),n.forEach(function(l){l.forEach(function(s,a){o[a===0?"moveTo":"lineTo"](s.x,s.y)})}),o.clip()}},setOpacity:function(n){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var r=this.viewer.world,o=0;o<r.getItemCount();o++)r.getItemAt(o).setOpacity(n);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var n=this.viewer.world,r=0,o=0;o<n.getItemCount();o++){var l=n.getItemAt(o).getOpacity();l>r&&(r=l)}return r},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var n=this._calculateCanvasSize();if((this.canvas.width!==n.x||this.canvas.height!==n.y)&&(this.canvas.width=n.x,this.canvas.height=n.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var r=this._calculateSketchCanvasSize();this.sketchCanvas.width=r.x,this.sketchCanvas.height=r.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(n,r){if(!!this.useCanvas){var o=this._getContext(n);if(r)o.clearRect(r.x,r.y,r.width,r.height);else{var l=o.canvas;o.clearRect(0,0,l.width,l.height)}}},viewportToDrawerRectangle:function(n){var r=this.viewport.pixelFromPointNoRotate(n.getTopLeft(),!0),o=this.viewport.deltaPixelsFromPointsNoRotate(n.getSize(),!0);return new e.Rect(r.x*e.pixelDensityRatio,r.y*e.pixelDensityRatio,o.x*e.pixelDensityRatio,o.y*e.pixelDensityRatio)},drawTile:function(n,r,o,l,s,a,u){if(e.console.assert(n,"[Drawer.drawTile] tile is required"),e.console.assert(r,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var c=this._getContext(o);l=l||1,n.drawCanvas(c,r,l,s,a,u)}else n.drawHTML(this.canvas)},_getContext:function(n){var r=this.context;if(n){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var o=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=o.x,this.sketchCanvas.height=o.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var l=this;this.viewer.addHandler("rotate",function s(){if(l.viewport.getRotation()!==0){l.viewer.removeHandler("rotate",s);var a=l._calculateSketchCanvasSize();l.sketchCanvas.width=a.x,l.sketchCanvas.height=a.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}r=this.sketchContext}return r},saveContext:function(n){!this.useCanvas||this._getContext(n).save()},restoreContext:function(n){!this.useCanvas||this._getContext(n).restore()},setClip:function(n,r){if(!!this.useCanvas){var o=this._getContext(r);o.beginPath(),o.rect(n.x,n.y,n.width,n.height),o.clip()}},drawRectangle:function(n,r,o){if(!!this.useCanvas){var l=this._getContext(o);l.save(),l.fillStyle=r,l.fillRect(n.x,n.y,n.width,n.height),l.restore()}},blendSketch:function(n,r,o,l){var s=n;if(e.isPlainObject(s)||(s={opacity:n,scale:r,translate:o,compositeOperation:l}),!(!this.useCanvas||!this.sketchCanvas)){n=s.opacity,l=s.compositeOperation;var a=s.bounds;if(this.context.save(),this.context.globalAlpha=n,l&&(this.context.globalCompositeOperation=l),a)a.x<0&&(a.width+=a.x,a.x=0),a.x+a.width>this.canvas.width&&(a.width=this.canvas.width-a.x),a.y<0&&(a.height+=a.y,a.y=0),a.y+a.height>this.canvas.height&&(a.height=this.canvas.height-a.y),this.context.drawImage(this.sketchCanvas,a.x,a.y,a.width,a.height,a.x,a.y,a.width,a.height);else{r=s.scale||1,o=s.translate;var u=o instanceof e.Point?o:new e.Point(0,0),c=0,h=0;if(o){var d=this.sketchCanvas.width-this.canvas.width,p=this.sketchCanvas.height-this.canvas.height;c=Math.round(d/2),h=Math.round(p/2)}this.context.drawImage(this.sketchCanvas,u.x-c*r,u.y-h*r,(this.canvas.width+2*c)*r,(this.canvas.height+2*h)*r,-c,-h,this.canvas.width+2*c,this.canvas.height+2*h)}this.context.restore()}},drawDebugInfo:function(n,r,o,l){if(!!this.useCanvas){var s=this.viewer.world.getIndexOfItem(l)%this.debugGridColor.length,a=this.context;a.save(),a.lineWidth=2*e.pixelDensityRatio,a.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",a.strokeStyle=this.debugGridColor[s],a.fillStyle=this.debugGridColor[s],this.viewport.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:this.viewport.getRotation(!0)}),l.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:l.getRotation(!0),point:l.viewport.pixelFromPointNoRotate(l._getRotationPoint(!0),!0)}),l.viewport.getRotation(!0)%360===0&&l.getRotation(!0)%360===0&&l._drawer.viewer.viewport.getFlip()&&l._drawer._flip(),a.strokeRect(n.position.x*e.pixelDensityRatio,n.position.y*e.pixelDensityRatio,n.size.x*e.pixelDensityRatio,n.size.y*e.pixelDensityRatio);var u=(n.position.x+n.size.x/2)*e.pixelDensityRatio,c=(n.position.y+n.size.y/2)*e.pixelDensityRatio;a.translate(u,c),a.rotate(Math.PI/180*-this.viewport.getRotation(!0)),a.translate(-u,-c),n.x===0&&n.y===0&&(a.fillText("Zoom: "+this.viewport.getZoom(),n.position.x*e.pixelDensityRatio,(n.position.y-30)*e.pixelDensityRatio),a.fillText("Pan: "+this.viewport.getBounds().toString(),n.position.x*e.pixelDensityRatio,(n.position.y-20)*e.pixelDensityRatio)),a.fillText("Level: "+n.level,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+20)*e.pixelDensityRatio),a.fillText("Column: "+n.x,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+30)*e.pixelDensityRatio),a.fillText("Row: "+n.y,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+40)*e.pixelDensityRatio),a.fillText("Order: "+o+" of "+r,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+50)*e.pixelDensityRatio),a.fillText("Size: "+n.size.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+60)*e.pixelDensityRatio),a.fillText("Position: "+n.position.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+70)*e.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),l.getRotation(!0)%360!==0&&this._restoreRotationChanges(),l.viewport.getRotation(!0)%360===0&&l.getRotation(!0)%360===0&&l._drawer.viewer.viewport.getFlip()&&l._drawer._flip(),a.restore()}},debugRect:function(n){if(this.useCanvas){var r=this.context;r.save(),r.lineWidth=2*e.pixelDensityRatio,r.strokeStyle=this.debugGridColor[0],r.fillStyle=this.debugGridColor[0],r.strokeRect(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio,n.width*e.pixelDensityRatio,n.height*e.pixelDensityRatio),r.restore()}},setImageSmoothingEnabled:function(n){this.useCanvas&&(this._imageSmoothingEnabled=n,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(n){n.msImageSmoothingEnabled=this._imageSmoothingEnabled,n.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(n){var r=this._getContext(n).canvas;return new e.Point(r.width,r.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(n){var r=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),o=this._getContext(n.useSketch);o.save(),o.translate(r.x,r.y),this.viewer.viewport.flipped?(o.rotate(Math.PI/180*-n.degrees),o.scale(-1,1)):o.rotate(Math.PI/180*n.degrees),o.translate(-r.x,-r.y)},_flip:function(n){n=n||{};var r=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),o=this._getContext(n.useSketch);o.translate(r.x,0),o.scale(-1,1),o.translate(-r.x,0)},_restoreRotationChanges:function(n){var r=this._getContext(n);r.restore()},_calculateCanvasSize:function(){var n=e.pixelDensityRatio,r=this.viewport.getContainerSize();return{x:Math.round(r.x*n),y:Math.round(r.y*n)}},_calculateSketchCanvasSize:function(){var n=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return n;var r=Math.ceil(Math.sqrt(n.x*n.x+n.y*n.y));return{x:r,y:r}}}}(t),function(e){e.Viewport=function(n){var r=arguments;r.length&&r[0]instanceof e.Point&&(n={containerSize:r[0],contentSize:r[1],config:r[2]}),n.config&&(e.extend(!0,n,n.config),delete n.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n.margins||{}),delete n.margins,n.initialDegrees=n.degrees,delete n.degrees,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:e.DEFAULT_SETTINGS.silenceMultiImageWarnings},n),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new e.Spring({initial:n.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={get degrees(){return e.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(n){e.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(n)},resetContentSize:function(n){return e.console.assert(n,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(n instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(n.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(n.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,n.y/n.x),n.x),this},setHomeBounds:function(n,r){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(n,r)},_setContentBounds:function(n,r){e.console.assert(n,"[Viewport._setContentBounds] bounds is required"),e.console.assert(n instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(n.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(n.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=n.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(r),this._contentBounds=n.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(r),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:r,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var n=this._contentAspectRatio/this.getAspectRatio(),r;return this.homeFillsViewer?r=n>=1?n:1:r=n>=1?1:n,r/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var n=this._contentBounds.getCenter(),r=1/this.getHomeZoom(),o=r/this.getAspectRatio();return new e.Rect(n.x-r/2,n.y-o/2,r,o)},goHome:function(n){return this.viewer&&this.viewer.raiseEvent("home",{immediately:n}),this.fitBounds(this.getHomeBounds(),n)},getMinZoom:function(){var n=this.getHomeZoom(),r=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*n;return r},getMaxZoom:function(){var n=this.maxZoomLevel;return n||(n=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,n/=this._contentBounds.width),Math.max(n,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(n){e.console.assert(e.type(n)==="object","[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(n){return this.getBoundsNoRotate(n).rotate(-this.getRotation(n))},getBoundsNoRotate:function(n){var r=this.getCenter(n),o=1/this.getZoom(n),l=o/this.getAspectRatio();return new e.Rect(r.x-o/2,r.y-l/2,o,l)},getBoundsWithMargins:function(n){return this.getBoundsNoRotateWithMargins(n).rotate(-this.getRotation(n),this.getCenter(n))},getBoundsNoRotateWithMargins:function(n){var r=this.getBoundsNoRotate(n),o=this._containerInnerSize.x*this.getZoom(n);return r.x-=this._margins.left/o,r.y-=this._margins.top/o,r.width+=(this._margins.left+this._margins.right)/o,r.height+=(this._margins.top+this._margins.bottom)/o,r},getCenter:function(n){var r=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),o=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),l,s,a,u,c,h,d,p;return n?r:this.zoomPoint?(l=this.pixelFromPoint(this.zoomPoint,!0),s=this.getZoom(),a=1/s,u=a/this.getAspectRatio(),c=new e.Rect(r.x-a/2,r.y-u/2,a,u),h=this._pixelFromPoint(this.zoomPoint,c),d=h.minus(l).rotate(-this.getRotation(!0)),p=d.divide(this._containerInnerSize.x*s),o.plus(p)):o},getZoom:function(n){return n?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(n){return Math.max(Math.min(n,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(n){var r=this.viewportToViewerElementRectangle(n).getBoundingBox(),o=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),l=!1,s=!1;if(!this.wrapHorizontal){var a=r.x+r.width,u=o.x+o.width,c,h,d;r.width>o.width?c=this.visibilityRatio*o.width:c=this.visibilityRatio*r.width,h=o.x-a+c,d=u-r.x-c,c>o.width?(r.x+=(h+d)/2,l=!0):d<0?(r.x+=d,l=!0):h>0&&(r.x+=h,l=!0)}if(!this.wrapVertical){var p=r.y+r.height,m=o.y+o.height,w,y,E;r.height>o.height?w=this.visibilityRatio*o.height:w=this.visibilityRatio*r.height,y=o.y-p+w,E=m-r.y-w,w>o.height?(r.y+=(y+E)/2,s=!0):E<0?(r.y+=E,s=!0):y>0&&(r.y+=y,s=!0)}var T=l||s,C=T?this.viewerElementToViewportRectangle(r):n.clone();return C.xConstrained=l,C.yConstrained=s,C.constraintApplied=T,C},_raiseConstraintsEvent:function(n){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:n})},applyConstraints:function(n){var r=this.getZoom(),o=this._applyZoomConstraints(r);r!==o&&this.zoomTo(o,this.zoomPoint,n);var l=this.getConstrainedBounds(!1);return l.constraintApplied&&(this.fitBounds(l,n),this._raiseConstraintsEvent(n)),this},ensureVisible:function(n){return this.applyConstraints(n)},_fitBounds:function(n,r){r=r||{};var o=r.immediately||!1,l=r.constraints||!1,s=this.getAspectRatio(),a=n.getCenter(),u=new e.Rect(n.x,n.y,n.width,n.height,n.degrees+this.getRotation()).getBoundingBox();u.getAspectRatio()>=s?u.height=u.width/s:u.width=u.height*s,u.x=a.x-u.width/2,u.y=a.y-u.height/2;var c=1/u.width;if(o)return this.panTo(a,!0),this.zoomTo(c,null,!0),l&&this.applyConstraints(!0),this;var h=this.getCenter(!0),d=this.getZoom(!0);this.panTo(h,!0),this.zoomTo(d,null,!0);var p=this.getBounds(),m=this.getZoom();if(m===0||Math.abs(c/m-1)<1e-8)return this.zoomTo(c,null,!0),this.panTo(a,o),l&&this.applyConstraints(!1),this;if(l){this.panTo(a,!1),c=this._applyZoomConstraints(c),this.zoomTo(c,null,!1);var w=this.getConstrainedBounds();this.panTo(h,!0),this.zoomTo(d,null,!0),this.fitBounds(w)}else{var y=u.rotate(-this.getRotation()),E=y.getTopLeft().times(c).minus(p.getTopLeft().times(m)).divide(c-m);this.zoomTo(c,E,o)}return this},fitBounds:function(n,r){return this._fitBounds(n,{immediately:r,constraints:!1})},fitBoundsWithConstraints:function(n,r){return this._fitBounds(n,{immediately:r,constraints:!0})},fitVertically:function(n){var r=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(r,n)},fitHorizontally:function(n){var r=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(r,n)},getConstrainedBounds:function(n){var r,o;return r=this.getBounds(n),o=this._applyBoundaryConstraints(r),o},panBy:function(n,r){var o=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(o.plus(n),r)},panTo:function(n,r){return r?(this.centerSpringX.resetTo(n.x),this.centerSpringY.resetTo(n.y)):(this.centerSpringX.springTo(n.x),this.centerSpringY.springTo(n.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:n,immediately:r}),this},zoomBy:function(n,r,o){return this.zoomTo(this.zoomSpring.target.value*n,r,o)},zoomTo:function(n,r,o){var l=this;return this.zoomPoint=r instanceof e.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,o?this._adjustCenterSpringsForZoomPoint(function(){l.zoomSpring.resetTo(n)}):this.zoomSpring.springTo(n),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:n,refPoint:r,immediately:o}),this},setRotation:function(n,r){return this.rotateTo(n,null,r)},getRotation:function(n){return n?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(n,r,o){return this.rotateTo(n,r,o)},rotateTo:function(n,r,o){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===n&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=r instanceof e.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,o)if(this.rotationPivot){var l=n-this._oldDegrees;if(!l)return this.rotationPivot=null,this;this._rotateAboutPivot(n)}else this.degreesSpring.resetTo(n);else{var s=e.positiveModulo(this.degreesSpring.current.value,360),a=e.positiveModulo(n,360),u=a-s;u>180?a-=360:u<-180&&(a+=360);var c=s-a;this.degreesSpring.resetTo(n+c),this.degreesSpring.springTo(n)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:n,immediately:!!o,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(n,r,o){return this.rotateTo(this.degreesSpring.target.value+n,r,o)},resize:function(n,r){var o=this.getBoundsNoRotate(),l=o,s;this.containerSize.x=n.x,this.containerSize.y=n.y,this._updateContainerInnerSize(),r&&(s=n.x/this.containerSize.x,l.width=o.width*s,l.height=l.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:n,maintain:r});var a=this.fitBounds(l,!0);return this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:n,maintain:r}),a},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var n=this;this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var r=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,r},_rotateAboutPivot:function(n){var r=n===!0,o=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y),r?this.degreesSpring.update():this.degreesSpring.resetTo(n);var l=this.degreesSpring.current.value-this._oldDegrees,s=o.rotate(l*-1).times(-1);this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y)},_adjustCenterSpringsForZoomPoint:function(n){if(this.zoomPoint){var r=this.pixelFromPoint(this.zoomPoint,!0);n();var o=this.pixelFromPoint(this.zoomPoint,!0),l=o.minus(r),s=this.deltaPointsFromPixels(l,!0);this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else n()},deltaPixelsFromPointsNoRotate:function(n,r){return n.times(this._containerInnerSize.x*this.getZoom(r))},deltaPixelsFromPoints:function(n,r){return this.deltaPixelsFromPointsNoRotate(n.rotate(this.getRotation(r)),r)},deltaPointsFromPixelsNoRotate:function(n,r){return n.divide(this._containerInnerSize.x*this.getZoom(r))},deltaPointsFromPixels:function(n,r){return this.deltaPointsFromPixelsNoRotate(n,r).rotate(-this.getRotation(r))},pixelFromPointNoRotate:function(n,r){return this._pixelFromPointNoRotate(n,this.getBoundsNoRotate(r))},pixelFromPoint:function(n,r){return this._pixelFromPoint(n,this.getBoundsNoRotate(r))},_pixelFromPointNoRotate:function(n,r){return n.minus(r.getTopLeft()).times(this._containerInnerSize.x/r.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(n,r){return this._pixelFromPointNoRotate(n.rotate(this.getRotation(!0),this.getCenter(!0)),r)},pointFromPixelNoRotate:function(n,r){var o=this.getBoundsNoRotate(r);return n.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/o.width).plus(o.getTopLeft())},pointFromPixel:function(n,r){return this.pointFromPixelNoRotate(n,r).rotate(-this.getRotation(r),this.getCenter(r))},_viewportToImageDelta:function(n,r){var o=this._contentBoundsNoRotate.width;return new e.Point(n*this._contentSizeNoRotate.x/o,r*this._contentSizeNoRotate.x/o)},viewportToImageCoordinates:function(n,r){if(n instanceof e.Point)return this.viewportToImageCoordinates(n.x,n.y);if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(o===1){var l=this.viewer.world.getItemAt(0);return l.viewportToImageCoordinates(n,r,!0)}}return this._viewportToImageDelta(n-this._contentBoundsNoRotate.x,r-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(n,r){var o=this._contentBoundsNoRotate.width;return new e.Point(n/this._contentSizeNoRotate.x*o,r/this._contentSizeNoRotate.x*o)},imageToViewportCoordinates:function(n,r){if(n instanceof e.Point)return this.imageToViewportCoordinates(n.x,n.y);if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(o===1){var l=this.viewer.world.getItemAt(0);return l.imageToViewportCoordinates(n,r,!0)}}var s=this._imageToViewportDelta(n,r);return s.x+=this._contentBoundsNoRotate.x,s.y+=this._contentBoundsNoRotate.y,s},imageToViewportRectangle:function(n,r,o,l){var s=n;if(s instanceof e.Rect||(s=new e.Rect(n,r,o,l)),this.viewer){var a=this.viewer.world.getItemCount();if(a>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(a===1){var u=this.viewer.world.getItemAt(0);return u.imageToViewportRectangle(n,r,o,l,!0)}}var c=this.imageToViewportCoordinates(s.x,s.y),h=this._imageToViewportDelta(s.width,s.height);return new e.Rect(c.x,c.y,h.x,h.y,s.degrees)},viewportToImageRectangle:function(n,r,o,l){var s=n;if(s instanceof e.Rect||(s=new e.Rect(n,r,o,l)),this.viewer){var a=this.viewer.world.getItemCount();if(a>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(a===1){var u=this.viewer.world.getItemAt(0);return u.viewportToImageRectangle(n,r,o,l,!0)}}var c=this.viewportToImageCoordinates(s.x,s.y),h=this._viewportToImageDelta(s.width,s.height);return new e.Rect(c.x,c.y,h.x,h.y,s.degrees)},viewerElementToImageCoordinates:function(n){var r=this.pointFromPixel(n,!0);return this.viewportToImageCoordinates(r)},imageToViewerElementCoordinates:function(n){var r=this.imageToViewportCoordinates(n);return this.pixelFromPoint(r,!0)},windowToImageCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var r=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(r)},imageToWindowCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var r=this.imageToViewerElementCoordinates(n);return r.plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(n){return this.pointFromPixel(n,!0)},viewportToViewerElementCoordinates:function(n){return this.pixelFromPoint(n,!0)},viewerElementToViewportRectangle:function(n){return e.Rect.fromSummits(this.pointFromPixel(n.getTopLeft(),!0),this.pointFromPixel(n.getTopRight(),!0),this.pointFromPixel(n.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(n){return e.Rect.fromSummits(this.pixelFromPoint(n.getTopLeft(),!0),this.pixelFromPoint(n.getTopRight(),!0),this.pixelFromPoint(n.getBottomLeft(),!0))},windowToViewportCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var r=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(r)},viewportToWindowCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var r=this.viewportToViewerElementCoordinates(n);return r.plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(n){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(r===1){var o=this.viewer.world.getItemAt(0);return o.viewportToImageZoom(n)}}var l=this._contentSizeNoRotate.x,s=this._containerInnerSize.x,a=this._contentBoundsNoRotate.width,u=s/l*a;return n*u},imageToViewportZoom:function(n){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(r===1){var o=this.viewer.world.getItemAt(0);return o.imageToViewportZoom(n)}}var l=this._contentSizeNoRotate.x,s=this._containerInnerSize.x,a=this._contentBoundsNoRotate.width,u=l/s/a;return n*u},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(n){return this.flipped===n?this:(this.flipped=n,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:n}),this)}}}(t),function(e){e.TiledImage=function(s){var a=this;e.console.assert(s.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(s.drawer,"[TiledImage] options.drawer is required"),e.console.assert(s.viewer,"[TiledImage] options.viewer is required"),e.console.assert(s.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(s.source,"[TiledImage] options.source is required"),e.console.assert(!s.clip||s.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=s.tileCache,delete s.tileCache,this._drawer=s.drawer,delete s.drawer,this._imageLoader=s.imageLoader,delete s.imageLoader,s.clip instanceof e.Rect&&(this._clip=s.clip.clone()),delete s.clip;var u=s.x||0;delete s.x;var c=s.y||0;delete s.y,this.normHeight=s.source.dimensions.y/s.source.dimensions.x,this.contentAspectX=s.source.dimensions.x/s.source.dimensions.y;var h=1;s.width?(h=s.width,delete s.width,s.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete s.height)):s.height&&(h=s.height/this.normHeight,delete s.height);var d=s.fitBounds;delete s.fitBounds;var p=s.fitBoundsPlacement||t.Placement.CENTER;delete s.fitBoundsPlacement;var m=s.degrees||0;delete s.degrees;var w=s.ajaxHeaders;delete s.ajaxHeaders,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:e.DEFAULT_SETTINGS.subPixelRoundingForTransparency},s),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:u,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:c,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:h,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:m,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),d&&this.fitBounds(d,p,!0),this._drawingHandler=function(y){a.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:a},y))},this._ownAjaxHeaders={},this.setAjaxHeaders(w,!1)},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(s){s!==this._fullyLoaded&&(this._fullyLoaded=s,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var s=this._xSpring.update(),a=this._ySpring.update(),u=this._scaleSpring.update(),c=this._degreesSpring.update();return s||a||u||c?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(s){return this.getBoundsNoRotate(s).rotate(this.getRotation(s),this._getRotationPoint(s))},getBoundsNoRotate:function(s){return s?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(s){var a=this.getBoundsNoRotate(s);if(this._clip){var u=s?this._worldWidthCurrent:this._worldWidthTarget,c=u/this.source.dimensions.x,h=this._clip.times(c);a=new e.Rect(a.x+h.x,a.y+h.y,h.width,h.height)}return a.rotate(this.getRotation(s),this._getRotationPoint(s))},getTileBounds:function(s,a,u){var c=this.source.getNumTiles(s),h=(c.x+a%c.x)%c.x,d=(c.y+u%c.y)%c.y,p=this.source.getTileBounds(s,h,d);return this.getFlip()&&(p.x=1-p.x-p.width),p.x+=(a-h)/c.x,p.y+=this._worldHeightCurrent/this._worldWidthCurrent*((u-d)/c.y),p},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var s=this.imageToWindowCoordinates(new e.Point(0,0)),a=this.imageToWindowCoordinates(this.getContentSize());return new e.Point(a.x-s.x,a.y-s.y)},_viewportToImageDelta:function(s,a,u){var c=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(s*(this.source.dimensions.x/c),a*(this.source.dimensions.y*this.contentAspectX/c))},viewportToImageCoordinates:function(s,a,u){var c;return s instanceof e.Point?(u=a,c=s):c=new e.Point(s,a),c=c.rotate(-this.getRotation(u),this._getRotationPoint(u)),u?this._viewportToImageDelta(c.x-this._xSpring.current.value,c.y-this._ySpring.current.value):this._viewportToImageDelta(c.x-this._xSpring.target.value,c.y-this._ySpring.target.value)},_imageToViewportDelta:function(s,a,u){var c=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(s/this.source.dimensions.x*c,a/this.source.dimensions.y/this.contentAspectX*c)},imageToViewportCoordinates:function(s,a,u){s instanceof e.Point&&(u=a,a=s.y,s=s.x);var c=this._imageToViewportDelta(s,a);return u?(c.x+=this._xSpring.current.value,c.y+=this._ySpring.current.value):(c.x+=this._xSpring.target.value,c.y+=this._ySpring.target.value),c.rotate(this.getRotation(u),this._getRotationPoint(u))},imageToViewportRectangle:function(s,a,u,c,h){var d=s;d instanceof e.Rect?h=a:d=new e.Rect(s,a,u,c);var p=this.imageToViewportCoordinates(d.getTopLeft(),h),m=this._imageToViewportDelta(d.width,d.height,h);return new e.Rect(p.x,p.y,m.x,m.y,d.degrees+this.getRotation(h))},viewportToImageRectangle:function(s,a,u,c,h){var d=s;s instanceof e.Rect?h=a:d=new e.Rect(s,a,u,c);var p=this.viewportToImageCoordinates(d.getTopLeft(),h),m=this._viewportToImageDelta(d.width,d.height,h);return new e.Rect(p.x,p.y,m.x,m.y,d.degrees-this.getRotation(h))},viewerElementToImageCoordinates:function(s){var a=this.viewport.pointFromPixel(s,!0);return this.viewportToImageCoordinates(a)},imageToViewerElementCoordinates:function(s){var a=this.imageToViewportCoordinates(s);return this.viewport.pixelFromPoint(a,!0)},windowToImageCoordinates:function(s){var a=s.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(a)},imageToWindowCoordinates:function(s){var a=this.imageToViewerElementCoordinates(s);return a.plus(t.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(s){var a=this._scaleSpring.current.value;return s=s.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((s.x-this._xSpring.current.value)/a,(s.y-this._ySpring.current.value)/a,s.width/a,s.height/a,s.degrees)},viewportToImageZoom:function(s){var a=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return a*s},imageToViewportZoom:function(s){var a=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return s/a},setPosition:function(s,a){var u=this._xSpring.target.value===s.x&&this._ySpring.target.value===s.y;if(a){if(u&&this._xSpring.current.value===s.x&&this._ySpring.current.value===s.y)return;this._xSpring.resetTo(s.x),this._ySpring.resetTo(s.y),this._needsDraw=!0}else{if(u)return;this._xSpring.springTo(s.x),this._ySpring.springTo(s.y),this._needsDraw=!0}u||this._raiseBoundsChange()},setWidth:function(s,a){this._setScale(s,a)},setHeight:function(s,a){this._setScale(s/this.normHeight,a)},setCroppingPolygons:function(s){var a=function(c){return c instanceof e.Point||typeof c.x=="number"&&typeof c.y=="number"},u=function(c){return c.map(function(h){try{if(a(h))return{x:h.x,y:h.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!e.isArray(s))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=s.map(function(c){return u(c)})}catch(c){e.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),e.console.error(c),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(s,a,u){a=a||e.Placement.CENTER;var c=e.Placement.properties[a],h=this.contentAspectX,d=0,p=0,m=1,w=1;if(this._clip&&(h=this._clip.getAspectRatio(),m=this._clip.width/this.source.dimensions.x,w=this._clip.height/this.source.dimensions.y,s.getAspectRatio()>h?(d=this._clip.x/this._clip.height*s.height,p=this._clip.y/this._clip.height*s.height):(d=this._clip.x/this._clip.width*s.width,p=this._clip.y/this._clip.width*s.width)),s.getAspectRatio()>h){var y=s.height/w,E=0;c.isHorizontallyCentered?E=(s.width-s.height*h)/2:c.isRight&&(E=s.width-s.height*h),this.setPosition(new e.Point(s.x-d+E,s.y-p),u),this.setHeight(y,u)}else{var T=s.width/m,C=0;c.isVerticallyCentered?C=(s.height-s.width/h)/2:c.isBottom&&(C=s.height-s.width/h),this.setPosition(new e.Point(s.x-d,s.y-p+C),u),this.setWidth(T,u)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(s){e.console.assert(!s||s instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),s instanceof e.Rect?this._clip=s.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(s){this.flipped=!!s,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(s){s!==this.opacity&&(this.opacity=s,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(s){this._preload=!!s,this._needsDraw=!0},getRotation:function(s){return s?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(s,a){this._degreesSpring.target.value===s&&this._degreesSpring.isAtTargetValue()||(a?this._degreesSpring.resetTo(s):this._degreesSpring.springTo(s),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(s){return this.getBoundsNoRotate(s).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(s){s!==this.compositeOperation&&(this.compositeOperation=s,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},setAjaxHeaders:function(s,a){if(s===null&&(s={}),!e.isPlainObject(s)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=s,this._updateAjaxHeaders(a)},_updateAjaxHeaders:function(s){if(s===void 0&&(s=!0),e.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=e.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,s){var a,u,c,h;for(var d in this.tilesMatrix){a=this.source.getNumTiles(d);for(var p in this.tilesMatrix[d]){u=(a.x+p%a.x)%a.x;for(var m in this.tilesMatrix[d][p])if(c=(a.y+m%a.y)%a.y,h=this.tilesMatrix[d][p][m],h.loadWithAjax=this.loadTilesWithAjax,h.loadWithAjax){var w=this.source.getTileAjaxHeaders(d,u,c);h.ajaxHeaders=e.extend({},this.ajaxHeaders,w)}else h.ajaxHeaders=null}}for(var y=0;y<this._imageLoader.jobQueue.length;y++){var E=this._imageLoader.jobQueue[y];E.loadWithAjax=E.tile.loadWithAjax,E.ajaxHeaders=E.tile.loadWithAjax?E.tile.ajaxHeaders:null}}},_setScale:function(s,a){var u=this._scaleSpring.target.value===s;if(a){if(u&&this._scaleSpring.current.value===s)return;this._scaleSpring.resetTo(s),this._updateForScale(),this._needsDraw=!0}else{if(u)return;this._scaleSpring.springTo(s),this._updateForScale(),this._needsDraw=!0}u||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var s=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),a=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,u=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(a/this.minPixelRatio)/Math.log(2))));return u=Math.max(u,this.source.minLevel||0),s=Math.min(s,u),{lowestLevel:s,highestLevel:u}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var s=this.lastDrawn.pop();s.beingDrawn=!1}var a=this.viewport,u=this._viewportToTiledImageRectangle(a.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var c=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(u=u.intersection(c),u===null)return}for(var h=this._getLevelsInterval(),d=h.lowestLevel,p=h.highestLevel,m=null,w=!1,y=e.now(),E=p;E>=d;E--){var T=!1,C=a.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(E),!0).x*this._scaleSpring.current.value;if(E===d||!w&&C>=this.minPixelRatio)T=!0,w=!0;else if(!w)continue;var B=a.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(E),!1).x*this._scaleSpring.current.value,M=a.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,N=this.immediateRender?1:M,I=Math.min(1,(C-.5)/.5),G=N/Math.abs(N-B);if(m=this._updateLevel(w,T,E,I,G,u,y,m),this._providesCoverage(this.coverage,E))break}this._drawTiles(this.lastDrawn),m&&!m.context2D?(this._loadTile(m,y),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(s,a,u){var c,h;this.wrapHorizontal?(c=e.positiveModulo(a.x,1),h=e.positiveModulo(u.x,1)):(c=Math.max(0,a.x),h=Math.min(1,u.x));var d,p,m=1/this.source.aspectRatio;this.wrapVertical?(d=e.positiveModulo(a.y,m),p=e.positiveModulo(u.y,m)):(d=Math.max(0,a.y),p=Math.min(m,u.y));var w=this.source.getTileAtPoint(s,new e.Point(c,d)),y=this.source.getTileAtPoint(s,new e.Point(h,p)),E=this.source.getNumTiles(s);return this.wrapHorizontal&&(w.x+=E.x*Math.floor(a.x),y.x+=E.x*Math.floor(u.x)),this.wrapVertical&&(w.y+=E.y*Math.floor(a.y/m),y.y+=E.y*Math.floor(u.y/m)),{topLeft:w,bottomRight:y}},_updateLevel:function(s,a,u,c,h,d,p,m){var w=d.getBoundingBox().getTopLeft(),y=d.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:s,level:u,opacity:c,visibility:h,drawArea:d,topleft:w,bottomright:y,currenttime:p,best:m}),this._resetCoverage(this.coverage,u),this._resetCoverage(this.loadingCoverage,u);var E=this._getCornerTiles(u,w,y),T=E.topLeft,C=E.bottomRight,B=this.source.getNumTiles(u),M=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(C.x+=1,this.wrapHorizontal||(C.x=Math.min(C.x,B.x-1)));for(var N=T.x;N<=C.x;N++)for(var I=T.y;I<=C.y;I++){var G;if(this.getFlip()){var W=(B.x+N%B.x)%B.x;G=N+B.x-W-W-1}else G=N;d.intersection(this.getTileBounds(u,G,I))!==null&&(m=this._updateTile(a,s,G,I,u,c,h,M,B,p,m))}return m},_updateTile:function(s,a,u,c,h,d,p,m,w,y,E){var T=this._getTile(u,c,h,y,w,this._worldWidthCurrent,this._worldHeightCurrent),C=a;this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:T}),this._setCoverage(this.coverage,h,u,c,!1);var B=T.loaded||T.loading||this._isCovered(this.loadingCoverage,h,u,c);if(this._setCoverage(this.loadingCoverage,h,u,c,B),!T.exists||(s&&!C&&(this._isCovered(this.coverage,h,u,c)?this._setCoverage(this.coverage,h,u,c,!0):C=!0),!C))return E;if(this._positionTile(T,this.source.tileOverlap,this.viewport,m,p),!T.loaded)if(T.context2D)this._setTileLoaded(T);else{var M=this._tileCache.getImageRecord(T.cacheKey);M&&this._setTileLoaded(T,M.getData())}if(T.loaded){var N=this._blendTile(T,u,c,h,d,y);N&&(this._needsDraw=!0)}else T.loading?this._tilesLoading++:B||(E=this._compareTiles(E,T));return E},_getTile:function(s,a,u,c,h,d,p){var m,w,y,E,T,C,B,M,N,I,G=this.tilesMatrix,W=this.source;return G[u]||(G[u]={}),G[u][s]||(G[u][s]={}),(!G[u][s][a]||!G[u][s][a].flipped!=!this.flipped)&&(m=(h.x+s%h.x)%h.x,w=(h.y+a%h.y)%h.y,y=this.getTileBounds(u,s,a),E=W.getTileBounds(u,m,w,!0),T=W.tileExists(u,m,w),C=W.getTileUrl(u,m,w),B=W.getTilePostData(u,m,w),this.loadTilesWithAjax?(M=W.getTileAjaxHeaders(u,m,w),e.isPlainObject(this.ajaxHeaders)&&(M=e.extend({},this.ajaxHeaders,M))):M=null,N=W.getContext2D?W.getContext2D(u,m,w):void 0,I=new e.Tile(u,s,a,y,T,C,N,this.loadTilesWithAjax,M,E,B,W.getTileHashKey(u,m,w,C,M,B)),this.getFlip()?m===0&&(I.isRightMost=!0):m===h.x-1&&(I.isRightMost=!0),w===h.y-1&&(I.isBottomMost=!0),I.flipped=this.flipped,G[u][s][a]=I),I=G[u][s][a],I.lastTouchTime=c,I},_loadTile:function(s,a){var u=this;s.loading=!0,this._imageLoader.addJob({src:s.getUrl(),tile:s,source:this.source,postData:s.postData,loadWithAjax:s.loadWithAjax,ajaxHeaders:s.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(c,h,d){u._onTileLoad(s,a,c,h,d)},abort:function(){s.loading=!1}})},_onTileLoad:function(s,a,u,c,h){if(u)s.exists=!0;else{e.console.error("Tile %s failed to load: %s - error: %s",s,s.getUrl(),c),this.viewer.raiseEvent("tile-load-failed",{tile:s,tiledImage:this,time:a,message:c,tileRequest:h}),s.loading=!1,s.exists=!1;return}if(a<this.lastResetTime){e.console.warn("Ignoring tile %s loaded before reset: %s",s,s.getUrl()),s.loading=!1;return}var d=this,p=function(){var m=d.source,w=m.getClosestLevel();d._setTileLoaded(s,u,w,h)};this._midDraw?window.setTimeout(p,1):p()},_setTileLoaded:function(s,a,u,c){var h=0,d=!1,p=this;function m(){return d&&e.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),h++,w}function w(){h--,h===0&&(s.loading=!1,s.loaded=!0,s.hasTransparency=p.source.hasTransparency(s.context2D,s.getUrl(),s.ajaxHeaders,s.postData),s.context2D||p._tileCache.cacheTile({data:a,tile:s,cutoff:u,tiledImage:p}),p._needsDraw=!0)}var y=m();this.viewer.raiseEvent("tile-loaded",{tile:s,tiledImage:this,tileRequest:c,get image(){return e.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),a},data:a,getCompletionCallback:m}),d=!0,y()},_positionTile:function(s,a,u,c,h){var d=s.bounds.getTopLeft();d.x*=this._scaleSpring.current.value,d.y*=this._scaleSpring.current.value,d.x+=this._xSpring.current.value,d.y+=this._ySpring.current.value;var p=s.bounds.getSize();p.x*=this._scaleSpring.current.value,p.y*=this._scaleSpring.current.value;var m=u.pixelFromPointNoRotate(d,!0),w=u.pixelFromPointNoRotate(d,!1),y=u.deltaPixelsFromPointsNoRotate(p,!0),E=u.deltaPixelsFromPointsNoRotate(p,!1),T=w.plus(E.divide(2)),C=c.squaredDistanceTo(T);a||(y=y.plus(new e.Point(1,1))),s.isRightMost&&this.wrapHorizontal&&(y.x+=.75),s.isBottomMost&&this.wrapVertical&&(y.y+=.75),s.position=m,s.size=y,s.squaredDistance=C,s.visibility=h},_blendTile:function(s,a,u,c,h,d){var p=1e3*this.blendTime,m,w;if(s.blendStart||(s.blendStart=d),m=d-s.blendStart,w=p?Math.min(1,m/p):1,this.alwaysBlend&&(w*=h),s.opacity=w,this.lastDrawn.push(s),w===1)this._setCoverage(this.coverage,c,a,u,!0),this._hasOpaqueTile=!0;else if(m<p)return!0;return!1},_compareTiles:function(s,a){return!s||a.visibility>s.visibility||a.visibility===s.visibility&&a.squaredDistance<s.squaredDistance?a:s},_drawTiles:function(s){if(!(this.opacity===0||s.length===0&&!this.placeholderFillStyle)){var a=s[0],u;a&&(u=this.opacity<1||this.compositeOperation&&this.compositeOperation!=="source-over"||!this._isBottomItem()&&this.source.hasTransparency(a.context2D,a.getUrl(),a.ajaxHeaders,a.postData));var c,h,d=this.viewport.getZoom(!0),p=this.viewportToImageZoom(d);s.length>1&&p>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360===0&&e.supportsCanvas&&this.viewer.useCanvas&&(u=!0,c=a.getScaleForEdgeSmoothing(),h=a.getTranslationForEdgeSmoothing(c,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0)));var m;u&&(c||(m=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),this._drawer.viewer.viewport.getFlip()&&(this.viewport.getRotation(!0)%360!==0||this.getRotation(!0)%360!==0)&&(m.x=this._drawer.viewer.container.clientWidth-(m.x+m.width)),m=m.times(e.pixelDensityRatio)),this._drawer._clear(!0,m)),c||(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:u}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:u}),this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip());var w=!1;if(this._clip){this._drawer.saveContext(u);var y=this.imageToViewportRectangle(this._clip,!0);y=y.rotate(-this.getRotation(!0),this._getRotationPoint(!0));var E=this._drawer.viewportToDrawerRectangle(y);c&&(E=E.times(c)),h&&(E=E.translate(h)),this._drawer.setClip(E,u),w=!0}if(this._croppingPolygons){var T=this;this._drawer.saveContext(u);try{var C=this._croppingPolygons.map(function(ne){return ne.map(function(Q){var $=T.imageToViewportCoordinates(Q.x,Q.y,!0).rotate(-T.getRotation(!0),T._getRotationPoint(!0)),oe=T._drawer.viewportCoordToDrawerCoord($);return c&&(oe=oe.times(c)),h&&(oe=oe.plus(h)),oe})});this._drawer.clipWithPolygons(C,u)}catch(ne){e.console.error(ne)}w=!0}if(this.placeholderFillStyle&&this._hasOpaqueTile===!1){var B=this._drawer.viewportToDrawerRectangle(this.getBounds(!0));c&&(B=B.times(c)),h&&(B=B.translate(h));var M=null;typeof this.placeholderFillStyle=="function"?M=this.placeholderFillStyle(this,this._drawer.context):M=this.placeholderFillStyle,this._drawer.drawRectangle(B,M,u)}var N=l(this.subPixelRoundingForTransparency),I=!1;if(N===e.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)I=!0;else if(N===e.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var G=this.viewer&&this.viewer.isAnimating();I=!G}for(var W=s.length-1;W>=0;W--)a=s[W],this._drawer.drawTile(a,this._drawingHandler,u,c,h,I,this.source),a.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:a});w&&this._drawer.restoreContext(u),c||(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u)),u&&(c&&(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:!1}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1})),this._drawer.blendSketch({opacity:this.opacity,scale:c,translate:h,compositeOperation:this.compositeOperation,bounds:m}),c&&(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1))),c||this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(s)}},_drawDebugInfo:function(s){if(this.debugMode)for(var a=s.length-1;a>=0;a--){var u=s[a];try{this._drawer.drawDebugInfo(u,s.length,a,this)}catch(c){e.console.error(c)}}},_providesCoverage:function(s,a,u,c){var h,d,p,m;if(!s[a])return!1;if(u===void 0||c===void 0){h=s[a];for(p in h)if(Object.prototype.hasOwnProperty.call(h,p)){d=h[p];for(m in d)if(Object.prototype.hasOwnProperty.call(d,m)&&!d[m])return!1}return!0}return s[a][u]===void 0||s[a][u][c]===void 0||s[a][u][c]===!0},_isCovered:function(s,a,u,c){return u===void 0||c===void 0?this._providesCoverage(s,a+1):this._providesCoverage(s,a+1,2*u,2*c)&&this._providesCoverage(s,a+1,2*u,2*c+1)&&this._providesCoverage(s,a+1,2*u+1,2*c)&&this._providesCoverage(s,a+1,2*u+1,2*c+1)},_setCoverage:function(s,a,u,c,h){if(!s[a]){e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",a);return}s[a][u]||(s[a][u]={}),s[a][u][c]=h},_resetCoverage:function(s,a){s[a]={}}});var n=e.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function r(s){return s!==e.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&s!==e.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&s!==e.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function o(s){return r(s)?n:s}function l(s){if(typeof s=="number")return o(s);if(!s||!e.Browser)return n;var a=s[e.Browser.vendor];return r(a)&&(a=s["*"]),o(a)}}(t),function(e){var n=function(o){e.console.assert(o,"[TileCache.cacheTile] options is required"),e.console.assert(o.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(o.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=o.tile,this.tiledImage=o.tiledImage},r=function(o){e.console.assert(o,"[ImageRecord] options is required"),e.console.assert(o.data,"[ImageRecord] options.data is required"),this._tiles=[],o.create.apply(null,[this,o.data,o.ownerTile]),this._destroyImplementation=o.destroy.bind(null,this),this.getImage=o.getImage.bind(null,this),this.getData=o.getData.bind(null,this),this.getRenderedContext=o.getRenderedContext.bind(null,this)};r.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(o){e.console.assert(o,"[ImageRecord.addTile] tile is required"),this._tiles.push(o)},removeTile:function(o){for(var l=0;l<this._tiles.length;l++)if(this._tiles[l]===o){this._tiles.splice(l,1);return}e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",o)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(o){o=o||{},this._maxImageCacheCount=o.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(o){e.console.assert(o,"[TileCache.cacheTile] options is required"),e.console.assert(o.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(o.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(o.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var l=o.cutoff||0,s=this._tilesLoaded.length,a=this._imagesLoaded[o.tile.cacheKey];if(a||(o.data||(e.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),o.data=o.image),e.console.assert(o.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),a=this._imagesLoaded[o.tile.cacheKey]=new r({data:o.data,ownerTile:o.tile,create:o.tiledImage.source.createTileCache,destroy:o.tiledImage.source.destroyTileCache,getImage:o.tiledImage.source.getTileCacheDataAsImage,getData:o.tiledImage.source.getTileCacheData,getRenderedContext:o.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),a.addTile(o.tile),o.tile.cacheImageRecord=a,this._imagesLoadedCount>this._maxImageCacheCount){for(var u=null,c=-1,h=null,d,p,m,w,y,E,T=this._tilesLoaded.length-1;T>=0;T--)if(E=this._tilesLoaded[T],d=E.tile,!(d.level<=l||d.beingDrawn)){if(!u){u=d,c=T,h=E;continue}w=d.lastTouchTime,p=u.lastTouchTime,y=d.level,m=u.level,(w<p||w===p&&y>m)&&(u=d,c=T,h=E)}u&&c>=0&&(this._unloadTile(h),s=c)}this._tilesLoaded[s]=new n({tile:o.tile,tiledImage:o.tiledImage})},clearTilesFor:function(o){e.console.assert(o,"[TileCache.clearTilesFor] tiledImage is required");for(var l,s=0;s<this._tilesLoaded.length;++s)l=this._tilesLoaded[s],l.tiledImage===o&&(this._unloadTile(l),this._tilesLoaded.splice(s,1),s--)},getImageRecord:function(o){return e.console.assert(o,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[o]},_unloadTile:function(o){e.console.assert(o,"[TileCache._unloadTile] tileRecord is required");var l=o.tile,s=o.tiledImage;l.unload(),l.cacheImageRecord=null;var a=this._imagesLoaded[l.cacheKey];a.removeTile(l),a.getTileCount()||(a.destroy(),delete this._imagesLoaded[l.cacheKey],this._imagesLoadedCount--),s.viewer.raiseEvent("tile-unloaded",{tile:l,tiledImage:s})}}}(t),function(e){e.World=function(n){var r=this;e.console.assert(n.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=n.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(o){r._autoRefigureSizes?r._figureSizes():r._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(n,r){if(e.console.assert(n,"[World.addItem] item is required"),e.console.assert(n instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),r=r||{},r.index!==void 0){var o=Math.max(0,Math.min(this._items.length,r.index));this._items.splice(o,0,n)}else this._items.push(n);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,n.addHandler("bounds-change",this._delegatedFigureSizes),n.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:n})},getItemAt:function(n){return e.console.assert(n!==void 0,"[World.getItemAt] index is required"),this._items[n]},getIndexOfItem:function(n){return e.console.assert(n,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,n)},getItemCount:function(){return this._items.length},setItemIndex:function(n,r){e.console.assert(n,"[World.setItemIndex] item is required"),e.console.assert(r!==void 0,"[World.setItemIndex] index is required");var o=this.getIndexOfItem(n);if(r>=this._items.length)throw new Error("Index bigger than number of layers.");r===o||o===-1||(this._items.splice(o,1),this._items.splice(r,0,n),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:n,previousIndex:o,newIndex:r}))},removeItem:function(n){e.console.assert(n,"[World.removeItem] item is required");var r=e.indexOf(this._items,n);r!==-1&&(n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy(),this._items.splice(r,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(n))},removeAll:function(){this.viewer._cancelPendingImages();var n,r;for(r=0;r<this._items.length;r++)n=this._items[r],n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy();var o=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,r=0;r<o.length;r++)n=o[r],this._raiseRemoveItem(n)},resetItems:function(){for(var n=0;n<this._items.length;n++)this._items[n].reset()},update:function(){for(var n=!1,r=0;r<this._items.length;r++)n=this._items[r].update()||n;return n},draw:function(){for(var n=0;n<this._items.length;n++)this._items[n].draw();this._needsDraw=!1},needsDraw:function(){for(var n=0;n<this._items.length;n++)if(this._items[n].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(n){this._autoRefigureSizes=n,n&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(n){n=n||{};var r=n.immediately||!1,o=n.layout||e.DEFAULT_SETTINGS.collectionLayout,l=n.rows||e.DEFAULT_SETTINGS.collectionRows,s=n.columns||e.DEFAULT_SETTINGS.collectionColumns,a=n.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,u=n.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,c=a+u,h;!n.rows&&s?h=s:h=Math.ceil(this._items.length/l);var d=0,p=0,m,w,y,E,T;this.setAutoRefigureSizes(!1);for(var C=0;C<this._items.length;C++)C&&C%h===0&&(o==="horizontal"?(p+=c,d=0):(d+=c,p=0)),m=this._items[C],w=m.getBounds(),w.width>w.height?y=a:y=a*(w.width/w.height),E=y*(w.height/w.width),T=new e.Point(d+(a-y)/2,p+(a-E)/2),m.setPosition(T,r),m.setWidth(y,r),o==="horizontal"?d+=c:p+=c;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var n=this._homeBounds?this._homeBounds.clone():null,r=this._contentSize?this._contentSize.clone():null,o=this._contentFactor||0;if(!this._items.length)this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;else{var l=this._items[0],s=l.getBounds();this._contentFactor=l.getContentSize().x/s.width;for(var a=l.getClippedBounds().getBoundingBox(),u=a.x,c=a.y,h=a.x+a.width,d=a.y+a.height,p=1;p<this._items.length;p++)l=this._items[p],s=l.getBounds(),this._contentFactor=Math.max(this._contentFactor,l.getContentSize().x/s.width),a=l.getClippedBounds().getBoundingBox(),u=Math.min(u,a.x),c=Math.min(c,a.y),h=Math.max(h,a.x+a.width),d=Math.max(d,a.y+a.height);this._homeBounds=new e.Rect(u,c,h-u,d-c),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==o||!this._homeBounds.equals(n)||!this._contentSize.equals(r))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(n){this.raiseEvent("remove-item",{item:n})}})}(t)})(bd);var kt=bd.exports;const se="http://www.w3.org/2000/svg",Ts=i=>{const t=i.getAttribute("class");return t?new Set(t.split(" ")):new Set},Ct=(i,t)=>{const e=Ts(i);e.add(t),i.setAttribute("class",Array.from(e).join(" "))},fr=(i,t)=>{const e=Ts(i);e.delete(t),e.size===0?i.removeAttribute("class"):i.setAttribute("class",Array.from(e).join(" "))},Cs=(i,t)=>Ts(i).has(t),Lt=(i,t)=>{const e=i.selector("FragmentSelector");if(e!=null&&e.conformsTo.startsWith("http://www.w3.org/TR/media-frags")){const{value:n}=e,r=n.includes(":")?n.substring(n.indexOf("=")+1,n.indexOf(":")):"pixel",o=n.includes(":")?n.substring(n.indexOf(":")+1):n.substring(n.indexOf("=")+1);let[l,s,a,u]=o.split(",").map(parseFloat);return r.toLowerCase()==="percent"&&(l=l*t.naturalWidth/100,s=s*t.naturalHeight/100,a=a*t.naturalWidth/100,u=u*t.naturalHeight/100),{x:l,y:s,w:a,h:u}}},N_=(i,t,e,n,r)=>({source:r==null?void 0:r.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=pixel:${i},${t},${e},${n}`}}),H_=(i,t,e,n,r)=>{const o=i/r.naturalWidth*100,l=t/r.naturalHeight*100,s=e/r.naturalWidth*100,a=n/r.naturalHeight*100;return{source:r.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=percent:${o},${l},${s},${a}`}}},_n=(i,t,e,n,r,o)=>(o==null?void 0:o.toLowerCase())==="percent"?H_(i,t,e,n,r):N_(i,t,e,n,r),pr=(i,t,e,n,r)=>{i.setAttribute("x",t),i.setAttribute("y",e),i.setAttribute("width",n),i.setAttribute("height",r)},gr=(i,t,e)=>{i.setAttribute("cx",t),i.setAttribute("cy",e),i.setAttribute("r",7)},Sd=(i,t,e,n,r)=>{const o=document.createElementNS(se,"path");o.setAttribute("fill-rule","evenodd");const{naturalWidth:l,naturalHeight:s}=i;return o.setAttribute("d",`M0 0 h${l} v${s} h-${l} z M${t} ${e} h${n} v${r} h-${n} z`),o},Ed=(i,t,e,n,r,o)=>{const{naturalWidth:l,naturalHeight:s}=t;i.setAttribute("d",`M0 0 h${l} v${s} h-${l} z M${e} ${n} h${r} v${o} h-${r} z`)},Ps=(i,t,e,n)=>{const{x:r,y:o,w:l,h:s}=i.type==="Annotation"||i.type==="Selection"?Lt(i,t):{x:i,y:t,w:e,h:n},a=document.createElementNS(se,"g");if(l===0&&s===0){Ct(a,"a9s-point"),Ct(a,"a9s-non-scaling"),a.setAttribute("transform-origin",`${r} ${o}`);const u=document.createElementNS(se,"circle"),c=document.createElementNS(se,"circle");c.setAttribute("class","a9s-inner"),gr(c,r,o),u.setAttribute("class","a9s-outer"),gr(u,r,o),a.appendChild(u),a.appendChild(c)}else{const u=document.createElementNS(se,"rect"),c=document.createElementNS(se,"rect");c.setAttribute("class","a9s-inner"),pr(c,r,o,l,s),u.setAttribute("class","a9s-outer"),pr(u,r,o,l,s),a.appendChild(u),a.appendChild(c)}return a},As=i=>{const t=i.querySelector(".a9s-outer");if(t.nodeName==="rect"){const e=parseFloat(t.getAttribute("x")),n=parseFloat(t.getAttribute("y")),r=parseFloat(t.getAttribute("width")),o=parseFloat(t.getAttribute("height"));return{x:e,y:n,w:r,h:o}}else{const e=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy"));return{x:e,y:n,w:0,h:0}}},_d=(i,t,e,n,r)=>{const o=i.querySelector(".a9s-inner"),l=i.querySelector(".a9s-outer");l.nodeName==="rect"?(pr(o,t,e,n,r),pr(l,t,e,n,r)):(gr(o,t,e),gr(l,t,e))},z_=(i,t)=>{const{w:e,h:n}=Lt(i,t);return e*n};class V_{constructor(t,e,n,r,o){x(this,"dragTo",(t,e)=>{this.group.style.display=null,this.opposite=[t,e];const{x:n,y:r,w:o,h:l}=this.bbox;Ed(this.mask,this.env.image,n,r,o,l),_d(this.rect,n,r,o,l)});x(this,"getBoundingClientRect",()=>this.rect.getBoundingClientRect());x(this,"toSelection",()=>{const{x:t,y:e,w:n,h:r}=this.bbox;return new ei(_n(t,e,n,r,this.env.image,this.config.fragmentUnit))});x(this,"destroy",()=>{this.group.parentNode.removeChild(this.group),this.mask=null,this.rect=null,this.group=null});this.anchor=[t,e],this.opposite=[t,e],this.config=r,this.env=o,this.group=document.createElementNS(se,"g"),this.mask=Sd(o.image,t,e,2,2),this.mask.setAttribute("class","a9s-selection-mask"),this.rect=Ps(t,e,2,2),this.rect.setAttribute("class","a9s-selection"),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask),this.group.appendChild(this.rect),n.appendChild(this.group)}get bbox(){const t=this.opposite[0]-this.anchor[0],e=this.opposite[1]-this.anchor[1];return{x:t>0?this.anchor[0]:this.opposite[0],y:e>0?this.anchor[1]:this.opposite[1],w:Math.max(1,Math.abs(t)),h:Math.max(1,Math.abs(e))}}get element(){return this.rect}}const U_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},Os=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,W_=i=>{let t=null;const e=(r,o)=>new MouseEvent(r,{screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY,pageX:o.pageX,pageY:o.pageY,bubbles:!0}),n=r=>{const o=r.changedTouches[0],l=e(U_[r.type],o);o.target.dispatchEvent(l),r.preventDefault(),(r.type==="touchstart"||r.type==="touchmove")&&(t&&clearTimeout(t),t=setTimeout(()=>{const s=e("dblclick",o);o.target.dispatchEvent(s)},800)),r.type==="touchend"&&t&&clearTimeout(t)};i.addEventListener("touchstart",n,!0),i.addEventListener("touchmove",n,!0),i.addEventListener("touchend",n,!0),i.addEventListener("touchcancel",n,!0)},mr="An implementation is missing",j_=Os();class xd extends ci{constructor(e,n,r){super();x(this,"enableResponsive",()=>{window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{const e=this.svg.getBoundingClientRect(),{width:n,height:r}=this.svg.viewBox.baseVal;this.scale=Math.max(n/e.width,r/e.height),this.onScaleChanged&&this.onScaleChanged(this.scale)}),this.resizeObserver.observe(this.svg.parentNode))});x(this,"getSVGPoint",e=>{const n=this.svg.createSVGPoint();if(j_){const r=this.svg.getBoundingClientRect(),o=e.clientX-r.x,l=e.clientY-r.y,{left:s,top:a}=this.svg.getBoundingClientRect();return n.x=o+s,n.y=l+a,n.matrixTransform(this.g.getScreenCTM().inverse())}else return n.x=e.offsetX,n.y=e.offsetY,n.matrixTransform(this.g.getCTM().inverse())});x(this,"drawHandle",(e,n)=>{const r=document.createElementNS(se,"g");r.setAttribute("class","a9s-handle");const o=document.createElementNS(se,"g"),l=c=>{const h=document.createElementNS(se,"circle");return h.setAttribute("cx",e),h.setAttribute("cy",n),h.setAttribute("r",c),h.setAttribute("transform-origin",`${e} ${n}`),h},s=this.config.handleRadius||6,a=l(s);a.setAttribute("class","a9s-handle-inner");const u=l(s+1);return u.setAttribute("class","a9s-handle-outer"),o.appendChild(u),o.appendChild(a),r.appendChild(o),r});x(this,"setHandleXY",(e,n,r)=>{const o=e.querySelector(".a9s-handle-inner");o.setAttribute("cx",n),o.setAttribute("cy",r),o.setAttribute("transform-origin",`${n} ${r}`);const l=e.querySelector(".a9s-handle-outer");l.setAttribute("cx",n),l.setAttribute("cy",r),l.setAttribute("transform-origin",`${n} ${r}`)});x(this,"getHandleXY",e=>{const n=e.querySelector(".a9s-handle-outer");return{x:parseFloat(n.getAttribute("cx")),y:parseFloat(n.getAttribute("cy"))}});x(this,"scaleHandle",e=>{const n=e.querySelector(".a9s-handle-inner"),r=e.querySelector(".a9s-handle-outer"),o=this.scale*(this.config.handleRadius||6);n.setAttribute("r",o),r.setAttribute("r",o)});this.svg=e.closest("svg"),this.g=e,this.config=n,this.env=r,this.scale=1;const{image:o}=r;(o instanceof Element||o instanceof HTMLDocument)&&this.enableResponsive()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null}}class Rs extends xd{constructor(e,n,r){super(e,n,r);x(this,"attachListeners",({mouseMove:e,mouseUp:n,dblClick:r})=>{e&&(this.mouseMove=o=>{const{x:l,y:s}=this.getSVGPoint(o);this.started||(this.emit("startSelection",{x:l,y:s}),this.started=!0),e(l,s,o)},this.svg.addEventListener("mousemove",this.mouseMove)),n&&(this.mouseUp=o=>{if(o.button!==0)return;const{x:l,y:s}=this.getSVGPoint(o);n(l,s,o)},document.addEventListener("mouseup",this.mouseUp)),r&&(this.dblClick=o=>{const{x:l,y:s}=this.getSVGPoint(o);r(l,s,o)},document.addEventListener("dblclick",this.dblClick))});x(this,"detachListeners",()=>{this.mouseMove&&this.svg.removeEventListener("mousemove",this.mouseMove),this.mouseUp&&document.removeEventListener("mouseup",this.mouseUp),this.dblClick&&document.removeEventListener("dblclick",this.dblClick)});x(this,"start",(e,n)=>{const{x:r,y:o}=this.getSVGPoint(e);this.startDrawing(r,o,n,e)});x(this,"startDrawing",e=>{throw new Error(mr)});x(this,"createEditableShape",(e,n)=>{throw new Error(mr)});this.started=!1}get isDrawing(){throw new Error(mr)}}Rs.supports=i=>{throw new Error(mr)};const Td="An implementation is missing";class Cd extends xd{constructor(e,n,r,o){super(n,r,o);x(this,"updateState",e=>{throw new Error(Td)});this.annotation=e}get element(){throw new Error(Td)}}const G_=/firefox/i.test(navigator.userAgent),Pd=(i,t,e,n,r)=>{i.setAttribute("width",n),i.setAttribute("height",r),G_?(i.setAttribute("x",0),i.setAttribute("y",0),i.setAttribute("transform",`translate(${t}, ${e})`)):(i.setAttribute("x",t),i.setAttribute("y",e))},q_=(i,t)=>{const{x:e,y:n,width:r,height:o}=t.getBBox(),l=document.createElementNS(se,"svg");l.setAttribute("class","a9s-formatter-el"),Pd(l,e,n,r,o);const s=document.createElementNS(se,"g");s.appendChild(i),l.appendChild(s),t.append(l)},vr=(i,t,e)=>{if(!e)return i;const n=e.reduce((s,a)=>{const u=a(t);if(!u)return s;if(typeof u=="string"||u instanceof String)s.className=s.className?`${s.className} ${u}`:u;else if(u.nodeType===Node.ELEMENT_NODE)s.elements=s.elements?[...s.elements,u]:[u];else{const{className:c,style:h,element:d}=u;c&&(s.className=s.className?`${s.className} ${c}`:c),h&&(s.style=s.style?`${s.style} ${h}`:h),d&&(s.elements=s.elements?[...s.elements,d]:[d])}for(const c in u)u.hasOwnProperty(c)&&c.startsWith("data-")&&(s[c]=u[c]);return s},{}),{className:r,style:o,elements:l}=n;if(r&&Ct(i,r),o){const s=i.querySelector(".a9s-outer"),a=i.querySelector(".a9s-inner");s&&a?(s.setAttribute("style","display:none"),a.setAttribute("style",o)):i.setAttribute("style",o)}l&&l.forEach(s=>q_(s,i));for(const s in n)n.hasOwnProperty(s)&&s.startsWith("data-")&&i.setAttribute(s,n[s])},Ad=(i,t,e,n,r)=>{const o=i.querySelector(".a9s-formatter-el");o&&Pd(o,t,e,n,r)},ti="corner",yr="edge";class X_ extends Cd{constructor(e,n,r,o){super(e,n,r,o);x(this,"onScaleChanged",()=>this.handles.map(this.scaleHandle));x(this,"setSize",(e,n,r,o)=>{_d(this.rectangle,e,n,r,o),Ed(this.mask,this.env.image,e,n,r,o),Ad(this.elementGroup,e,n,r,o);const[l,s,a,u,c,h,d,p]=this.handles;this.setHandleXY(l,e,n),this.setHandleXY(s,e+r,n),this.setHandleXY(a,e+r,n+o),this.setHandleXY(u,e,n+o),this.enableEdgeControls&&(this.setHandleXY(c,e+r/2,n),this.setHandleXY(h,e+r,n+o/2),this.setHandleXY(d,e+r/2,n+o),this.setHandleXY(p,e,n+o/2))});x(this,"stretchCorners",(e,n,r)=>{const o=this.getHandleXY(n),l=r.x-o.x,s=r.y-o.y,a=l>0?o.x:r.x,u=s>0?o.y:r.y,c=Math.abs(l),h=Math.abs(s);return this.setSize(a,u,c,h),{x:a,y:u,w:c,h}});x(this,"stretchEdge",(e,n,r)=>{const o=this.getHandleXY(n),l=As(this.rectangle),s=e%2===0,a=s?l.w:r.x-o.x,u=s?r.y-o.y:l.h,c=s?l.x:a>0?o.x:r.x,h=s?u>0?o.y:r.y:l.y,d=Math.abs(a),p=Math.abs(u);return this.setSize(c,h,d,p),{x:c,y:h,w:d,h:p}});x(this,"onGrab",(e,n)=>r=>{if(r.button!==0)return;this.grabbedElem=e,this.grabbedType=n;const o=this.getSVGPoint(r),{x:l,y:s}=As(this.rectangle);this.mouseOffset={x:o.x-l,y:o.y-s}});x(this,"onMouseMove",e=>{if(e.button!==0)return;const n=(r,o)=>r<0?0:r>o?o:r;if(this.grabbedElem){const r=this.getSVGPoint(e);if(this.grabbedElem===this.rectangle){const{w:o,h:l}=As(this.rectangle),{naturalWidth:s,naturalHeight:a}=this.env.image,u=n(r.x-this.mouseOffset.x,s-o),c=n(r.y-this.mouseOffset.y,a-l);this.setSize(u,c,o,l),this.emit("update",_n(u,c,o,l,this.env.image,this.config.fragmentUnit))}else{const o=this.handles.indexOf(this.grabbedElem),l=this.handles[o^2],{x:s,y:a,w:u,h:c}=this.grabbedType===ti?this.stretchCorners(o,l,r):this.stretchEdge(o,l,r);this.emit("update",_n(s,a,u,c,this.env.image,this.config.fragmentUnit))}}});x(this,"onMouseUp",e=>{this.grabbedElem=null,this.grabbedType=null,this.mouseOffset=null});x(this,"updateState",e=>{const{x:n,y:r,w:o,h:l}=Lt(e,this.env.image);this.setSize(n,r,o,l)});this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseup",this.onMouseUp);const{x:l,y:s,w:a,h:u}=Lt(e,o.image);this.containerGroup=document.createElementNS(se,"g"),this.mask=Sd(o.image,l,s,a,u),this.mask.setAttribute("class","a9s-selection-mask"),this.containerGroup.appendChild(this.mask),this.elementGroup=document.createElementNS(se,"g"),this.elementGroup.setAttribute("class","a9s-annotation editable selected"),this.elementGroup.setAttribute("data-id",e.id),this.rectangle=Ps(l,s,a,u),this.rectangle.querySelector(".a9s-inner").addEventListener("mousedown",this.onGrab(this.rectangle)),this.elementGroup.appendChild(this.rectangle),this.enableEdgeControls=r.enableEdgeControls;const c=this.enableEdgeControls?[[l+a/2,s,yr],[l+a,s+u/2,yr],[l+a/2,s+u,yr],[l,s+u/2,yr]]:[];this.handles=[[l,s,ti],[l+a,s,ti],[l+a,s+u,ti],[l,s+u,ti],...c].map(h=>{const[d,p,m]=h,w=this.drawHandle(d,p);return w.addEventListener("mousedown",this.onGrab(w,m)),this.elementGroup.appendChild(w),w}),this.containerGroup.appendChild(this.elementGroup),n.appendChild(this.containerGroup),vr(this.rectangle,e,r.formatters),this.grabbedElem=null,this.grabbedType=null,this.mouseOffset=null}get element(){return this.elementGroup}destroy(){this.containerGroup.parentNode.removeChild(this.containerGroup),super.destroy()}}class wr extends Rs{constructor(e,n,r){super(e,n,r);x(this,"startDrawing",(e,n)=>{this.attachListeners({mouseMove:this.onMouseMove,mouseUp:this.onMouseUp}),this.rubberband=new V_(e,n,this.g,this.config,this.env)});x(this,"stop",()=>{this.rubberband&&(this.rubberband.destroy(),this.rubberband=null)});x(this,"onMouseMove",(e,n)=>this.rubberband.dragTo(e,n));x(this,"onMouseUp",()=>{this.detachListeners(),this.started=!1;const{width:e,height:n}=this.rubberband.getBoundingClientRect(),r=this.config.minSelectionWidth||4,o=this.config.minSelectionHeight||4;if(e>=r&&n>=o){const{element:l}=this.rubberband;l.annotation=this.rubberband.toSelection(),this.emit("complete",l)}else this.emit("cancel");this.stop()});x(this,"createEditableShape",(e,n)=>new X_(e,this.g,{...this.config,formatters:n},this.env));this.rubberband=null}get isDrawing(){return this.rubberband!=null}}wr.identifier="rect",wr.supports=i=>{const t=i.selector("FragmentSelector");return t==null?void 0:t.conformsTo.startsWith("http://www.w3.org/TR/media-frags")};const br=i=>{let t=0,e=i.length-1;for(let n=0;n<i.length;n++)t+=(i[e][0]+i[n][0])*(i[e][1]-i[n][1]),e=n;return Math.abs(.5*t)},Z_=(i,t,e,n)=>{const r=i[0]-t,o=i[1]-e;return Math.sqrt(r*r+o*o)<=n},Y_=(i,t,e,n,r,o)=>{const l=o||0,s=Math.cos(l),a=Math.sin(l),u=i[0]-t,c=i[1]-e,h=s*u+a*c,d=a*u-s*c;return h*h/(n*n)+d*d/(r*r)<=1},Ds=(i,t)=>{const e=i[0],n=i[1];let r=!1;for(let o=0,l=t.length-1;o<t.length;l=o++){const s=t[o][0],a=t[o][1],u=t[l][0],c=t[l][1];a>n!=c>n&&e<(u-s)*(n-a)/(c-a)+s&&(r=!r)}return r},K_=(i,t)=>{for(let e of i)if(!Ds(e,t))return!1;return!0},J_=(i,t,e,n,r,o)=>{const l=i[0],s=i[1],a=n-t,u=r-e,c=Math.sqrt(a*a+u*u);return Math.abs((l-t)*u-(s-e)*a)/c<=o},Od=i=>{const t=i.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(r=>r.trim()),e=[];let n=[];for(let r of t){const o=r.substring(0,1);if(o.toLowerCase()==="z")e.push([...n]),n=[];else{const l=r.substring(1).split(" ").map(c=>parseFloat(c.trim())),s=o===o.toUpperCase(),a=s?l[0]:l[0]+n[n.length-1][0],u=s?l[1]:l[1]+n[n.length-1][1];n.push([a,u])}}return n.length>0&&e.push([...n]),e},Q_=i=>{const n=new XMLSerializer().serializeToString(i.documentElement).replace("<svg>",`<svg xmlns="${se}">`);return new DOMParser().parseFromString(n,"image/svg+xml").documentElement},Rd=i=>{const t=n=>{Array.from(n.attributes).forEach(r=>{r.name.startsWith("on")&&n.removeAttribute(r.name)})},e=i.getElementsByTagName("script");return Array.from(e).reverse().forEach(n=>n.parentNode.removeChild(n)),t(i),Array.from(i.querySelectorAll("*")).forEach(t),i},Yt=i=>{const t=i.selector("SvgSelector");if(t){const e=new DOMParser,{value:n}=t,r=e.parseFromString(n,"image/svg+xml"),o=r.lookupPrefix(se),l=r.lookupNamespaceURI(null);return o||l?Rd(r).firstChild:Rd(Q_(r)).firstChild}},Dd=i=>{const t=Yt(i),e=document.createElementNS(se,"g"),n=t.cloneNode(!0);n.setAttribute("class","a9s-inner");const r=t.cloneNode(!0);return r.setAttribute("class","a9s-outer"),e.appendChild(r),e.appendChild(n),e},Ms=(i,t)=>{const e=i.querySelector(".a9s-inner").cloneNode(!0);e.removeAttribute("class"),e.removeAttribute("xmlns");let n=e.outerHTML||new XMLSerializer().serializeToString(e);return n=n.replace(` xmlns="${se}"`,""),{source:t==null?void 0:t.src,selector:{type:"SvgSelector",value:`<svg>${n}</svg>`}}},$_=i=>{const t=Yt(i),e=t.nodeName.toLowerCase();if(e==="polygon")return ex(t);if(e==="circle")return tx(t);if(e==="ellipse")return nx(t);if(e=="path")return ix(t);if(e=="line")return 0;throw`Unsupported SVG shape type: ${e}`},ex=i=>{const t=i.getAttribute("points").trim().split(" ").map(e=>e.split(",").map(n=>parseFloat(n.trim())));return br(t)},tx=i=>{const t=i.getAttribute("r");return t*t*Math.PI},nx=i=>{const t=i.getAttribute("rx"),e=i.getAttribute("ry");return t*e*Math.PI},ix=i=>{const t=Od(i);if(t.length==1)return br(t[0]);{const e=r=>t.find(o=>{if(r!==o)return K_(r,o)});let n=0;for(let r of t)e(r)?n-=br(r):n+=br(r);return n}};class Md{constructor(t,e){x(this,"redraw",()=>{this.mask.setAttribute("d",`M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute("points")} z`)});x(this,"destroy",()=>this.mask.parentNode.removeChild(this.mask));this.w=t.naturalWidth,this.h=t.naturalHeight,this.polygon=e,this.mask=document.createElementNS(se,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d",`M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute("points")} z`)}get element(){return this.mask}}class rx{constructor(t,e,n){x(this,"setPoints",t=>{const e=t.map(n=>`${n[0]},${n[1]}`).join(" ");this.outer.setAttribute("points",e),this.inner.setAttribute("points",e)});x(this,"getBoundingClientRect",()=>this.outer.getBoundingClientRect());x(this,"dragTo",t=>{this.group.style.display=null,this.mousepos=t;const e=[...this.points,t];this.setPoints(e),this.mask.redraw()});x(this,"addPoint",()=>{const[t,e]=this.mousepos,n=this.points[this.points.length-1];Math.pow(t-n[0],2)+Math.pow(e-n[1],2)>4&&(this.points=[...this.points,this.mousepos],this.setPoints(this.points),this.mask.redraw())});x(this,"destroy",()=>{this.group.parentNode.removeChild(this.group),this.polygon=null,this.group=null});x(this,"toSelection",()=>new ei(Ms(this.group,this.env.image)));this.points=[t],this.env=n,this.mousepos=t,this.group=document.createElementNS(se,"g"),this.polygon=document.createElementNS(se,"g"),this.polygon.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(se,"polygon"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(se,"polygon"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.mask=new Md(n.image,this.inner),this.polygon.appendChild(this.outer),this.polygon.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.polygon),e.appendChild(this.group)}get element(){return this.polygon}}const Is=i=>{const t=i.querySelector(".a9s-inner").points,e=[];for(let n=0;n<t.numberOfItems;n++)e.push(t.getItem(n));return e},ox=i=>i.querySelector(".a9s-inner").getBBox();class sx extends Cd{constructor(e,n,r,o){super(e,n,r,o);x(this,"onScaleChanged",()=>this.handles.map(this.scaleHandle));x(this,"setPoints",e=>{const n=h=>Math.round(10*h)/10,r=e.map(h=>`${n(h.x)},${n(h.y)}`).join(" ");this.shape.querySelector(".a9s-inner").setAttribute("points",r);const l=this.shape.querySelector(".a9s-outer");l.setAttribute("points",r),this.mask.redraw();const{x:s,y:a,width:u,height:c}=l.getBBox();Ad(this.elementGroup,s,a,u,c)});x(this,"onGrab",e=>n=>{n.button===0&&(this.grabbedElem=e,this.grabbedAt=this.getSVGPoint(n))});x(this,"onMouseMove",e=>{const n=(r,o,l)=>r+o<0?-r:r+o>l?l-r:o;if(this.grabbedElem){const r=this.getSVGPoint(e);if(this.grabbedElem===this.shape){const{x:o,y:l,width:s,height:a}=ox(this.shape),{naturalWidth:u,naturalHeight:c}=this.env.image,h=n(o,r.x-this.grabbedAt.x,u-s),d=n(l,r.y-this.grabbedAt.y,c-a),p=Is(this.shape).map(m=>({x:m.x+h,y:m.y+d}));this.grabbedAt=r,this.setPoints(p),p.forEach((m,w)=>this.setHandleXY(this.handles[w],m.x,m.y)),this.emit("update",Ms(this.shape,this.env.image))}else{const o=this.handles.indexOf(this.grabbedElem),l=Is(this.shape).map((s,a)=>a===o?r:s);this.setPoints(l),this.setHandleXY(this.handles[o],r.x,r.y),this.emit("update",Ms(this.shape,this.env.image))}}});x(this,"onMouseUp",e=>{this.grabbedElem=null,this.grabbedAt=null});x(this,"updateState",e=>{const n=Yt(e).getAttribute("points").split(" ").map(r=>{const[o,l]=r.split(",").map(s=>parseFloat(s.trim()));return{x:o,y:l}});this.setPoints(n),n.forEach((r,o)=>this.setHandleXY(this.handles[o],r.x,r.y))});x(this,"destroy",()=>{this.containerGroup.parentNode.removeChild(this.containerGroup),super.destroy()});this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseup",this.onMouseUp),this.containerGroup=document.createElementNS(se,"g"),this.shape=Dd(e),this.shape.querySelector(".a9s-inner").addEventListener("mousedown",this.onGrab(this.shape)),this.mask=new Md(o.image,this.shape.querySelector(".a9s-inner")),this.containerGroup.appendChild(this.mask.element),this.elementGroup=document.createElementNS(se,"g"),this.elementGroup.setAttribute("class","a9s-annotation editable selected"),this.elementGroup.setAttribute("data-id",e.id),this.elementGroup.appendChild(this.shape),this.handles=Is(this.shape).map(l=>{const s=this.drawHandle(l.x,l.y);return s.addEventListener("mousedown",this.onGrab(s)),this.elementGroup.appendChild(s),s}),this.containerGroup.appendChild(this.elementGroup),n.appendChild(this.containerGroup),vr(this.shape,e,r.formatters),this.grabbedElem=null,this.grabbedAt=null}get element(){return this.elementGroup}}class Fs extends Rs{constructor(e,n,r){super(e,n,r);x(this,"startDrawing",(e,n,r)=>{this._isDrawing=!0,this._startOnSingleClick=r,this.attachListeners({mouseMove:this.onMouseMove,mouseUp:this.onMouseUp,dblClick:this.onDblClick}),this.rubberband=new rx([e,n],this.g,this.env)});x(this,"stop",()=>{this.detachListeners(),this._isDrawing=!1,this.rubberband&&(this.rubberband.destroy(),this.rubberband=null)});x(this,"onMouseMove",(e,n)=>this.rubberband.dragTo([e,n]));x(this,"onMouseUp",()=>{const{width:e,height:n}=this.rubberband.getBoundingClientRect(),r=this.config.minSelectionWidth||4,o=this.config.minSelectionHeight||4;e>=r||n>=o?this.rubberband.addPoint():this._startOnSingleClick||(this.emit("cancel"),this.stop())});x(this,"onDblClick",()=>{this._isDrawing=!1;const e=this.rubberband.element;e.annotation=this.rubberband.toSelection(),this.emit("complete",e),this.stop()});x(this,"createEditableShape",(e,n)=>new sx(e,this.g,{...this.config,formatters:n},this.env));this._isDrawing=!1,this._startOnSingleClick=!1}get isDrawing(){return this._isDrawing}}Fs.identifier="polygon",Fs.supports=i=>{var e;const t=i.selector("SvgSelector");if(t)return(e=t.value)==null?void 0:e.match(/^<svg.*<polygon/g)};class ax extends ci{constructor(e,n,r){super();x(this,"listTools",()=>this._registered.map(e=>e.identifier));x(this,"registerTool",e=>{const n=e.identifier;this.listTools().includes(n)&&this.unregisterTool(n),this._registered.unshift(e)});x(this,"unregisterTool",e=>this._registered=this._registered.filter(n=>n.identifier!==e));x(this,"setCurrent",e=>{this._current&&this._current.destroy();const n=typeof e=="string"||e instanceof String?this._registered.find(r=>r.identifier===e):e;this._current=new n(this._g,this._config,this._env),this._current.on("startSelection",r=>this.emit("startSelection",r)),this._current.on("complete",r=>this.emit("complete",r)),this._current.on("cancel",r=>this.emit("cancel",r))});x(this,"forAnnotation",e=>{var s;const[n,...r]=e.targets,o=(s=n.renderedVia)==null?void 0:s.name,l=o?this._registered.find(a=>a.identifier===o):this._registered.find(a=>a.supports(e));return l?new l(this._g,this._config,this._env):null});this._g=e,this._config=n,this._env=r,this._registered=[wr,Fs],this.setCurrent(wr)}get current(){return this._current}}const lx={FragmentSelector:Ps,SvgSelector:Dd},ux={FragmentSelector:z_,SvgSelector:$_},Id=i=>{const t=i.targets[0];if(t)return Array.isArray(t.selector)?t.selector[0]:t.selector},ks=(i,t)=>lx[Id(i).type](i,t),Fd=(i,t)=>ux[Id(i).type](i,t);class cx{constructor(t){const e=document.createElementNS(se,"svg");e.setAttribute("class","a9s-osd-crosshair-container");const n=document.createElementNS(se,"g");n.setAttribute("class","a9s-crosshair"),e.appendChild(n);const r=document.createElementNS(se,"line"),o=document.createElementNS(se,"line");n.appendChild(r),n.appendChild(o),t.parentElement.appendChild(e);const l=s=>{const{offsetX:a,offsetY:u}=s,c=t.parentElement.offsetWidth,h=t.parentElement.offsetHeight;r.setAttribute("x1",0),r.setAttribute("y1",u),r.setAttribute("x2",c),r.setAttribute("y2",u),o.setAttribute("x1",a),o.setAttribute("y1",0),o.setAttribute("x2",a),o.setAttribute("y2",h)};t.addEventListener("pointermove",l),t.parentElement.addEventListener("pointermove",l)}}function hx(i,t,e,n,r){kd(i,t,e||0,n||i.length-1,r||dx)}function kd(i,t,e,n,r){for(;n>e;){if(n-e>600){var o=n-e+1,l=t-e+1,s=Math.log(o),a=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*a*(o-a)/o)*(l-o/2<0?-1:1),c=Math.max(e,Math.floor(t-l*a/o+u)),h=Math.min(n,Math.floor(t+(o-l)*a/o+u));kd(i,t,c,h,r)}var d=i[t],p=e,m=n;for(ni(i,e,t),r(i[n],d)>0&&ni(i,e,n);p<m;){for(ni(i,p,m),p++,m--;r(i[p],d)<0;)p++;for(;r(i[m],d)>0;)m--}r(i[e],d)===0?ni(i,e,m):(m++,ni(i,m,n)),m<=t&&(e=m+1),t<=m&&(n=m-1)}}function ni(i,t,e){var n=i[t];i[t]=i[e],i[e]=n}function dx(i,t){return i<t?-1:i>t?1:0}class fx{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!Er(t,e))return n;const r=this.toBBox,o=[];for(;e;){for(let l=0;l<e.children.length;l++){const s=e.children[l],a=e.leaf?r(s):s;Er(t,a)&&(e.leaf?n.push(s):Bs(t,a)?this._all(s,n):o.push(s))}e=o.pop()}return n}collides(t){let e=this.data;if(!Er(t,e))return!1;const n=[];for(;e;){for(let r=0;r<e.children.length;r++){const o=e.children[r],l=e.leaf?this.toBBox(o):o;if(Er(t,l)){if(e.leaf||Bs(t,l))return!0;n.push(o)}}e=n.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Tn([]),this}remove(t,e){if(!t)return this;let n=this.data;const r=this.toBBox(t),o=[],l=[];let s,a,u;for(;n||o.length;){if(n||(n=o.pop(),a=o[o.length-1],s=l.pop(),u=!0),n.leaf){const c=px(t,n.children,e);if(c!==-1)return n.children.splice(c,1),o.push(n),this._condense(o),this}!u&&!n.leaf&&Bs(n,r)?(o.push(n),l.push(s),s=0,a=n,n=n.children[0]):a?(s++,n=a.children[s],u=!1):n=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,r){const o=n-e+1;let l=this._maxEntries,s;if(o<=l)return s=Tn(t.slice(e,n+1)),xn(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(l)),l=Math.ceil(o/Math.pow(l,r-1))),s=Tn([]),s.leaf=!1,s.height=r;const a=Math.ceil(o/l),u=a*Math.ceil(Math.sqrt(l));Ld(t,e,n,u,this.compareMinX);for(let c=e;c<=n;c+=u){const h=Math.min(c+u-1,n);Ld(t,c,h,a,this.compareMinY);for(let d=c;d<=h;d+=a){const p=Math.min(d+a-1,h);s.children.push(this._build(t,d,p,r-1))}}return xn(s,this.toBBox),s}_chooseSubtree(t,e,n,r){for(;r.push(e),!(e.leaf||r.length-1===n);){let o=1/0,l=1/0,s;for(let a=0;a<e.children.length;a++){const u=e.children[a],c=Ls(u),h=vx(t,u)-c;h<l?(l=h,o=c<o?c:o,s=u):h===l&&c<o&&(o=c,s=u)}e=s||e.children[0]}return e}_insert(t,e,n){const r=n?t:this.toBBox(t),o=[],l=this._chooseSubtree(r,this.data,e,o);for(l.children.push(t),ri(l,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)}_split(t,e){const n=t[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);const l=this._chooseSplitIndex(n,o,r),s=Tn(n.children.splice(l,n.children.length-l));s.height=n.height,s.leaf=n.leaf,xn(n,this.toBBox),xn(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)}_splitRoot(t,e){this.data=Tn([t,e]),this.data.height=t.height+1,this.data.leaf=!1,xn(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let r,o=1/0,l=1/0;for(let s=e;s<=n-e;s++){const a=ii(t,0,s,this.toBBox),u=ii(t,s,n,this.toBBox),c=yx(a,u),h=Ls(a)+Ls(u);c<o?(o=c,r=s,l=h<l?h:l):c===o&&h<l&&(l=h,r=s)}return r||n-e}_chooseSplitAxis(t,e,n){const r=t.leaf?this.compareMinX:gx,o=t.leaf?this.compareMinY:mx,l=this._allDistMargin(t,e,n,r),s=this._allDistMargin(t,e,n,o);l<s&&t.children.sort(r)}_allDistMargin(t,e,n,r){t.children.sort(r);const o=this.toBBox,l=ii(t,0,e,o),s=ii(t,n-e,n,o);let a=Sr(l)+Sr(s);for(let u=e;u<n-e;u++){const c=t.children[u];ri(l,t.leaf?o(c):c),a+=Sr(l)}for(let u=n-e-1;u>=e;u--){const c=t.children[u];ri(s,t.leaf?o(c):c),a+=Sr(s)}return a}_adjustParentBBoxes(t,e,n){for(let r=n;r>=0;r--)ri(e[r],t)}_condense(t){for(let e=t.length-1,n;e>=0;e--)t[e].children.length===0?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():xn(t[e],this.toBBox)}}function px(i,t,e){if(!e)return t.indexOf(i);for(let n=0;n<t.length;n++)if(e(i,t[n]))return n;return-1}function xn(i,t){ii(i,0,i.children.length,t,i)}function ii(i,t,e,n,r){r||(r=Tn(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let o=t;o<e;o++){const l=i.children[o];ri(r,i.leaf?n(l):l)}return r}function ri(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function gx(i,t){return i.minX-t.minX}function mx(i,t){return i.minY-t.minY}function Ls(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Sr(i){return i.maxX-i.minX+(i.maxY-i.minY)}function vx(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function yx(i,t){const e=Math.max(i.minX,t.minX),n=Math.max(i.minY,t.minY),r=Math.min(i.maxX,t.maxX),o=Math.min(i.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,o-n)}function Bs(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Er(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function Tn(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ld(i,t,e,n,r){const o=[t,e];for(;o.length;){if(e=o.pop(),t=o.pop(),e-t<=n)continue;const l=t+Math.ceil((e-t)/n/2)*n;hx(i,l,t,e,r),o.push(t,l,l,e)}}const Ns=(i,t)=>{if(i.targets[0].selector.type==="FragmentSelector"){const{x:n,y:r,w:o,h:l}=Lt(i);return{minX:n,minY:r,maxX:n+o,maxY:r+l}}else{const n=ks(i,t),r=document.createElementNS(se,"svg");r.style.position="absolute",r.style.opacity=0,r.style.top=0,r.style.left=0,r.appendChild(n),document.body.appendChild(r);const{x:o,y:l,width:s,height:a}=n.getBBox();return document.body.removeChild(r),{minX:o,minY:l,maxX:o+s,maxY:l+a}}},wx=i=>{var e;const t=i.targets[0];return Array.isArray(t.selector)?t.selector[0].type:(e=t.selector)==null?void 0:e.type},bx=(i,t,e,n)=>{const r=Yt(e),o=r.nodeName.toLowerCase(),l=[i,t];if(o==="polygon"){const s=Array.from(r.points).map(a=>[a.x,a.y]);return Ds(l,s)}else if(o==="circle"){const s=r.getAttribute("cx"),a=r.getAttribute("cy"),u=r.getAttribute("r");return Z_(l,s,a,u)}else if(o==="ellipse"){const s=r.getAttribute("cx"),a=r.getAttribute("cy"),u=r.getAttribute("rx"),c=r.getAttribute("ry");return Y_(l,s,a,u,c)}else{if(o==="path")return Od(r).find(a=>Ds(l,a));if(o==="line"){const s=parseInt(r.getAttribute("x1")),a=parseInt(r.getAttribute("y1")),u=parseInt(r.getAttribute("x2")),c=parseInt(r.getAttribute("y2"));return J_(l,s,a,u,c,n)}else throw`Unsupported SVG shape type: ${o}`}};class Sx{constructor(t){x(this,"clear",()=>this.spatial_index.clear());x(this,"getAnnotationAt",(t,e,n)=>{const r=n?5/n:5,l=this.spatial_index.search({minX:t-r,minY:e-r,maxX:t+r,maxY:e+r}).map(s=>s.annotation).filter(s=>{const a=wx(s);if(a==="FragmentSelector")return!0;if(a==="SvgSelector")return bx(t,e,s,r);throw`Unsupported selector type: ${a}`});if(l.length>0)return l.sort((s,a)=>Fd(s,this.env.image)-Fd(a,this.env.image)),l[0]});x(this,"getAnnotationsIntersecting",t=>{const e=t.minX,n=e?t:Ns(t,this.env.image),r=this.spatial_index.search(n).map(o=>o.annotation);return e?r:r.filter(o=>!o.isEqual(t))});x(this,"insert",t=>{(Array.isArray(t)?t:[t]).forEach(n=>{this.spatial_index.insert({...Ns(n,this.env.image),annotation:n})})});x(this,"getBounds",t=>this.getBounds(t,this.env.image));x(this,"remove",t=>{const e={...Ns(t,this.env.image),annotation:t};this.spatial_index.remove(e,(n,r)=>n.annotation.id===r.annotation.id)});this.env=t,t.store=this,this.spatial_index=new fx}}const Bd=(i,t)=>{const r=(Cs(t,".a9s-annotation")?t:t.closest(".a9s-annotation")).querySelector(".a9s-outer").getBoundingClientRect(),{canvas:o}=i.drawer,l=o.getBoundingClientRect(),s=o.width/l.width,a=o.height/l.height,u=r.x-l.x,c=r.y-l.y,{width:h,height:d}=r,p=document.createElement("CANVAS"),m=p.getContext("2d");p.width=h,p.height=d,m.drawImage(o,u*s,c*a,h*s,d*a,0,0,h,d);const w=i.viewport.viewerElementToImageCoordinates(new OpenSeadragon.Point(u,c)),y=i.viewport.viewportToImageZoom(i.viewport.getZoom());return{snippet:p,transform:E=>{const T=w.x+E[0]/s/y,C=w.y+E[1]/a/y;return[T,C]}}},Ex=Os();class Nd extends ci{constructor(e){super();x(this,"_getShapeAt",e=>{const n=s=>{const a=this.svg.createSVGPoint();if(window.TouchEvent&&s instanceof TouchEvent){const u=this.svg.getBoundingClientRect(),c=s.touches[0],h=c.clientX-u.x,d=c.clientY-u.y,{left:p,top:m}=this.svg.getBoundingClientRect();return a.x=h+p,a.y=d+m,a.matrixTransform(this.g.getScreenCTM().inverse())}else return a.x=s.offsetX,a.y=s.offsetY,a.matrixTransform(this.g.getCTM().inverse())},{x:r,y:o}=n(e),l=this.store.getAnnotationAt(r,o,this.currentScale());if(l)return this.findShape(l)});x(this,"_initDrawingTools",e=>{var a;let n=!1,r=!1,o=!1;this.tools=new ax(this.g,this.config,this.env),this.tools.on("complete",u=>{r=!1,this.onDrawingComplete(u)}),this.mouseTracker=new kt.MouseTracker({element:this.svg,preProcessEventHandler:u=>{this.mouseTracker.enabled||(u.preventDefault=!1,u.preventGesture=!0),this.selectedShape&&u.eventType==="wheel"&&(u.preventDefault=!1,this.viewer.canvas.dispatchEvent(new u.originalEvent.constructor(u.eventType,u.originalEvent)))},pressHandler:u=>{this.tools.current.isDrawing||(this.tools.current.start(u.originalEvent,this.drawOnSingleClick&&!this.hoveredShape),e||this.scaleTool(this.tools.current))},moveHandler:u=>{if(this.tools.current.isDrawing){const{x:c,y:h}=this.tools.current.getSVGPoint(u.originalEvent);!u.buttons||!r?(u.originalEvent.stopPropagation(),this.tools.current.onMouseMove(c,h,u.originalEvent),n||(this.emit("startSelection",{x:c,y:h}),n=!0)):(!o&&this.tools.current.onDragStart&&this.tools.current.onDragStart(c,h,u.originalEvent),o=!0)}},releaseHandler:u=>{if(this.tools.current.isDrawing){r=!0;const{x:c,y:h}=this.tools.current.getSVGPoint(u.originalEvent);n&&this.emit("endSelection",{x:c,y:h}),this.tools.current.onMouseUp(c,h,u.originalEvent),o&&this.tools.current.onDragEnd&&this.tools.current.onDragEnd()}n=!1,o=!1}});const l=this.config.hotkey?this.config.hotkey.key?this.config.hotkey.key.toLowerCase():this.config.hotkey.toLowerCase():"shift",s=(a=this.config.hotkey)==null?void 0:a.inverted;this.mouseTracker.enabled=s,this.onKeyDown&&document.removeEventListener("keydown",this.onKeyDown),this.onKeyUp&&document.removeEventListener("keydown",this.onKeyDown),this.onKeyDown=u=>{if(u.key.toLowerCase()===l&&!this.selectedShape){const c=!this.readOnly&&!s;this.mouseTracker.enabled=c,this.tools.current.enabled=c}},this.onKeyUp=u=>{u.key.toLowerCase()===l&&!this.tools.current.isDrawing&&(this.mouseTracker.enabled=s,this.tools.current.enabled=s)},document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)});x(this,"_initMouseEvents",()=>{this.svg.addEventListener("mousemove",n=>{var r,o;if(!((r=this.tools)!=null&&r.current.isDrawing)&&!n.target.closest(".a9s-annotation.editable.selected")){const s=this._getShapeAt(n);if((s==null?void 0:s.annotation)!==((o=this.hoveredShape)==null?void 0:o.annotation)){if(this.hoveredShape){const a=this.hoveredShape.element||this.hoveredShape;fr(a,"hover"),this.emit("mouseLeaveAnnotation",this.hoveredShape.annotation,this.hoveredShape)}s&&(Ct(s,"hover"),this.emit("mouseEnterAnnotation",s.annotation,s))}this.hoveredShape=s}}),this.svg.parentElement.addEventListener("mouseleave",()=>{this.hoveredShape&&(fr(this.hoveredShape,"hover"),this.emit("mouseLeaveAnnotation",this.hoveredShape.annotation,this.hoveredShape),this.hoveredShape=null)});let e=null;this.viewer.addHandler("canvas-press",()=>e=new Date().getTime()),this.viewer.addHandler("canvas-click",n=>{var o;const{originalEvent:r}=n;if(!(((o=this.tools.current)==null?void 0:o.isDrawing)||this.disableSelect)&&new Date().getTime()-e<250){const a=r.target.closest(".a9s-annotation.editable.selected")?this.selectedShape:this._getShapeAt(r);a?(n.preventDefaultAction=!0,this.selectShape(a)):a||(this.deselect(),this.emit("select",{}))}this.disableSelect&&this.hoveredShape&&this.emit("clickAnnotation",this.hoveredShape.annotation,this.hoveredShape)})});x(this,"_lazy",e=>{if(this.viewer.world.getItemAt(0))e();else{const n=()=>{e(),this.viewer.removeHandler("open",n),this.viewer.world.removeHandler("add-item",n)};this.viewer.addHandler("open",n),this.viewer.world.addHandler("add-item",n)}});x(this,"_refreshNonScalingAnnotations",()=>{const e=this.currentScale();Array.from(this.svg.querySelectorAll(".a9s-non-scaling")).forEach(n=>n.setAttribute("transform",`scale(${1/e})`))});x(this,"addAnnotation",(e,n)=>{const r=n||this.g,o=ks(e,this.env.image);return Ct(o,"a9s-annotation"),o.setAttribute("data-id",e.id),o.annotation=e,r.appendChild(o),vr(o,e,this.formatters),this.scaleFormatterElements(o),o});x(this,"addDrawingTool",e=>this.tools.registerTool(e));x(this,"addOrUpdateAnnotation",(e,n)=>{var l;const r=(l=this.selectedShape)==null?void 0:l.annotation;(r===e||(r==null?void 0:r.isSelection)||r==n)&&this.deselect(),n&&this.removeAnnotation(e),this.removeAnnotation(e);const o=this.addAnnotation(e);Cs(o,"a9s-non-scaling")&&o.setAttribute("transform",`scale(${1/this.currentScale()})`),this.store.insert(e)});x(this,"currentScale",()=>{const e=this.viewer.viewport.getContainerSize().x;return this.viewer.viewport.getZoom(!0)*e/this.viewer.world.getContentFactor()});x(this,"deselect",()=>{var e;if((e=this.tools)==null||e.current.stop(),this.selectedShape){const{annotation:n}=this.selectedShape;if(this.selectedShape.destroy){if(this.selectedShape.mouseTracker.destroy(),this.selectedShape.destroy(),!n.isSelection){const r=this.addAnnotation(n);Cs(r,"a9s-non-scaling")&&r.setAttribute("transform",`scale(${1/this.currentScale()})`)}}else fr(this.selectedShape,"selected");this.selectedShape=null}});x(this,"destroy",()=>{this.deselect(),this.svg.parentNode.removeChild(this.svg)});x(this,"findShape",e=>{const n=e!=null&&e.id?e.id:e;return this.g.querySelector(`.a9s-annotation[data-id="${n}"]`)});x(this,"_fit",(e,n,r)=>{const o=this.findShape(e);if(o){const l=n?typeof n=="boolean"?n:n.immediately:!1,s=(n==null?void 0:n.padding)||0,a=this.viewer.container.getBoundingClientRect(),u=Math.min(2*s/a.width,2*s/a.height),{x:c,y:h,width:d,height:p}=o.getBBox(),m=c-u*d,w=h-u*p,y=d+2*u*d,E=p+2*u*p,T=this.viewer.viewport.imageToViewportRectangle(m,w,y,E);this.viewer.viewport[r](T,l)}});x(this,"fitBounds",(e,n)=>this._fit(e,n,"fitBounds"));x(this,"fitBoundsWithConstraints",(e,n)=>this._fit(e,n,"fitBoundsWithConstraints"));x(this,"getAnnotations",()=>Array.from(this.g.querySelectorAll(".a9s-annotation")).map(n=>n.annotation));x(this,"getAnnotationsIntersecting",e=>{const n=e.id?e:this.findShape(e).annotation;return this.store.getAnnotationsIntersecting(n)});x(this,"getImageSnippetById",e=>{const n=this.findShape(e);if(n)return Bd(this.viewer,n)});x(this,"getSelectedImageSnippet",()=>{var e;if(this.selectedShape){const n=(e=this.selectedShape.element)!=null?e:this.selectedShape;return Bd(this.viewer,n)}});x(this,"init",e=>{this.deselect(),Array.from(this.g.querySelectorAll(".a9s-annotation")).forEach(r=>this.g.removeChild(r)),this.store.clear(),this._lazy(()=>{console.time("Took"),console.log("Drawing..."),this.loaded||(this.g.style.display="none"),e.forEach(r=>this.addAnnotation(r)),console.log("Indexing..."),this.store.insert(e),console.timeEnd("Took"),this.resize()})});x(this,"listDrawingTools",()=>this.tools.listTools());x(this,"overrideId",(e,n)=>{const r=this.findShape(e);r.setAttribute("data-id",n);const{annotation:o}=r,l=o.clone({id:n});return r.annotation=l,this.store.remove(o),this.store.insert(l),l});x(this,"panTo",(e,n)=>{const r=this.findShape(e);if(r){const{top:o,left:l,width:s,height:a}=r.getBoundingClientRect(),u=l+s/2+window.scrollX,c=o+a/2+window.scrollY,h=this.viewer.viewport.windowToViewportCoordinates(new kt.Point(u,c));this.viewer.viewport.panTo(h,n)}});x(this,"removeAnnotation",e=>{var o,l;const n=e.type?e.id:e;((o=this.selectedShape)==null?void 0:o.annotation.id)===n&&this.deselect();const r=this.findShape(e);if(r){const{annotation:s}=r;((l=this.selectedShape)==null?void 0:l.annotation)===s&&this.deselect(),r.parentNode.removeChild(r),this.store.remove(s)}});x(this,"removeDrawingTool",e=>{var n;return(n=this.tools)==null?void 0:n.unregisterTool(e)});x(this,"scaleFormatterElements",e=>{const n=1/this.currentScale();if(e){const r=e.querySelector(".a9s-formatter-el");r&&r.firstChild.setAttribute("transform",`scale(${n})`)}else Array.from(this.g.querySelectorAll(".a9s-formatter-el")).forEach(o=>o.firstChild.setAttribute("transform",`scale(${n})`))});x(this,"scaleTool",e=>{if(e){const n=1/this.currentScale();e.scale=n,e.onScaleChanged&&e.onScaleChanged(n)}});x(this,"selectAnnotation",(e,n)=>{this.selectedShape&&this.deselect();const r=this.findShape(e);if(r){this.selectShape(r,n);const o=this.selectedShape.element?this.selectedShape.element:this.selectedShape;return{annotation:r.annotation,element:o}}else this.deselect()});x(this,"selectShape",(e,n)=>{var l;if(!n&&!e.annotation.isSelection&&this.emit("clickAnnotation",e.annotation,e),((l=this.selectedShape)==null?void 0:l.annotation)===e.annotation)return;this.selectedShape&&this.selectedShape.annotation!==e.annotation&&this.deselect();const{annotation:r}=e;if(this.readOnly||r.readOnly||this.headless)this.selectedShape=e,Ct(e,"selected"),n||this.emit("select",{annotation:r,element:e,skipEvent:n});else{const s=this.tools.forAnnotation(r);if(s){setTimeout(()=>{e.parentNode.removeChild(e),n||this.emit("select",{annotation:r,element:this.selectedShape.element})},1),this.selectedShape=s.createEditableShape(r,this.formatters),this.scaleTool(this.selectedShape),this.scaleFormatterElements(this.selectedShape.element),this.selectedShape.element.annotation=r;const a=new kt.MouseTracker({element:this.svg,preProcessEventHandler:u=>{u.stopPropagation=!0,u.preventDefault=!1,u.preventGesture=!0}}).setTracking(!1);this.selectedShape.element.addEventListener("mouseenter",()=>{this.hoveredShape=this.selectedShape,a.setTracking(!0)}),this.selectedShape.element.addEventListener("mouseleave",()=>{this.hoveredShape=null,a.setTracking(!1)}),this.selectedShape.mouseTracker=a,this.selectedShape.on("update",u=>this.emit("updateTarget",this.selectedShape.element,u))}else this.selectedShape=e,n||this.emit("select",{annotation:r,element:this.selectedShape})}});x(this,"setDrawingEnabled",e=>{if(this.mouseTracker){const n=e&&!this.readOnly;this.mouseTracker.enabled=n,this.mouseTracker.setTracking(n),this.tools.current&&(this.tools.current.enabled=n)}});x(this,"setDrawingTool",e=>{var n;this.tools&&((n=this.tools.current)==null||n.stop(),this.tools.setCurrent(e))});x(this,"setVisible",e=>{e?this.svg.style.display=null:(this.deselect(),this.svg.style.display="none")});x(this,"stopDrawing",()=>{var e;(e=this.tools)!=null&&e.current&&(this.tools.current.isDrawing&&this.tools.current.stop(),this.mouseTracker.enabled=!1,this.tools.current.enabled=!1)});this.viewer=e.viewer,this.config=e.config,this.env=e.env,this.readOnly=e.config.readOnly,this.headless=e.config.headless,e.config.formatter?this.formatters=[e.config.formatter]:e.config.formatters&&(this.formatters=Array.isArray(e.config.formatters)?e.config.formatters:[e.config.formatters]),this.disableSelect=e.config.disableSelect,this.drawOnSingleClick=e.config.drawOnSingleClick,this.svg=document.createElementNS(se,"svg"),Ex?(this.svg.setAttribute("class","a9s-annotationlayer a9s-osd-annotationlayer touch"),W_(this.svg)):this.svg.setAttribute("class","a9s-annotationlayer a9s-osd-annotationlayer"),this.g=document.createElementNS(se,"g"),this.svg.appendChild(this.g),this.viewer.canvas.appendChild(this.svg),this.viewer.addHandler("animation",()=>this.resize()),this.viewer.addHandler("rotate",()=>this.resize()),this.viewer.addHandler("resize",()=>this.resize()),this.viewer.addHandler("flip",()=>this.resize()),this.loaded=!1;const n=()=>{const{x:r,y:o}=this.viewer.world.getItemAt(0).source.dimensions,l=this.viewer.world.getItemAt(0).source["@id"]||new URL(this.viewer.world.getItemAt(0).source.url,document.baseURI).href;this.env.image={src:l,naturalWidth:r,naturalHeight:o},e.config.crosshair&&(this.crosshair||(this.crosshair=new cx(this.svg),Ct(this.svg,"no-cursor"))),this.loaded||this.emit("load",l),this.loaded=!0,this.g.style.display="inline",this.resize()};this.viewer.addHandler("open",n),this.viewer.world.addHandler("add-item",n),this.viewer.world.getItemAt(0)&&n(),this.store=new Sx(this.env),this.selectedShape=null,this.hoveredShape=null,this._initMouseEvents()}resize(){var s;const e=this.viewer.viewport.getFlip(),n=this.viewer.viewport.pixelFromPoint(new kt.Point(0,0),!0);e&&(n.x=this.viewer.viewport._containerInnerSize.x-n.x);const r=this.currentScale(),o=e?-r:r,l=this.viewer.viewport.getRotation();this.g.setAttribute("transform",`translate(${n.x}, ${n.y}) scale(${o}, ${r}) rotate(${l})`),this._refreshNonScalingAnnotations(),this.scaleFormatterElements(),this.selectedShape&&(this.selectedShape.element?(this.scaleTool(this.selectedShape),this.emit("viewportChange",this.selectedShape.element)):this.emit("viewportChange",this.selectedShape)),(s=this.tools)!=null&&s.current&&this.scaleTool(this.tools.current)}}class _x extends Nd{constructor(e){super(e);x(this,"onDrawingComplete",e=>{var n;this.mouseTracker.enabled=(n=this.config.hotkey)==null?void 0:n.inverted,this.selectShape(e),this.emit("createSelection",e.annotation)});this._initDrawingTools()}}const Hs=i=>{const t=i.viewport.viewportToImageRectangle(i.viewport.getBounds(!0)),e=i.viewport.getContainerSize().x,r=i.viewport.getZoom(!0)*e/i.world.getContentFactor();return{extent:t,scale:r}},xx=i=>{var e;const t=i.targets[0];return t?Array.isArray(t.selector)?t.selector[0].type:(e=t.selector)==null?void 0:e.type:null},Hd=(i,t)=>{const{extent:e,scale:n}=Hs(i),{selector:r}=t,o=Tt.create({target:t});if(r.type==="SvgSelector"){const l=Yt(o),s=l.nodeName.toLowerCase();let a=null;if(s==="polygon")a=Tx(l,e,n);else if(s==="circle")a=Cx(l,e,n);else if(s==="ellipse")a=Px(l,e,n);else if(s==="path")a=Ax(l,e,n);else throw`Unsupported SVG shape type: ${s}`;let u=a.outerHTML||new XMLSerializer().serializeToString(a);return u=u.replace(` xmlns="${se}"`,""),{...t,selector:{type:"SvgSelector",value:`<svg>${u}</svg>`}}}else if(r.type==="FragmentSelector"){const{x:l,y:s,w:a,h:u}=Lt(o),c=e.x+l/n,h=e.y+s/n,d=a/n,p=u/n;return a===0&&u===0?{..._n(c,h,d,p),renderedVia:{name:"point"}}:_n(c,h,d,p)}else throw`Unsupported selector type: ${r.type}`},Tx=(i,t,e)=>{const r=Array.from(i.points).map(o=>{const l=t.x+o.x/e,s=t.y+o.y/e;return l+","+s}).join(" ");return i.setAttribute("points",r),i},Cx=(i,t,e)=>{const n=parseFloat(i.getAttribute("cx")),r=parseFloat(i.getAttribute("cy")),o=parseFloat(i.getAttribute("r"));return i.setAttribute("cx",t.x+n/e),i.setAttribute("cy",t.y+r/e),i.setAttribute("r",o/e),i},Px=(i,t,e)=>{const n=parseFloat(i.getAttribute("cx")),r=parseFloat(i.getAttribute("cy")),o=parseFloat(i.getAttribute("rx")),l=parseFloat(i.getAttribute("ry"));return i.setAttribute("cx",t.x+n/e),i.setAttribute("cy",t.y+r/e),i.setAttribute("rx",o/e),i.setAttribute("ry",l/e),i},Ax=(i,t,e)=>{const r=i.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(o=>o.trim()).map(o=>{const l=o.substring(0,1);if(l.toLowerCase()==="z")return l;{const s=o.substring(1).split(" ").map(h=>parseFloat(h.trim())),a=l===l.toUpperCase(),u=a?t.x+s[0]/e:s[0]/e,c=a?t.y+s[1]/e:s[1]/e;return l+" "+u+" "+c}}).join(" ");return i.setAttribute("d",r),i},zd=(i,t)=>{const{extent:e,scale:n}=Hs(i),r=t.selector("FragmentSelector");if(t.selector("SvgSelector")){const l=Yt(t),s=l.nodeName.toLowerCase();let a=null;if(s==="polygon")a=Ox(l,e,n);else if(s==="circle")a=Rx(l,e,n);else if(s==="ellipse")a=Dx(l,e,n);else if(s==="path")a=Mx(l,e,n);else throw`Unsupported SVG shape type: ${s}`;let u=a.outerHTML||new XMLSerializer().serializeToString(a);u=u.replace(` xmlns="${se}"`,"");const c={selector:{type:"SvgSelector",value:`<svg>${u}</svg>`}};return t.clone({target:c})}else if(r){const{x:l,y:s,w:a,h:u}=Lt(t),c=(l-e.x)*n,h=(s-e.y)*n,d=_n(c,h,a*n,u*n);return t.clone({target:d})}},Ox=(i,t,e)=>{const r=Array.from(i.points).map(o=>{const l=e*(o.x-t.x),s=e*(o.y-t.y);return l+","+s}).join(" ");return i.setAttribute("points",r),i},Rx=(i,t,e)=>{const n=i.getAttribute("cx"),r=i.getAttribute("cy"),o=i.getAttribute("r");return i.setAttribute("cx",e*(n-t.x)),i.setAttribute("cy",e*(r-t.y)),i.setAttribute("r",o*e),i},Dx=(i,t,e)=>{const n=i.getAttribute("cx"),r=i.getAttribute("cy"),o=i.getAttribute("rx"),l=i.getAttribute("ry");return i.setAttribute("cx",e*(n-t.x)),i.setAttribute("cy",e*(r-t.y)),i.setAttribute("rx",o*e),i.setAttribute("ry",l*e),i},Mx=(i,t,e)=>{const r=i.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(o=>o.trim()).map(o=>{const l=o.substring(0,1);if(l.toLowerCase()==="z")return l;{const s=o.substring(1).split(" ").filter(h=>h).map(h=>parseFloat(h.trim())),a=l===l.toUpperCase(),u=a?e*(s[0]-t.x):e*s[0],c=a?e*(s[1]-t.y):e*s[1];return l+" "+u+" "+c}}).join(" ");return i.setAttribute("d",r),i},Vd=(i,t)=>{const{extent:e,scale:n}=Hs(i),r=xx(t.annotation);if(r==="FragmentSelector")Ix(t,e,n);else if(r==="SvgSelector")Fx(t,e,n);else throw`Unsupported selector type type: ${r}`;const o=t.querySelector(".a9s-formatter-el");if(o){const{x:l,y:s}=t.querySelector(".a9s-inner").getBBox();o.setAttribute("x",l),o.setAttribute("y",s)}},Ix=(i,t,e)=>{const{x:n,y:r,w:o,h:l}=Lt(i.annotation),s=i.querySelector(".a9s-outer"),a=i.querySelector(".a9s-inner"),u=e*(n-t.x),c=e*(r-t.y);o===0&&l===0?[s,a].forEach(h=>{h.setAttribute("cx",u),h.setAttribute("cy",c)}):[s,a].forEach(h=>{h.setAttribute("x",u),h.setAttribute("y",c),h.setAttribute("width",o*e),h.setAttribute("height",l*e)})},Fx=(i,t,e)=>{const n=Yt(i.annotation),r=n.nodeName.toLowerCase();if(r==="polygon")kx(i,n,t,e);else if(r==="circle")Lx(i,n,t,e);else if(r==="ellipse")Bx(i,n,t,e);else if(r==="path")Nx(i,n,t,e);else throw`Unsupported SVG shape type: ${r}`},kx=(i,t,e,n)=>{const o=Array.from(t.points).map(a=>{const u=n*(a.x-e.x),c=n*(a.y-e.y);return u+","+c}).join(" ");i.querySelector(".a9s-outer").setAttribute("points",o),i.querySelector(".a9s-inner").setAttribute("points",o)},Lx=(i,t,e,n)=>{const r=n*(t.getAttribute("cx")-e.x),o=n*(t.getAttribute("cy")-e.y),l=n*t.getAttribute("r"),s=i.querySelector(".a9s-outer");s.setAttribute("cx",r),s.setAttribute("cy",o),s.setAttribute("r",l);const a=i.querySelector(".a9s-inner");a.setAttribute("cx",r),a.setAttribute("cy",o),a.setAttribute("r",l)},Bx=(i,t,e,n)=>{const r=n*(t.getAttribute("cx")-e.x),o=n*(t.getAttribute("cy")-e.y),l=n*t.getAttribute("rx"),s=n*t.getAttribute("ry"),a=i.querySelector(".a9s-outer");a.setAttribute("cx",r),a.setAttribute("cy",o),a.setAttribute("rx",l),a.setAttribute("ry",s);const u=i.querySelector(".a9s-inner");u.setAttribute("cx",r),u.setAttribute("cy",o),u.setAttribute("rx",l),u.setAttribute("ry",s)},Nx=(i,t,e,n)=>{const o=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(l=>l.trim()).map(l=>{const s=l.substring(0,1);if(s.toLowerCase()==="z")return s;{const a=l.substring(1).split(" ").filter(d=>d).map(d=>parseFloat(d.trim())),u=s===s.toUpperCase(),c=u?n*(a[0]-e.x):n*a[0],h=u?n*(a[1]-e.y):n*a[1];return s+" "+c+" "+h}}).join(" ");i.querySelector(".a9s-inner").setAttribute("d",o),i.querySelector(".a9s-outer").setAttribute("d",o)},Hx=Os();class zx extends Nd{constructor(e){super(e);x(this,"_fit",(e,n,r)=>{const o=n?typeof n=="boolean"?n:n.immediately:!1,l=(n==null?void 0:n.padding)||0,s=this.findShape(e);if(s){const a=this.viewer.container.getBoundingClientRect(),u=s.getBoundingClientRect(),c=u.x-a.x,h=u.y-a.y,{width:d,height:p}=u,m=c-l,w=h-l,y=d+2*l,E=p+2*l,T=this.viewer.viewport.viewerElementToViewportRectangle(new kt.Rect(m,w,y,E));this.viewer.viewport[r](T,o)}});x(this,"_getShapeAt",e=>{const n=a=>{if(Hx){const u=this.svg.getBoundingClientRect(),c=a.clientX-u.x,h=a.clientY-u.y;return new kt.Point(c,h)}else return new kt.Point(a.offsetX,a.offsetY)},r=this.viewer.viewport.viewerElementToViewportCoordinates(n(e)),{x:o,y:l}=this.viewer.viewport.viewportToImageCoordinates(r.x,r.y),s=this.store.getAnnotationAt(o,l,this.currentScale());if(s)return this.findShape(s)});x(this,"_refreshNonScalingAnnotations",()=>{});x(this,"addAnnotation",(e,n)=>{const r=n||this.g,o=ks(e,this.env.image);return Ct(o,"a9s-annotation"),o.setAttribute("data-id",e.id),o.annotation=e,Vd(this.viewer,o),r.appendChild(o),vr(o,e,this.formatters),o});x(this,"addOrUpdateAnnotation",(e,n)=>{var o;const r=(o=this.selectedShape)==null?void 0:o.annotation;(r===e||(r==null?void 0:r.isSelection)||r==n)&&this.deselect(),n&&this.removeAnnotation(e),this.removeAnnotation(e),this.addAnnotation(e),this.store.insert(e)});x(this,"deselect",()=>{var e;if((e=this.tools)==null||e.current.stop(),this.selectedShape){const{annotation:n}=this.selectedShape;this.selectedShape.destroy?(this.selectedShape.mouseTracker.destroy(),this.selectedShape.destroy(),n.isSelection||this.addAnnotation(n)):fr(this.selectedShape,"selected"),this.selectedShape=null}});x(this,"onDrawingComplete",e=>{const n=e.annotation.clone({target:Hd(this.viewer,e.annotation.target)});e.annotation=n,this.selectShape(e),this.emit("createSelection",e.annotation),this.mouseTracker.enabled=!1});x(this,"selectShape",(e,n)=>{var l;if(!n&&!e.annotation.isSelection&&this.emit("clickAnnotation",e.annotation,e),((l=this.selectedShape)==null?void 0:l.annotation)===e.annotation)return;this.selectedShape&&this.selectedShape.annotation!==e.annotation&&this.deselect(!0);const{annotation:r}=e;if(this.readOnly||r.readOnly||this.headless)this.selectedShape=e,Ct(e,"selected"),n||this.emit("select",{annotation:r,element:e,skipEvent:n});else{setTimeout(()=>{e.parentNode.removeChild(e),n||this.emit("select",{annotation:r,element:this.selectedShape.element})},1);const s=this.tools.forAnnotation(r);this.selectedShape=s.createEditableShape(r),this.selectedShape.element.annotation=r;const a=zd(this.viewer,r);this.selectedShape.updateState(a);const u=new kt.MouseTracker({element:this.svg,preProcessEventHandler:c=>{c.stopPropagation=!0,c.preventDefault=!1,c.preventGesture=!0}}).setTracking(!1);this.selectedShape.element.addEventListener("mouseenter",()=>{this.hoveredShape=this.selectedShape,u.setTracking(!0)}),this.selectedShape.element.addEventListener("mouseleave",()=>{this.hoveredShape=null,u.setTracking(!1)}),this.selectedShape.mouseTracker=u,this.selectedShape.on("update",c=>{const h=Hd(this.viewer,c);this.selectedShape.element.annotation=this.selectedShape.annotation.clone({target:h}),this.emit("updateTarget",this.selectedShape.element,h)})}});this._initDrawingTools(!0)}resize(){if(!this.store)return;if(Array.from(this.g.querySelectorAll(".a9s-annotation:not(.selected)")).forEach(n=>Vd(this.viewer,n)),this.selectedShape)if(this.selectedShape.element){const n=zd(this.viewer,this.selectedShape.element.annotation);this.selectedShape.updateState&&this.selectedShape.updateState(n),this.emit("viewportChange",this.selectedShape.element)}else this.emit("viewportChange",this.selectedShape)}}var Vx=0;function Ud(i,t,e,n,r,o){var l,s,a={};for(s in t)s=="ref"?l=t[s]:a[s]=t[s];var u={type:i,props:a,key:e,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Vx,__source:r,__self:o};if(typeof i=="function"&&(l=i.defaultProps))for(s in l)a[s]===void 0&&(a[s]=l[s]);return j.vnode&&j.vnode(u),u}class Ux extends Te{constructor(e){super(e);x(this,"clearState",e=>this.setState({selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null,beforeHeadlessModify:null},e));x(this,"forwardEvent",(e,n)=>{this.annotationLayer.on(e,(r,o)=>{this.props[n](r.clone(),o)})});x(this,"onKeyUp",e=>{if(e.which===27){this.annotationLayer.stopDrawing();const{selectedAnnotation:n}=this.state;n&&(this.cancelSelected(),this.props.onCancelSelected(n))}else if(e.which===46){const{disableDeleteKey:n}=this.props.config;if(!n){const{selectedAnnotation:r}=this.state;r&&(r.isSelection?this.onCancelAnnotation(r):this.onDeleteAnnotation(r))}}});x(this,"handleStartSelect",e=>this.props.onSelectionStarted(e));x(this,"handleEndSelect",e=>this.props.onSelectionEnded(e));x(this,"handleSelect",(e,n)=>{this.state.editorDisabled?this.onHeadlessSelect(e,n):this.onNormalSelect(e,n)});x(this,"onNormalSelect",(e,n)=>{const{annotation:r,element:o}=e;if(r){const l=()=>{this.setState({selectedAnnotation:r,selectedDOMElement:o,modifiedTarget:null},()=>{n||(r.isSelection?this.props.onSelectionCreated(r.clone()):this.props.onAnnotationSelected(r.clone(),o))})},{selectedAnnotation:s}=this.state;s&&!s.isEqual(r)?this.clearState(()=>{this.props.onCancelSelected(s),l()}):l()}else{const{selectedAnnotation:l}=this.state;l?this.clearState(()=>this.props.onCancelSelected(l)):this.clearState()}});x(this,"onHeadlessSelect",(e,n)=>{this.saveSelected().then(()=>{this.onNormalSelect(e,n)})});x(this,"handleUpdateTarget",(e,n)=>{this.setState({selectedDOMElement:e,modifiedTarget:n});const r=JSON.parse(JSON.stringify(n));this.props.onSelectionTargetChanged(r)});x(this,"handleViewportChange",e=>this.setState({selectedDOMElement:e}));x(this,"overrideAnnotationId",e=>n=>{const{id:r}=e;this.state.selectedAnnotation?this.setState({selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null},()=>{this.annotationLayer.overrideId(r,n)}):this.annotationLayer.overrideId(r,n)});x(this,"onCreateOrUpdateAnnotation",(e,n)=>(r,o)=>{let l=r.isSelection?r.toAnnotation():r;l=this.state.modifiedTarget?l.clone({target:this.state.modifiedTarget}):l.clone(),this.clearState(()=>{this.annotationLayer.addOrUpdateAnnotation(l,o),o?this.props[e](l,o.clone()):this.props[e](l,this.overrideAnnotationId(l)),n&&n()})});x(this,"onDeleteAnnotation",e=>{this.clearState(),this.annotationLayer.removeAnnotation(e),this.props.onAnnotationDeleted(e)});x(this,"onCancelAnnotation",(e,n)=>{this.state.editorDisabled||this.annotationLayer.deselect(),this.props.onCancelSelected(e),this.clearState(n)});x(this,"addAnnotation",e=>{var n;e.id===((n=this.state.selectedAnnotation)==null?void 0:n.id)&&(this.annotationLayer.deselect(),this.clearState()),this.annotationLayer.addOrUpdateAnnotation(e.clone())});x(this,"addDrawingTool",e=>this.annotationLayer.addDrawingTool(e));x(this,"cancelSelected",()=>new Promise(e=>{this.annotationLayer.deselect(),this.state.selectedAnnotation?this.clearState(e):e()}));x(this,"fitBounds",(e,n)=>this.annotationLayer.fitBounds(e,n));x(this,"fitBoundsWithConstraints",(e,n)=>this.annotationLayer.fitBoundsWithConstraints(e,n));x(this,"getAnnotationById",e=>{var n;return(n=this.annotationLayer.findShape(e))==null?void 0:n.annotation});x(this,"getAnnotations",()=>this.annotationLayer.getAnnotations().map(e=>e.clone()));x(this,"getAnnotationsIntersecting",e=>this.annotationLayer.getAnnotationsIntersecting(e));x(this,"getImageSnippetById",e=>this.annotationLayer.getImageSnippetById(e));x(this,"getSelected",()=>{var e;if(this.state.selectedAnnotation)return this.state.editorDisabled?this.state.selectedAnnotation:(e=this._editor.current)==null?void 0:e.getCurrentAnnotation()});x(this,"getSelectedImageSnippet",()=>this.annotationLayer.getSelectedImageSnippet());x(this,"listDrawingTools",()=>this.annotationLayer.listDrawingTools());x(this,"panTo",(e,n)=>this.annotationLayer.panTo(e,n));x(this,"removeAnnotation",e=>this.annotationLayer.removeAnnotation(e));x(this,"removeDrawingTool",e=>this.annotationLayer.removeDrawingTool(e));x(this,"saveSelected",()=>new Promise(e=>{const n=this.state.selectedAnnotation;if(n)if(this._editor.current)this._editor.current.onOk(),e();else if(n.isSelection)n.bodies.length>0||this.props.config.allowEmpty?this.onCreateOrUpdateAnnotation("onAnnotationCreated",e)(n):(this.annotationLayer.deselect(),e());else{const{beforeHeadlessModify:r,modifiedTarget:o}=this.state;r?this.onCreateOrUpdateAnnotation("onAnnotationUpdated",e)(n,r):o?this.onCreateOrUpdateAnnotation("onAnnotationUpdated",e)(n,n):this.onCancelAnnotation(n,e)}else e()}));x(this,"selectAnnotation",e=>{const n=this.annotationLayer.selectAnnotation(e,!0);if(n)return this.handleSelect(n,!0),n.annotation.clone();this.clearState()});x(this,"setAnnotations",e=>this.annotationLayer.init(e.map(n=>n.clone())));x(this,"setDrawingEnabled",e=>this.annotationLayer.setDrawingEnabled(e));x(this,"setDrawingTool",e=>this.annotationLayer.setDrawingTool(e));x(this,"setVisible",e=>{this.annotationLayer.setVisible(e),e||this.clearState()});x(this,"updateSelected",(e,n)=>new Promise(r=>{this.state.selectedAnnotation&&(n?this.state.selectedAnnotation.isSelection?this.onCreateOrUpdateAnnotation("onAnnotationCreated",r)(e):this.onCreateOrUpdateAnnotation("onAnnotationUpdated",r)(e,this.state.selectedAnnotation):this.setState({selectedAnnotation:e,beforeHeadlessModify:this.state.beforeHeadlessModify||this.state.selectedAnnotation},r))}));this.state={selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null,readOnly:e.config.readOnly,editorDisabled:e.config.disableEditor,widgets:e.config.widgets,beforeHeadlessModify:null},this._editor=A.createRef()}componentDidMount(){this.annotationLayer=this.props.config.gigapixelMode?new zx(this.props):new _x(this.props),this.annotationLayer.on("load",this.props.onLoad),this.annotationLayer.on("startSelection",this.handleStartSelect),this.annotationLayer.on("endSelection",this.handleEndSelect),this.annotationLayer.on("select",this.handleSelect),this.annotationLayer.on("updateTarget",this.handleUpdateTarget),this.annotationLayer.on("viewportChange",this.handleViewportChange),this.forwardEvent("clickAnnotation","onClickAnnotation"),this.forwardEvent("mouseEnterAnnotation","onMouseEnterAnnotation"),this.forwardEvent("mouseLeaveAnnotation","onMouseLeaveAnnotation"),document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){this.annotationLayer.destroy(),document.removeEventListener("keyup",this.onKeyUp)}get disableEditor(){return this.state.editorDisabled}set disableEditor(e){this.setState({editorDisabled:e})}get disableSelect(){return this.annotationLayer.disableSelect}set disableSelect(e){this.annotationLayer.disableSelect=e}get formatters(){return this.annotationLayer.formatters}set formatters(e){this.annotationLayer.formatters=e}get readOnly(){return this.state.readOnly}set readOnly(e){this.annotationLayer.readOnly=e,this.setState({readOnly:e})}get widgets(){return this.state.widgets}set widgets(e){this.setState({widgets:e})}render(){var r;const e=this.state.selectedAnnotation&&!this.state.editorDisabled,n=this.state.readOnly||((r=this.state.selectedAnnotation)==null?void 0:r.readOnly);return e&&Ud(O_,{ref:this._editor,detachable:!0,wrapperEl:this.props.wrapperEl,annotation:this.state.selectedAnnotation,modifiedTarget:this.state.modifiedTarget,selectedElement:this.state.selectedDOMElement,readOnly:n,allowEmpty:this.props.config.allowEmpty,widgets:this.state.widgets,env:this.props.env,onAnnotationCreated:this.onCreateOrUpdateAnnotation("onAnnotationCreated"),onAnnotationUpdated:this.onCreateOrUpdateAnnotation("onAnnotationUpdated"),onAnnotationDeleted:this.onDeleteAnnotation,onCancel:this.onCancelAnnotation})}}var Q1="",$1="",eC="";class Wx{constructor(t,e){x(this,"handleAnnotationCreated",(t,e)=>this._emitter.emit("createAnnotation",t.underlying,e));x(this,"handleAnnotationDeleted",t=>this._emitter.emit("deleteAnnotation",t.underlying));x(this,"handleAnnotationSelected",(t,e)=>this._emitter.emit("selectAnnotation",t.underlying,e));x(this,"handleAnnotationUpdated",(t,e)=>this._emitter.emit("updateAnnotation",t.underlying,e.underlying));x(this,"handleCancelSelected",t=>this._emitter.emit("cancelSelected",t.underlying));x(this,"handleClickAnnotation",(t,e)=>this._emitter.emit("clickAnnotation",t.underlying,e));x(this,"handleLoad",t=>this._emitter.emit("load",t));x(this,"handleSelectionCreated",t=>this._emitter.emit("createSelection",t.underlying));x(this,"handleSelectionStarted",t=>this._emitter.emit("startSelection",t));x(this,"handleSelectionEnded",t=>this._emitter.emit("endSelection",t));x(this,"handleSelectionTargetChanged",t=>this._emitter.emit("changeSelectionTarget",t));x(this,"handleMouseEnterAnnotation",(t,e)=>this._emitter.emit("mouseEnterAnnotation",t.underlying,e));x(this,"handleMouseLeaveAnnotation",(t,e)=>this._emitter.emit("mouseLeaveAnnotation",t.underlying,e));x(this,"_wrap",t=>(t==null?void 0:t.type)==="Annotation"?new Tt(t):t);x(this,"addAnnotation",t=>this._app.current.addAnnotation(new Tt(t)));x(this,"addDrawingTool",t=>this._app.current.addDrawingTool(t));x(this,"cancelSelected",()=>this._app.current.cancelSelected());x(this,"clearAnnotations",()=>this.setAnnotations([]));x(this,"clearAuthInfo",()=>this._env.user=null);x(this,"destroy",()=>A.unmountComponentAtNode(this.appContainerEl));x(this,"fitBounds",(t,e)=>this._app.current.fitBounds(this._wrap(t),e));x(this,"fitBoundsWithConstraints",(t,e)=>this._app.current.fitBoundsWithConstraints(this._wrap(t),e));x(this,"getAnnotationById",t=>{const e=this._app.current.getAnnotationById(t);return e==null?void 0:e.underlying});x(this,"getAnnotations",()=>this._app.current.getAnnotations().map(e=>e.underlying));x(this,"getAnnotationsIntersecting",t=>this._app.current.getAnnotationsIntersecting(this._wrap(t)));x(this,"getImageSnippetById",t=>this._app.current.getImageSnippetById(t));x(this,"getSelected",()=>{const t=this._app.current.getSelected();return t==null?void 0:t.underlying});x(this,"getSelectedImageSnippet",()=>this._app.current.getSelectedImageSnippet());x(this,"listDrawingTools",()=>this._app.current.listDrawingTools());x(this,"loadAnnotations",t=>fetch(t).then(e=>e.json()).then(e=>(this.setAnnotations(e),e)));x(this,"off",(t,e)=>this._emitter.off(t,e));x(this,"on",(t,e)=>this._emitter.on(t,e));x(this,"once",(t,e)=>this._emitter.once(t,e));x(this,"panTo",(t,e)=>this._app.current.panTo(this._wrap(t),e));x(this,"removeAnnotation",t=>this._app.current.removeAnnotation(this._wrap(t)));x(this,"removeDrawingTool",t=>this._app.current.removeDrawingTool(t));x(this,"saveSelected",()=>this._app.current.saveSelected());x(this,"selectAnnotation",t=>{const e=this._app.current.selectAnnotation(this._wrap(t));return e==null?void 0:e.underlying});x(this,"setAnnotations",t=>{const n=(t||[]).map(r=>new Tt(r));this._app.current.setAnnotations(n)});x(this,"setAuthInfo",t=>this._env.user=t);x(this,"setDrawingEnabled",t=>this._app.current.setDrawingEnabled(t));x(this,"setDrawingTool",t=>this._app.current.setDrawingTool(t));x(this,"setServerTime",t=>this._env.setServerTime(t));x(this,"setVisible",t=>this._app.current.setVisible(t));x(this,"updateSelected",(t,e)=>{let n=null;t.type==="Annotation"?n=new Tt(t):t.type==="Selection"&&(n=new ei(t.target,t.body)),n&&this._app.current.updateSelected(n,e)});const n=e||{};this._app=A.createRef(),this._emitter=new ci,this._env=L_(),this._element=t.element,window.getComputedStyle(this._element).getPropertyValue("position")==="static"&&(this._element.style.position="relative"),B_(n.locale,n.messages),this.appContainerEl=document.createElement("DIV"),this._element.appendChild(this.appContainerEl),A.render(Ud(Ux,{ref:this._app,viewer:t,wrapperEl:this._element,config:n,env:this._env,onSelectionStarted:this.handleSelectionStarted,onSelectionEnded:this.handleSelectionEnded,onSelectionCreated:this.handleSelectionCreated,onSelectionTargetChanged:this.handleSelectionTargetChanged,onAnnotationCreated:this.handleAnnotationCreated,onAnnotationSelected:this.handleAnnotationSelected,onAnnotationUpdated:this.handleAnnotationUpdated,onAnnotationDeleted:this.handleAnnotationDeleted,onCancelSelected:this.handleCancelSelected,onClickAnnotation:this.handleClickAnnotation,onLoad:this.handleLoad,onMouseEnterAnnotation:this.handleMouseEnterAnnotation,onMouseLeaveAnnotation:this.handleMouseLeaveAnnotation}),this.appContainerEl)}get disableEditor(){return this._app.current.disableEditor}set disableEditor(t){this._app.current.disableEditor=t}get disableSelect(){return this._app.current.disableSelect}set disableSelect(t){this._app.current.disableSelect=t}get formatters(){return this._app.current.formatters||[]}set formatters(t){if(t){const e=Array.isArray(t)?t:[t];this._app.current.formatters=e}else this._app.current.formatters=null}get readOnly(){return this._app.current.readOnly}set readOnly(t){this._app.current.readOnly=t}get widgets(){return this._app.current.widgets}set widgets(t){this._app.current.widgets=t}}var jx=(i,t)=>new Wx(i,t);return jx});
//# sourceMappingURL=annotorious-openseadragon.umd.js.map
